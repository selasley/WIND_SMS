DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   1
                                                                22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	      1 	SUBROUTINE display_orbit_info(d_unit, beg_date, end_date, what_info,
	      2 	1 form, units, system, interval, npoints, epoch_time, gci_pos, gci_vel,
	      3 	1 gse_pos, gse_vel, gsm_pos, gsm_vel, sun_vec) 
	      4  
	      5 C+
	      6 C 
	      7 C FUNCTIONAL DESCRIPTION:	
	      8 C 
	      9 C    This subroutine displays the requested coordinate and velocity information
	     10 C    in a form easily usable by a spreadsheet program.  The display is prefaced
	     11 C    by a heading indicating the range of dates in the dump and the values being
	     12 C    displayed.
	     13 C 
	     14 C FORMAL PARAMETERS:
	     15 C  
	     16 C     D_UNIT:
	     17 C	  INT*4	    The Fortran unit number where the formatted output is to be
	     18 C		    written.  This allows the output to be directed to either
	     19 C		    the terminal (unit 6) or a file or network link.
	     20 C      
	     21 C     BEG_DATE:
	     22 C	  REAL*8    The date/time, in Epoch format, of the first data point to
	     23 C		    be dumped.  This will be displayed as the starting date.
	     24 C      
	     25 C     END_DATE:
	     26 C	  REAL*8    The date/time, in Epoch format, of the last data point to
	     27 C		    be dumped.  This will be displayed as the ending date.
	     28 C      
	     29 C     WHAT_POS:
	     30 C	  LOG*4	    A 7-element logical array.  Each element indicates to
	     31 C		    DISPLAY_ORBIT_INFO what information is to be formatted and
	     32 C		    output.  The elements, in order, are:
	     33 C			1   GCI position
	     34 C			2   GCI velocity
	     35 C			3   GSE position
	     36 C			4   GSE velocity
	     37 C			5   GSM position
	     38 C			6   GSM velocity
	     39 C			7   Sun vector
	     40 C		    If a particular element is .TRUE. the corresponding position
	     41 C		    (or velocity) information is accessed from the argument list
	     42 C		    and is written as a separate column in the output.
	     43 C
	     44 C     FORM:
	     45 C     	  INT*4	    A bit-encoded value specifying the output format to use.
	     46 C		    The meaning of the bits are given in the file
	     47 C		    WIND_POSITION.INC and are also defined below:
	     48 C			Bit	Meaning
	     49 C			 0	if 1 use tabs to separate columns; if 0 use
	     50 C				spaces
	     51 C			 1	if 1 suppress display of Epoch time as
	     52 C				dd-mmm-yyyy hh:mm:ss; if 0 display in this
	     53 C				format 
	     54 C			 2	if 1 display Epoch time as a REAL*8 using F15.0;
	     55 C				if 0 suppress display in this format
	     56 C			 3	if 1 suppress display of header; if 0 display
	     57 C				header

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   2
                                                                22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	     58 C			 4	if 1 display Epoch time on each of the three
	     59 C				lines for each triple; if 0 display it only on
	     60 C				first line 
	     61 C			 5	if 1 display three data values of each entity on
	     62 C				the same line; if 0 display the values on three
	     63 C				separate lines
	     64 C			 6	if 1 display date using day-of-year in yyyy nnn
	     65 C				format; if 0 use month-day format; ignored if
	     66 C				bit 1 is 1 (suppress date display)
	     67 C			 7-31	reserved
	     68 C      
	     69 C     UNITS:
	     70 C	  INT*4	    An encoded value indicating whether or not the units are to
	     71 C		    be changed and to what.  The allowable values are:
	     72 C			0	no change in units
	     73 C			1	Earth radii
	     74 C      
	     75 C     SYSTEM:
	     76 C	  INT*4	    An encoded value indicating whether or not the coordinate
	     77 C		    system is to be changed to spherical.  The allowable values are:
	     78 C			0	no change to coordinate system
	     79 C			1	change to spherical coordinates (r,theta,phi)
	     80 C
	     81 C     INTERVAL:
	     82 C     	  INT*4	    The length of the interval (in array elements) which is to
	     83 C		    be used to the display position and velocity values.  If 2
	     84 C		    every other element is displayed, if 3 every 3rd, etc.
	     85 C	  
	     86 C     NPOINTS:
	     87 C	  INT*4	    The size of the arrays arrays EPOCH_TIME, GCI_POS, GCI_VEL,
	     88 C		    GSE_POS, GSE_POS, GSM_POS, GSM_POS, and SUN_VEC. 
	     89 C
	     90 C     EPOCH_TIME:
	     91 C	  REAL*8    An array of NPOINTS elements containing Epoch times.  Each
	     92 C		    element of EPOCH_TIME is associated with the corresponding
	     93 C		    position and velocity value(s) stored in the remaining
	     94 C		    arguments.
	     95 C	
	     96 C     GCI_POS:
	     97 C	  /EPHEMERIS/	An array of NPOINTS RECORDs of structure type /EPHEMERIS/.
	     98 C		    This contains positions in GCI coordinates which were
	     99 C		    retrieved from the CDF data file.
	    100 C      
	    101 C     GCI_VEL:
	    102 C	  /EPHEMERIS/	An array of NPOINTS RECORDs of structure type /EPHEMERIS/.
	    103 C		    This contains velocities in GCI coordinates which were
	    104 C		    retrieved from the CDF data file.
	    105 C      
	    106 C     GSE_POS:
	    107 C	  /EPHEMERIS/	An array of NPOINTS RECORDs of structure type /EPHEMERIS/.
	    108 C		    This contains positions in GSE coordinates which were
	    109 C		    retrieved from the CDF data file.
	    110 C      
	    111 C     GSE_VEL:
	    112 C	  /EPHEMERIS/	An array of NPOINTS RECORDs of structure type /EPHEMERIS/.
	    113 C		    This contains velocities in GSE coordinates which were
	    114 C		    retrieved from the CDF data file.

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   3
                                                                22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	    115 C      
	    116 C     GSM_POS:
	    117 C	  /EPHEMERIS/	An array of NPOINTS RECORDs of structure type /EPHEMERIS/.
	    118 C		    This contains positions in GSM coordinates which were
	    119 C		    retrieved from the CDF data file.
	    120 C      
	    121 C     GSM_VEL:
	    122 C	  /EPHEMERIS/	An array of NPOINTS RECORDs of structure type /EPHEMERIS/.
	    123 C		    This contains velocities in GSM coordinates which were
	    124 C		    retrieved from the CDF data file.
	    125 C      
	    126 C     SUN_VEC:
	    127 C	  /EPHEMERIS/	An array of NPOINTS RECORDs of structure type /EPHEMERIS/.
	    128 C		    This contains positions in GCI sun vector coordinates which
	    129 C		    were retrieved from the CDF data file.
	    130 C  
	    131 C COMMON BLOCKS:
	    132 C  
	    133 C     None
	    134 C  
	    135 C DESIGN:
	    136 C  
	    137 C     format and output heading
	    138 C     loop through arrays
	    139 C     	  build output line internally
	    140 C	  write constructed output line to output unit
	    141 C
	    142 C     The line is built internally to allow us greater control over its format.
	    143 C     If bit 0 of the argument FORM is 1 tab characters (hex 9) will be
	    144 C     inserted between the output columns to facilitate loading into a
	    145 C     spreadsheet program; if bit 0 is 0 spaces will be inserted.  The formats
	    146 C     will also be changed depending on the units and coordinate system used to
	    147 C     make viewing easier.
	    148 C
	    149 C     Since the eventual receiving device may  not be one which understands
	    150 C     Fortran carriage controls this program does not use them.  It assumes the
	    151 C     unit D_UNIT was opened without carriage control (CARRIAGECONTROL='NONE')
	    152 C     or with listing carriage control (CARRIAGECONTROL='LIST').  None of the
	    153 C     format statements have a leading space (1X format) or top-of-form ('1').
	    154 C
	    155 C 
	    156 C This version:    7-JUN-1995	  1.3
	    157 C 
	    158 C Created: 
	    159 C 
	    160 C	 2-JUN-1995    Larry Bleau
	    161 C 
	    162 C Revised:
	    163 C 
	    164 C	 Date     | Name  | Description
	    165 C ----------------+-------+-----------------------------------------------------
	    166 C  5-JUN-1995     |  LRB  | added option of displaying all values of each triple
	    167 C  			    on the same line
	    168 C  6-JUN-1995     |  LRB  | fixed up header to center it
	    169 C  7-JUN-1995     |  LRB  | {tbs}
	    170 C [change_entry]
	    171 C 

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   4
                                                                22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	    172 C-
	    173 CDEC$	IDENT '1.3'

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   5
1.3                                                             22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	    175 	IMPLICIT NONE
	    176 	INCLUDE 'INC_DIR:EPHDEF.INC'
	    208 	INCLUDE 'CDF$INC:CDF.INC/NOLIST'
	   1374 	INTEGER*4 d_unit, npoints, form, units, system, interval
	   1375 	REAL*8 beg_date, end_date, epoch_time(npoints)
	   1376 	LOGICAL*4 what_info(7)
	   1377 	RECORD /EPHEMERIS/ gci_pos(npoints), gci_vel(npoints), gse_pos(npoints),
	   1378 	1 gse_vel(npoints), gsm_pos(npoints), gsm_vel(npoints), sun_vec(npoints)
	   1379 C
	   1380 	INTEGER i,j,ii/1/,table_width,pos,prefixlen,whicharr,linelen
	   1381 	INTEGER width,width_list(3,2,2,2)
	   1382 	INTEGER year,month,day,hour,minute,second,msec,ndays
	   1383 	REAL*8 epoch_temp
	   1384 	CHARACTER*500 line,lines(3)
	   1385 	CHARACTER*7 format_list(3,2,2,2),format_to_use(3)
	   1386 	CHARACTER*(EPOCH_STRING_LEN) date1,date2
	   1387 	CHARACTER heading1(7)*8,heading2(7)*8,prefix*42
	   1388 	CHARACTER*30 title1/'WIND Satellite Position Report'/
	   1389 	CHARACTER*14 title2/'For the Period'/
	   1390 	CHARACTER symbol1(3,2)*5,symbol2(2)*4
	   1391 	LOGICAL use_tab,easy_date,float_epoch,display_header,time_first_only
	   1392 	LOGICAL separate_lines,use_doy
	   1393 	STATIC ii
	   1394 	EQUIVALENCE (line,lines(1))
	   1395 C
	   1396 	DATA format_list/3*'(F11.1)',3*'(F07.3)',3*'(F11.3)',3*'(E10.3)',
	   1397 	1		 '(F11.1)',2*'(F09.3)','(F09.3)',2*'(F09.3)',
	   1398 	1		 '(F11.3)',2*'(F09.3)','(E10.3)',2*'(F09.3)'/
	   1399 	DATA width_list/3*11,3*7,3*11,3*10, 11,9,9, 9,9,9, 11,9,9, 10,9,9/
	   1400 	DATA heading1/'   GCI  ','   GCI  ','   GSE  ','   GSE  ',
	   1401 	1	      '   GSM  ','   GSM  ',' GCI Sun'/
	   1402 	DATA heading2/'Position','Velocity','Position','Velocity',
	   1403 	1	      'Position','Velocity',' Vector '/
	   1404 	DATA symbol1/'  X  ','  Y  ','  Z  ','  r  ','theta',' phi '/
	   1405 	DATA symbol2/'(km)','(Re)'/
	   1406 C
	   1407 C Initialize some stuff
	   1408 C 
	   1409 	use_tab = BTEST (form, 0)
	   1410 	easy_date = .not. BTEST (form, 1)
	   1411 	float_epoch = BTEST (form, 2)
	   1412 	display_header = .not. BTEST (form, 3)
	   1413 	time_first_only = .not. BTEST (form, 4)
	   1414 	separate_lines = .not. BTEST (form, 5)
	   1415 	use_doy = BTEST ( form, 6)
	   1416 C
	   1417 C Compute eventual width of output table.
	   1418 C Count the number of columns occupied by the date/time string, Epoch time, or
	   1419 C both.
	   1420 C
	   1421 	table_width = 1
	   1422 C Check if we're to use normal, easy-to-read, date; if so, count its width.
	   1423 C Allow for either day-month-year or year-dayofyear format.
	   1424 	IF (easy_date) THEN
	   1425 	    IF (use_doy) THEN
	   1426 		table_width = table_width + 18 + 2
	   1427 	    ELSE

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   6
1.3                                                             22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1428 		table_width = table_width + 20 + 2
	   1429 	    END IF
	   1430 	END IF
	   1431 C Check if we're to use floating point version of Epoch time; if so, count its
	   1432 C width
	   1433 	IF (float_epoch) table_width = table_width + 15 + 2
	   1434 C
	   1435 C Leave 2 columns spacing between end of time and first data value
	   1436 C Also remember where we are for use later on
	   1437 C
	   1438 	table_width = table_width + 2
	   1439 	prefixlen = table_width - 1
	   1440 C
	   1441 C Now step through the array what_info.  For each element that is .TRUE.
	   1442 C add its corresponding field width to table_width.  For now this code assumes
	   1443 C each component of an entity (x,y,z) will occupy the same number of columns.
	   1444 C
	   1445 	DO whicharr=1,7
	   1446 	    IF (what_info(whicharr)) THEN
	   1447 		width = width_list(1,mod(whicharr-1,2)+1,units+1,system+1)
	   1448 		IF (separate_lines) THEN
	   1449 		    table_width = table_width + width + 3
	   1450 		ELSE
	   1451 		    table_width = table_width + 3 * (width + 3)
	   1452 		END IF
	   1453 	    END IF
	   1454 	END DO
	   1455 C Adjust for blanks after last field
	   1456 	table_width = table_width - 3
	   1457 C
	   1458 C Display title unless disabled
	   1459 C Make sure they are all centered
	   1460 C
	   1461 	IF (display_header) THEN
	   1462 C
	   1463 C Center and print first title line, which is report/program name
	   1464 C
	   1465 	    write(d_unit,1001,err=900)
	   1466 	    line = ' '
	   1467 	    i = (table_width - LEN(title1)) / 2
	   1468 	    line(i+1:) = title1
	   1469 	    write(d_unit,1002,err=900) line(1:LEN(title1)+i)
	   1470 C
	   1471 C Center and print second title line
	   1472 C
	   1473 	    line = ' '
	   1474 	    i = (table_width - LEN(title2)) / 2
	   1475 	    line(i+1:) = title2
	   1476 	    write(d_unit,1002,err=900) line(1:LEN(title2)+i)
	   1477 C
	   1478 C Construct third title line, which gives starting and ending date/times of
	   1479 C interval.
	   1480 C We'll only use 17 chars from each date/time (the date part plus the hours and
	   1481 C minutes), plus the ' to ' connector, for a total length of 38.
	   1482 C
	   1483 	    call encode_epoch(beg_date, date1)
	   1484 	    call encode_epoch(end_date, date2)

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   7
1.3                                                             22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1485 C
	   1486 	    line = ' '
	   1487 	    i = (table_width - 38) / 2
	   1488 	    line(i+1:) = date1(1:17) // ' to ' // date2(1:17)
	   1489 	    write(d_unit,1002,err=900) line(1:i+38)
	   1490 C
	   1491 C Construct fourth title, which gives sampling interval used
	   1492 C
	   1493 	    line = ' '
	   1494 	    width = INT(ALOG10(FLOAT(interval*10))) + 1
	   1495 	    i = (table_width - 32 - width) / 2
	   1496 	    write(line(i+1:i+width+32),1006,err=900) interval*10
	   1497 	    write(d_unit,1002,err=900) line(1:i+32+width)
	   1498 C
	   1499 C Output blank line as separator
	   1500 C
	   1501 	    write(d_unit,1001,err=900)
	   1502 C
	   1503 	    pos = 1
	   1504 	    lines(1) = ' '
	   1505 	    lines(2) = ' '
	   1506 C
	   1507 C Insert proper heading if Epoch time is to be displayed in normal date/time
	   1508 C format.  If user wants day-of-year format use fewer columns.  Leave 2 blanks
	   1509 C after field end in either case.
	   1510 C nn-mmm-yyyy hh:mm:ss
	   1511 C yyyy nnn  hh:mm:ss
	   1512 C
	   1513 	    IF (easy_date) THEN
	   1514 		IF (use_doy) THEN
	   1515 		    lines(1)(pos:pos+18-1) = ' '
	   1516 		    lines(2)(pos:pos+18-1) = 'Year / DOY / Time'
	   1517 		    pos = pos + 18 + 2
	   1518 		ELSE
	   1519 		    lines(1)(pos:pos+20-1) = ' '
	   1520 		    lines(2)(pos:pos+20-1) = '   Date  /  Time    '
	   1521 		    pos = pos + 20 + 2
	   1522 		END IF
	   1523 	    END IF
	   1524 C
	   1525 C Insert proper heading if Epoch time is to be displayed as a REAL*8 in F15.0.
	   1526 C Leave 2 blanks after field end.
	   1527 C
	   1528 	    IF (float_epoch) THEN
	   1529 		lines(1)(pos:pos+15-1) = '   Date/Time   '
	   1530 		lines(2)(pos:pos+15-1) = '    (Epoch)    '
	   1531 		pos = pos + 15 + 2
	   1532 	    END IF
	   1533 C Advance another 2 columns to leave plenty of room
	   1534 	    pos = pos + 2
	   1535 C
	   1536 C Step through the array what_info.  For each element that is .TRUE. build
	   1537 C another part of the header line with the appropriate quantity name.
	   1538 C
	   1539 	    DO 200 whicharr=1,7
	   1540 		IF (what_info(whicharr)) THEN
	   1541 		    width = width_list(1,mod(whicharr-1,2)+1,units+1,system+1)

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   8
1.3                                                             22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1542 		    i = (width - LEN(heading1(whicharr))) / 2 + 2
	   1543 		    IF (separate_lines) THEN
	   1544 			lines(1)(pos+i-1:) = heading1(whicharr)
	   1545 			lines(2)(pos+i-1:) = heading2(whicharr)
	   1546 			pos = pos + width + 3
	   1547 		    ELSE
	   1548 			j = LEN(heading1(whicharr)) + LEN(heading2(whicharr))
	   1549 			i = (3*(width+3) - j - LEN(symbol2(units+1)) - 2) / 2 + 2
	   1550 			lines(1)(pos+i-1:) = heading1(whicharr) //
	   1551 	1		    heading2(whicharr) // '  ' // symbol2(units+1)
	   1552 			i = (width - 1) / 2
	   1553 			DO j=1,3
	   1554 			    lines(2)(pos+i-1:) = symbol1(j,system+1)
	   1555 			    pos = pos + width + 3
	   1556 			END DO
	   1557 		    END IF
	   1558 		END IF
	   1559 200	    END DO
	   1560 C
	   1561 C The heading lines are now built; write them out.
	   1562 C
	   1563 	    write(d_unit,1002,err=900) lines(1)(1:pos-1)
	   1564 	    write(d_unit,1002,err=900) lines(2)(1:pos-1)
	   1565 	    write(d_unit,1001,err=900)
	   1566 	END IF
	   1567 C
	   1568 C Loop through data points
	   1569 C Use argument interval as the increment in the loop index so we'll display only
	   1570 C every interval'th set of values
	   1571 C The variable pos is the character index in the line variable (or lines array)
	   1572 C where the next character is to be stored; pos-1 is the number of characters to
	   1573 C be output.
	   1574 C Build the prefix line only once per Epoch time (set of data points).  The
	   1575 C prefix contains one, or both, formats of the Epoch time.  It is prefixlen
	   1576 C chars long.  When riting out lines write out prefix first concatenated with
	   1577 C lines(i) *on the same line*.  If (x,y,z) triples are to be displayed on
	   1578 C separate lines and Epoch times are to be displayed only once per triple, blank
	   1579 C out prefix after the first write.
	   1580 C

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page   9
1.3                                                             22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1582 	DO 400 WHILE (ii .le. npoints)
	   1583 	    prefix = ' '
	   1584 	    pos = 1
	   1585 C Check if we're to use normal, easy-to-read, date; if so, insert it
	   1586 	    IF (easy_date) THEN
	   1587 		IF (use_doy) THEN
	   1588 		    call epoch_breakdown(epoch_time(ii), year, month, day, hour,
	   1589 	1				 minute, second, msec)
	   1590 		    call compute_epoch(year, 0, 1, 0, 0, 0, 0, epoch_temp)
	   1591 		    ndays = INT((epoch_time(ii) - epoch_temp) /
	   1592 	1			(24. * 60. * 60. * 1000.))
	   1593 	1		    + 1
	   1594 		    write(prefix(pos:pos+18-1),1005) year,ndays,hour,minute,second
	   1595 		    pos = pos + 18 + 2
	   1596 		ELSE
	   1597 		    call encode_epoch(epoch_time(ii), date1)
	   1598 		    prefix(pos:pos+20-1) = date1(1:20)
	   1599 		    pos = pos + 20 + 2
	   1600 		END IF
	   1601 	    END IF
	   1602 C Check if we're to use floating point version of Epoch time; if so, insert it
	   1603 	    IF (float_epoch) THEN
	   1604 		write(prefix(pos:pos+15-1),1003,err=900) epoch_time(ii)
	   1605 		pos = pos + 15 + 2
	   1606 	    END IF
	   1607 C Initialize lines that will hold tables of output
	   1608 	    pos = 1
	   1609 	    lines(1) = ' '
	   1610 	    lines(2) = ' '
	   1611 	    lines(3) = ' '
	   1612 C
	   1613 C Loop through the array what_info, testing each element.  If it is .TRUE. get
	   1614 C the corresponding value from the proper array.  Pass this record (which passes
	   1615 C all three values) to the routine insert_in_line, along with the correct format
	   1616 C to use and where to insert it in the line.  Upon return lines(1)..lines(3)
	   1617 C have been updated with the proper values.
	   1618 C
	   1619 	    DO 300 whicharr=1,7
	   1620 		IF (what_info(whicharr)) THEN
	   1621 		    DO i=1,3
	   1622 			format_to_use(i) =
	   1623 	1		  format_list(i,mod(whicharr-1,2)+1,units+1,system+1)
	   1624 		    END DO
	   1625 		    width = width_list(1,mod(whicharr-1,2)+1,units+1,system+1)
	   1626 		    GO TO (210,220,230,240,250,260,270), whicharr
	   1627 C
	   1628 210		    call insert_in_line(gci_pos(ii),format_to_use,width,use_tab,
	   1629 	1				separate_lines,pos,lines)
	   1630 		    goto 280
	   1631 C
	   1632 220		    call insert_in_line(gci_vel(ii),format_to_use,width,use_tab,
	   1633 	1				separate_lines,pos,lines)
	   1634 		    goto 280
	   1635 C
	   1636 230		    call insert_in_line(gse_pos(ii),format_to_use,width,use_tab,
	   1637 	1				separate_lines,pos,lines)
	   1638 		    goto 280

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  10
1.3                                                             22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1639 C
	   1640 240		    call insert_in_line(gse_vel(ii),format_to_use,width,use_tab,
	   1641 	1				separate_lines,pos,lines)
	   1642 		    goto 280
	   1643 C
	   1644 250		    call insert_in_line(gsm_pos(ii),format_to_use,width,use_tab,
	   1645 	1				separate_lines,pos,lines)
	   1646 		    goto 280
	   1647 C
	   1648 260		    call insert_in_line(gsm_vel(ii),format_to_use,width,use_tab,
	   1649 	1				separate_lines,pos,lines)
	   1650 		    goto 280
	   1651 C
	   1652 270		    call insert_in_line(sun_vec(ii),format_to_use,width,use_tab,
	   1653 	1				separate_lines,pos,lines)
	   1654 		    goto 280
	   1655 C
	   1656 280		    CONTINUE
	   1657 		END IF
	   1658 300	    END DO
	   1659 C
	   1660 C At this point lines(1..3) have been filled with formatted values for whatever
	   1661 C the user wanted displayed.  If separate_lines is .false. only lines(1) has
	   1662 C been filled.  In either case it is time to write them/it out.  pos-1 is the
	   1663 C number of characters inserted in each line.  This includes the trailing <tab>
	   1664 C or trailing spaces, however, which were inserted by insert_in_line, so
	   1665 C shorten it appropriately.
	   1666 C
	   1667 	    IF (use_tab) THEN
	   1668 		linelen = pos - 2
	   1669 	    ELSE
	   1670 		linelen = pos - 4
	   1671 	    END IF
	   1672 	    write(d_unit,1004,err=900) prefix(1:prefixlen),lines(1)(1:linelen)
	   1673 C
	   1674 C If separate_lines is .true. then also write out lines(2) and lines(3).
	   1675 C If Epoch time is to be displayed only on first line of the three lines blank
	   1676 C out the prefix before doing the writes.
	   1677 C
	   1678 	    IF (separate_lines) THEN
	   1679 		if (time_first_only) prefix = ' '
	   1680 		write(d_unit,1004,err=900) prefix(1:prefixlen),lines(2)(1:linelen)
	   1681 		write(d_unit,1004,err=900) prefix(1:prefixlen),lines(3)(1:linelen)
	   1682 	    END IF
	   1683 	    ii = ii + interval
	   1684 400	END DO
	   1685 C
	   1686 C Decrease pointer ii by npoints so the next time this routine is entered the
	   1687 C sampling interval's phase is maintained.  Using the previous method
	   1688 C (controlled by a simple DO loop) would result in the first value always being
	   1689 C displayed.
	   1690 C
	   1691 	ii = ii - npoints
	   1692 C
	   1693 900	RETURN
	   1694 C
	   1695 C Here are the format statements

DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  11
1.3                                                             22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1696 C
	   1697 1001	format()
	   1698 1002	format(A)
	   1699 1003	format(F15.0)
	   1700 1004	format(A,A)
	   1701 1005	format(I4,1X,I3,2X,I2,':',I2.2,':',I2.2)
	   1702 1006	format('Sampling Interval Used: ',I<width>,' Minutes')
	   1703 	END


PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 504 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                                 1680 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  3 $IODATA$                               176 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                                9620   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                 675 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA

    Total Space Allocated                12655


ENTRY POINTS

    Address   Type  Name              
                                      
  4-00000010        DISPLAY_ORBIT_INFO


VARIABLES

    Address   Type  Name                Address   Type  Name                Address   Type  Name           
                                                                                                           
      **      R*8   BEG_DATE        REG-########  I*4   I                 2-0000002C  I*4   SECOND         
  2-00000014  I*4   CDF_ATTR_NUM      1-00000028  I*4   II                0-00000064  L*4   SEPARATE_LINES 
  2-00000010  I*4   CDF_VAR_NUM           **      I*4   INTERVAL              **      I*4   SYSTEM         
  2-00000050  CHAR  DATE1                 **      I*4   J               REG-########  I*4   TABLE_WIDTH    
  2-00000068  CHAR  DATE2             2-000000B0  CHAR  LINE              0-00000070  L*4   TIME_FIRST_ONLY
  2-00000020  I*4   DAY             REG-00000004  I*4   LINELEN           1-000000A0  CHAR  TITLE1         
REG-00000015  L*4   DISPLAY_HEADER    2-00000028  I*4   MINUTE            1-000000C0  CHAR  TITLE2         
      **      I*4   D_UNIT            2-0000001C  I*4   MONTH                 **      I*4   UNITS          
REG-00000012  L*4   EASY_DATE         2-00000030  I*4   MSEC              0-00000074  L*4   USE_DOY        
      **      R*8   END_DATE          0-0000008C  I*4   NDAYS             0-00000060  L*4   USE_TAB        
  2-00000008  R*8   EPOCH_TEMP            **      I*4   NPOINTS         REG-########  I*4   WHICHARR       
REG-00000013  L*4   FLOAT_EPOCH       0-0000008C# I*4   POS               2-00000004  I*4   WIDTH          
      **      I*4   FORM              2-00000080  CHAR  PREFIX            2-00000018  I*4   YEAR           
  2-00000024  I*4   HOUR              0-00000088  I*4   PREFIXLEN                                          



DISPLAY_ORBIT_INFO                                              22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  12
1.3                             Symbol Table                    22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

ARRAYS

     Address  Type  Name                 Bytes  Dimensions

      **      R*8   EPOCH_TIME              **  (*)
  1-000000F0  CHAR  FORMAT_LIST            168  (3, 2, 2, 2)
  2-00000038  CHAR  FORMAT_TO_USE           21  (3)
  1-00000030  CHAR  HEADING1                56  (7)
  1-00000068  CHAR  HEADING2                56  (7)
  2-000000B0  CHAR  LINES                 1500  (3)
  1-000000D0  CHAR  SYMBOL1                 30  (3, 2)
  1-00000020  CHAR  SYMBOL2                  8  (2)
      **      L*4   WHAT_INFO               28  (7)
  1-00000198  I*4   WIDTH_LIST              96  (3, 2, 2, 2)



RECORD ARRAYS

    Address   Name     Structure         Bytes  Dimensions

      **      GCI_POS  EPHEMERIS           **  (*)
      **      GCI_VEL  EPHEMERIS           **  (*)
      **      GSE_POS  EPHEMERIS           **  (*)
      **      GSE_VEL  EPHEMERIS           **  (*)
      **      GSM_POS  EPHEMERIS           **  (*)
      **      GSM_VEL  EPHEMERIS           **  (*)
      **      SUN_VEC  EPHEMERIS           **  (*)



LABELS

    Address   Label     Address   Label     Address   Label     Address   Label     Address   Label
                                                                                                   
  4-00000BFC   200    4-000014C0   240        **       280        **       1001       **       1005
  4-00001208   210    4-000015A8   250    4-00001874   300        **       1002       **       1006
  4-000012F0   220    4-00001690   260        **       400        **       1003                    
  4-000013D8   230    4-00001778   270    4-00001A4C   900        **       1004                    


FUNCTIONS AND SUBROUTINES REFERENCED

  Type  Name                    Type  Name                 
                                                           
        COMPUTE_EPOCH                 EPOCH_BREAKDOWN      
        ENCODE_EPOCH                  INSERT_IN_LINE       

INSERT_IN_LINE                                                  22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  13
1.3                             Symbol Table                    22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1705 	SUBROUTINE insert_in_line(info, format_to_use, width, use_tab,
	   1706 	1 separate_lines, pos, lines)
	   1707  
	   1708 C+
	   1709 C 
	   1710 C FUNCTIONAL DESCRIPTION:	
	   1711 C 
	   1712 C    This subroutine accepts a floating point value and formats it into a
	   1713 C    string.  Using various other parameters to control string formatting, it
	   1714 C    then stores the formatted string into one of the parameters and keeps track
	   1715 C    of the total number of characters stored.
	   1716 C 
	   1717 C FORMAL PARAMETERS:
	   1718 C  
	   1719 C     INFO:
	   1720 C	  REAL*8    An array of length 3 containing the value which is to be
	   1721 C		    formatted.  Each entity to be formatted actually has three
	   1722 C		    components.
	   1723 C      
	   1724 C     FORMAT_TO_USE:
	   1725 C	  CHAR*(*)  A CHARACTER array with three elements containing the Fortran
	   1726 C		    format string to use in the conversion of INFO.  Each
	   1727 C		    element of FORMAT_TO_USE corresponds to one of the elements
	   1728 C		    in INFO.
	   1729 C      
	   1730 C     WIDTH:
	   1731 C	  INT*4	    The number of character positions required by the format
	   1732 C		    FORMAT_TO_USE.
	   1733 C      
	   1734 C     USE_TAB:
	   1735 C	  LOG*4	    A flag controlling the field separation character.  If
	   1736 C		    .TRUE. an Ascii horizontal tab character will be inserted 
	   1737 C		    after each field; if .FALSE. 3 spaces will be inserted.
	   1738 C      
	   1739 C     SEPARATE_LINES:
	   1740 C	  LOG*4	    A flag controller the placement of the 3 values on multiple
	   1741 C		    lines.  If .TRUE. the values will be placed in the same
	   1742 C		    columns but on separate lines; if .FALSE. the values will
	   1743 C		    all be placed in diffrent columns on the same line.
	   1744 C      
	   1745 C     POS:
	   1746 C	  INT*4	    A integer giving the starting character position of this
	   1747 C		    field within the LINES parameter.  When the formatted value
	   1748 C		    is stored its first character is stored at position POS
	   1749 C		    within LINES.  POS is updated after the field and its
	   1750 C		    trailing separator are inserted, so this variable is both
	   1751 C		    input and output.
	   1752 C      
	   1753 C     LINES:
	   1754 C	  CHAR*(*)  A CHARACTER array with 3 elements.  The formatted values of
	   1755 C		    INFO are stored into LINES starting at character position
	   1756 C		    POS.  If SEPARATE_LINES is .TRUE. the three values of INFO
	   1757 C		    are stored into LINES(1), LINES(2), LINES(3); if it is
	   1758 C		    .FALSE. the values are all stored into LINES(1) in
	   1759 C		    successive positions.
	   1760 C  
	   1761 C COMMON BLOCKS:

INSERT_IN_LINE                                                  22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  14
1.3                             Symbol Table                    22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1762 C  
	   1763 C     None
	   1764 C  
	   1765 C DESIGN:
	   1766 C  
	   1767 C     {tbs}
	   1768 C  
	   1769 C 
	   1770 C This version:    5-JUN-1995    1.0
	   1771 C
	   1772 C Created: 
	   1773 C 
	   1774 C	 2-JUN-1995    Larry Bleau
	   1775 C 
	   1776 C Revised:
	   1777 C 
	   1778 C	 Date     | Name  | Description
	   1779 C ----------------+-------+-----------------------------------------------------
	   1780 C  5-JUN-1995     |  LRB  | added comments
	   1781 C 
	   1782 C-
	   1783 	IMPLICIT NONE
	   1784 	INCLUDE 'INC_DIR:EPHDEF.INC'
	   1816 	INTEGER*4 pos, width
	   1817 	LOGICAL*4 use_tab, separate_lines
	   1818 	CHARACTER lines(3)*500, format_to_use(3)*(*)
	   1819 	RECORD /EPHEMERIS/ info
	   1820 C
	   1821 	INTEGER i,next_pos
	   1822 	LOGICAL insert_units/.TRUE./
	   1823 	CHARACTER*20 stars/'********************'/
	   1824 C 
	   1825 C To make life easy use the structure member "member", which is a REAL*8 array
	   1826 C of length 3.  This effectively allows the (x,y,z) (or the (d,theta,phi))
	   1827 C triple to be accessed serially as an array.
	   1828 C
	   1829 	IF (separate_lines) GOTO 200
	   1830 C
	   1831 C This code segment gets executed if the three values are to be placed all on
	   1832 C the same line
	   1833 C
	   1834 	DO 120 i=1,3
	   1835 	    write(lines(1)(pos:pos+width-1),format_to_use(i),err=910) info.member(i) 
	   1836 	    GOTO 110
	   1837 C
	   1838 910	    type *,'internal format error, pos=',pos,', fmt=',format_to_use(i),', info='
	   1839 	    type *,'i=',i,', datum=',info.member(i)
	   1840 	    lines(1)(pos:pos+width-1) = stars(1:width)
	   1841 C
	   1842 110	    IF (use_tab) THEN
	   1843 		lines(1)(pos+width:pos+width) = CHAR(9)
	   1844 		pos = pos + width + 1	    ! advance pointer to just beyond the
	   1845 					    ! <tab> we inserted
	   1846 	    ELSE
	   1847 		pos = pos + width + 2	    ! advance pointer to leave 2 spaces
	   1848 					    ! between fields
	   1849 	    END IF

INSERT_IN_LINE                                                  22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  15
1.3                             Symbol Table                    22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

	   1850 120	END DO
	   1851 	IF (.not. use_tab) pos = pos + 1    ! leave additional space between
	   1852 					    ! triples
	   1853 	RETURN
	   1854 C
	   1855 C This code segment gets executed if the three values are to be placed on
	   1856 C separate lines
	   1857 C
	   1858 200	DO 220 i=1,3
	   1859 	    write(lines(i)(pos:pos+width-1),format_to_use(i),err=920) info.member(i)
	   1860 	    IF (use_tab) lines(i)(pos+width:pos+width) = CHAR(9)
	   1861 	    GOTO 220
	   1862 C
	   1863 920	    type *,'internal format error, pos=',pos,', fmt=',format_to_use(i),', info='
	   1864 	    type *,'i=',i,', datum=',info.member(i)
	   1865 	    lines(i)(pos:pos+width-1) = stars(1:width)
	   1866 220	END DO
	   1867 C
	   1868 	IF (use_tab) THEN
	   1869 	    pos = pos + width + 1	! advance pointer to just beyond the
	   1870 					! <tab> we inserted
	   1871 	ELSE
	   1872 	    pos = pos + width + 3	! advance pointer to leave 3 spaces
	   1873 					! between triples
	   1874 	END IF
	   1875 	RETURN
	   1876 	END


PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 504 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                                 1680 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  3 $IODATA$                               176 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                                9620   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                 675 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA

    Total Space Allocated                12655


ENTRY POINTS

    Address   Type  Name          
                                  
  4-00001D38        INSERT_IN_LINE



INSERT_IN_LINE                                                  22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  16
1.3                             Symbol Table                    22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44

VARIABLES

    Address   Type  Name               Address   Type  Name               Address   Type  Name          
                                                                                                        
  0-00000038# I*4   I                    **      I*4   POS                  **      L*4   USE_TAB       
  1-00000000  L*4   INSERT_UNITS         **      L*4   SEPARATE_LINES       **      I*4   WIDTH         
  2-00000000  I*4   NEXT_POS         1-00000008  CHAR  STARS                                            


RECORDS

    Address   Name  Structure        Bytes
                                          
      **      INFO  EPHEMERIS           24


ARRAYS

     Address  Type  Name                 Bytes  Dimensions

      **      CHAR  FORMAT_TO_USE     10282140  (3)
      **      CHAR  LINES                 1500  (3)



LABELS

    Address   Label     Address   Label     Address   Label
                                                           
  4-0000205C   110        **       200        **       910 
  4-000020DC   120    4-00002408   220        **       920 

INSERT_IN_LINE                                                  22-JUN-1995 19:37:26    DEC Fortran V6.2-508                Page  17
1.3                             Symbol Table                    22-JUN-1995 19:36:30    [WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.FOR;44



  +---------------------------------------------------+
  |               KEY TO ADDRESS CODE FORMATS         |
  |   ppp-oooooooo  - In Psect ppp, Offset oooooooo   |
  |   ***-********  - External                        |
  |               # - Suffix: Also In Registers       |
  |   REG-rrrrrrrr  - In Register rrrrrrrr            |
  |   REG-########  - In Various Registers            |
  |        **       - Not Used; Not Allocated         |
  +---------------------------------------------------+


COMMAND QUALIFIERS

  /ALIGNMENT=(COMMONS=(PACKED,NOMULTILANGUAGE),RECORDS=NATURAL)
  /ASSUME=(ACCURACY_SENSITIVE,BACKSLASH,NODUMMY_ALIASES,NOUNDERSCORE)
  /CHECK=(ASSERTIONS,BOUNDS,FORMAT,FP_EXCEPTIONS,OVERFLOW,ÿÿÿ°&¶
  /DEBUG=(NOSYMBOLS,TRACEBACK)
  /DESIGN=(NOCOMMENTS)
  /SHOW=(NODICTIONARY,NOINCLUDE,MAP,NOPREPROCESSOR)
  /STANDARD=(NOSEMANTIC,NOSOURCE_FORM,NOSYNTAX)
  /WARNINGS=(ALIGNMENT,NOARGUMENT_CHECKING,DECLARATIONS,GENERAL,NOTRUNCATED_SOURCE,UNCALLED,
             UNINITIALIZED,UNREACHABLE,UNUSED)
  /NOAUTOMATIC  /BLAS=NOMAPPED  /CONVERT=NATIVE  /NOCROSS_REFERENCE  /NOD_LINES  /ERROR_LIMIT=30  /EXTEND_SOURCE
  /NOPAD_SOURCE  /NOF77  /FLOAT=G_FLOAT  /IEEE_MODE=FAST  /ROUNDING_MODE=NEAREST
  /GRANULARITY=QUADWORD  /INSTRUCTION_SET=FLOATING  /INTEGER_SIZE=32  /NOMACHINE_CODE
  /MATH_LIBRARY=ACCURATE  /NAMES=UPPERCASE  /OPTIMIZE=(LEVEL=4,UNROLL=0)  /REAL_SIZE=32  /NORECURSIVE
  /NOSEPARATE_COMPILATION  /NOSYNCHRONOUS_EXCEPTIONS  /NOSYNTAX_ONLY  /TERMINAL=NOSTATISTICS  /NOTIE  /VMS
  /NOANALYSIS_DATA
  /NODIAGNOSTICS
  /INCLUDE=(.FOR,.f,FORT$INCLUDE:.FOR,FORT$INCLUDE:.f)
  /LIST=SMS1:[WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.LIS;48
  /OBJECT=SMS1:[WIND.SOFTWARE.L1]DISPLAY_ORBIT_INFO.OBJ;35
  /NOLIBRARY
   sys$lib=SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1

COMPILER: DEC Fortran V6.2-508-274F

COMPILATION STATISTICS

  CPU time:          3.70 seconds
  Elapsed time:      5.75 seconds
  Pagefaults:         389
  I/O Count:           47
