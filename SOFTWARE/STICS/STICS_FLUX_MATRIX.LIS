WEIGHT_FACTORS_VS                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   1
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	      1 
	      2       PROGRAM STICS_FLUX_MATRIX
	      3 
	      4 C This program reads a WIND L1 data file and dissects the PHA data, printing 
	      5 C it in matrix form of calculated m & m/q for PHA events that fall into
	      6 C the Nm vs Nq matrix, with user requested data selection criteria imposed.
	      7 C Data has basic rate and efficiency corrections applied.
	      8 C
	      9 C STICS_FLUX_MATRIX created by ABG using stics_mmq_matrix v1.10 16-aug-95 as
	     10 C		  a template
	     11 C
	     12 C Revision History:
	     13 C	 6-DEC-1995	K.CHOTOO	Added energy bandwidth to efficiency correction
	     14 C	17-APR-1996	K.CHOTOO	Replaced FSR/Io with DCR/RSR
	     15 C
	     16 C
	     17 CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
	     18       IMPLICIT NONE
	     19 
	     20       INCLUDE	'INC_DIR:EDBDEF.INC/NOLIST'

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   2
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	    558       INCLUDE   'INC_DIR:L1FMT.INC/NOLIST'
	    690       INCLUDE   '($RMSDEF)'
    1	    691 !*** MODULE $RMSDEF ***
    1	    692 CDEC$ OPTIONS/ALIGN=(RECORDS=PACKED,COMMONS=PACKED)
    1	    693  ! 
    1	    694  !  This SDL File Generated by VAX-11 Message V04-00 on 26-JAN-1994 13:51:15.86
    1	    695  ! 
    1	    696  ! 	.TITLE	RMSMSG -RMS COMPLETION CODES
    1	    697  !  *************************************************************************
    1	    698  !  *                                                                       *
    1	    699  !  * COPYRIGHT (C) DIGITAL EQUIPMENT CORPORATION, 1976, 1977, 1978, 1979,  *
    1	    700  !  * 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,     *
    1	    701  !  * 1991,1992                                                             *
    1	    702  !  * ALL RIGHTS RESERVED.                                                  *
    1	    703  !  * UNPUBLISHED RIGHTS RESERVED UNDER THE COPYRIGHT LAWS  OF  THE  UNITED *
    1	    704  !  * STATES.                                                               *
    1	    705  !  *                                                                       *
    1	    706  !  * THE SOFTWARE CONTAINED ON THIS MEDIA IS PROPRIETARY TO  AND  EMBODIES *
    1	    707  !  * THE   CONFIDENTIAL   TECHNOLOGY  OF  DIGITAL  EQUIPMENT  CORPORATION. *
    1	    708  !  * POSSESSION, USE, DUPLICATION OR DISSEMINATION  OF  THE  SOFTWARE  AND *
    1	    709  !  * MEDIA  IS  AUTHORIZED  ONLY  PURSUANT TO A VALID WRITTEN LICENSE FROM *
    1	    710  !  * DIGITAL EQUIPMENT CORPORATION.                                        *
    1	    711  !  *                                                                       *
    1	    712  !  * RESTRICTED RIGHTS LEGEND USE, DUPLICATION, OR DISCLOSURE BY THE  U.S. *
    1	    713  !  * GOVERNMENT  IS  SUBJECT  TO RESTRICTIONS AS SET FORTH IN SUBPARAGRAPH *
    1	    714  !  * (C)(1)(II) OF DFARS 252.227-7013, OR IN FAR 52.227-19, AS APPLICABLE. *
    1	    715  !  *                                                                       *
    1	    716  !  *************************************************************************
    1	    717  ! ++
    1	    718  !  FACILITY: RMS
    1	    719  ! 
    1	    720  !  ABSTRACT:
    1	    721  ! 
    1	    722  ! 	THIS MODULE DEFINES ALL RMS COMPLETION CODES.
    1	    723  ! 
    1	    724  !  ENVIRONMENT:
    1	    725  ! 
    1	    726  ! 	THE MESSAGE TRANSLATOR MUST BE USED TO CONVERT RMSMSG.MSG INTO
    1	    727  ! 	RMSMSG.SDL.  THE SDL TRANSLATOR MUST THEN BE USED TO CONVERT
    1	    728  ! 	RMSMSG.SDL INTO RMSMSG.MAR (AND RMSMSG.B32).
    1	    729  ! 
    1	    730  !  AUTHOR: LEO F. LAVERDURE,	CREATION DATE:  10-DEC-1976
    1	    731  ! 
    1	    732  !  MODIFIED BY:
    1	    733  ! 
    1	    734  !                DEE RYAN                                30-SEP-1993
    1	    735  !                CORRECTED USE OF DIGITAL PRODUCT NAMES.
    1	    736  ! 
    1	    737  ! 	X-5	EMW		ELINOR M. WOODS		28-SEP-1993
    1	    738  ! 		MERGE IN OPENVMS VAX CORAL FIX:
    1	    739  ! 
    1	    740  ! 		X-10	EMW0019  ELINOR M. WOODS  	21-SEP-1993
    1	    741  ! 		ADD ONE NEW USER-REPORTABLE ERROR STATUS (WITH AN
    1	    742  ! 		ASSOCIATED STV): NETBTS.  RELOCATE NEW IDXSEARCH STATUS
    1	    743  ! 		(SEE X-9) FROM "ERROR with STV" SECTION TO "ERROR WITHOUT 
    1	    744  ! 		STV" section.  Expand "WITH STV' AND "without STV"
    1	    745  ! 		COMMENTS TO CLARIFY DIFFERENCE BETWEEN TWO.

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   3
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	    746  ! 
    1	    747  ! 	X-4	EMW0016		ELINOR M. WOODS		10-AUG-1993
    1	    748  ! 		MERGE IN CORAL FIX:
    1	    749  ! 
    1	    750  ! 		MODIFY SEVERITY OF TWO DTF ERROR CODES (DTFACC AND
    1	    751  ! 		DTFCRE) FROM FATAL TO ERROR, AS REQUESTED BY SNA/DTF
    1	    752  ! 		FACILITY.		
    1	    753  ! 
    1	    754  ! 		ALSO MOVE NEW IDXSEARCH STATUS FROM ERROR WITH NO 
    1	    755  ! 		STV GROUPING TO ERROR WITH STV GROUPING.
    1	    756  ! 
    1	    757  ! 	X-3	EMW0010		ELINOR M. WOODS		02-JUL-1993
    1	    758  ! 		TO SUPPORT NEW KEY-LESS-THAN FUNCTIONALITY, ADDITION 
    1	    759  ! 		OF ONE USER-REPORTABLE ERROR STATUS:  IDXSEARCH, AND
    1	    760  ! 		TWO NEW RMS-INTERNAL ERROR STATUSES:  LSCAN AND 
    1	    761  ! 		ROOTSRCH.		
    1	    762  ! 
    1	    763  ! 	X-2	CW0019		CHRIS WHITAKER		11-NOV-1992
    1	    764  ! 		MERGE IN OPENVMS VAX V6.0 CHANGES
    1	    765  ! 
    1	    766  ! 		X-8	JM0012	JOHN MUNZER		11-NOV-1992
    1	    767  ! 		CHANGE TEXT FOR RMS$_LNE.
    1	    768  ! 
    1	    769  ! 		X-7	JM0006	JOHN MUNZER		17-APR-1992
    1	    770  ! 		ADD !XL PARAMETER TO RMS$_BUG TO REPORT R2.
    1	    771  ! 
    1	    772  ! 	X-1	RAB		RICHARD A. BISHOP	24-JUN-1991
    1	    773  ! 		MOVED TO [STARLET] FACILITY
    1	    774  ! 
    1	    775  ! 	==================================
    1	    776  ! 	OLD AUDIT TRAIL FOLLOWS:
    1	    777  ! 
    1	    778  ! 	X-33	LSS0154		LEONARD S. SZUBOWICZ	 4-APR-1990
    1	    779  ! 		ALTER TEXT AND FAO PARAMETERS OF RMS$_RUH AND RMS$_BUG
    1	    780  ! 		CONDITION VALUES FOR RMS/DDTM SUPPORT.
    1	    781  ! 
    1	    782  ! 	X-32	PJH		PAUL J. HOULIHAN	17-JAN-1990
    1	    783  ! 		CHANGE TEXT FOR RMS$_INCOMPSHR ERROR MESSAGE.
    1	    784  ! 
    1	    785  ! 	X-31	LSS0130		LEONARD S. SZUBOWICZ	12-OCT-1989
    1	    786  ! 		MERGE OF RMS/DDTM GENERATION X-30D2.
    1	    787  ! 		ADD GENERAL DDTM_ERR ERROR MESSAGE FOR DDTM SERVICE FAILURES;
    1	    788  ! 		STV WILL CONTAIN THE FAILING SYSTEM SERVICE CONDITION VALUE.
    1	    789  ! 
    1	    790  ! 	X-30	LSS0080		LEONARD S. SZUBOWICZ	06-OCT-1988
    1	    791  ! 		ADD RMS$_OK_ACT MESSAGE FOR USE BY FUTURE WORK TO $DISPLAY.
    1	    792  ! 		THIS IS PART OF LATENT SUPPORT FOR RMS/DDTM.
    1	    793  ! 
    1	    794  ! 	X-29	GJA0080		GARY J. ALLISON		06-JUN-1988
    1	    795  ! 		CHANGE TEXT OF SEMANTICS MESSAGE.
    1	    796  ! 
    1	    797  ! 	X-28	GJA0072		GARY J. ALLISON		02-MAR-1988
    1	    798  ! 		ADD EXT_ERR, OPNOTSUP, EXTNOTFOU, AND SEMANTICS MESSAGES.
    1	    799  ! 
    1	    800  ! 	X-27	PMV0072		PETER M. VATNE		08-OCT-1987
    1	    801  ! 		CHANGE RMS$_NOJNLLIC TO RMS$_JNLNOTAUTH.
    1	    802  ! 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   4
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	    803  !  	X-26	LSS0057		LEONARD S. SZUBOWICZ	15-SEP-1987
    1	    804  ! 		CHANGE TEXT FOR THE RMS$_OK_DUP STATUS SUCH THAT THE MESSAGE
    1	    805  ! 		IS APPLICABLE TO $GET AS WELL AS $PUT.
    1	    806  ! 
    1	    807  ! 	X-25	PMV0068		PETER M. VATNE		11-SEP-1987
    1	    808  ! 		ADD RMS$_NOJNLLIC, NO RMS JOURNALING LICENSE, FOR LMF.
    1	    809  ! 
    1	    810  ! 	X-24	RNM0026		RUSSELL N. MURRAY	15-AUG-1987
    1	    811  ! 		ADD RMS$_SYNCH MESSAGE FOR NOTIFICATION OF SYNCHRONOUS
    1	    812  ! 		COMPLETION.
    1	    813  ! 
    1	    814  ! 	X-23	JEJ0479		JAMES E JOHNSON		13-AUG-1987
    1	    815  ! 		ADD RMS$_IVATRACE MESSAGE.
    1	    816  ! 
    1	    817  ! 	X-22	PMV0061		PETER M. VATNE		03-AUG-1987
    1	    818  ! 		CHANGE RESERVED MESSAGE RMS$_BUG_XX5 TO RMS$_BUG_RU_COMMIT_FAIL
    1	    819  ! 		TO CORRESPOND TO POSITIVE RMS BUGCHECK FTL$_RU_COMMIT_FAIL.
    1	    820  ! 
    1	    821  !  	X-21	LSS0042		LEONARD S. SZUBOWICZ	13-MAY-1987
    1	    822  ! 		CHANGE RESERVED MESSAGE RMS$_BUG_XX4 TO RMS$_BUG_RU_ABORT_FAIL
    1	    823  ! 		TO CORRESPOND TO POSITIVE RMS BUGCHECK FTL$_RU_ABORT_FAIL
    1	    824  ! 	
    1	    825  ! 	X-20	SAD0034		STUART A. DAVIDSON	12-MAR-1987 
    1	    826  ! 		DROP QUOTES FROM SNADTF MESSAGE TEXT.
    1	    827  ! 
    1	    828  ! 	X-19	PJH		PAUL J. HOULIHAN	19-JAN-1987
    1	    829  ! 		MERGE IN 17J1.
    1	    830  ! 
    1	    831  ! 		X-17J1	PJH		PAUL J. HOULIHAN	15-JAN-1987
    1	    832  ! 			FIX SEVERAL SMALL JNL PROBLEMS.
    1	    833  ! 			ADD RMS$_BUG_FLUSH_JNL_FAILED CODE.
    1	    834  ! 
    1	    835  ! 	X-18	KPS0148		KENNETH P. SIEGEL	04-DEC-1986
    1	    836  ! 		ADDED SNPPF (STATISTICS MONITORING NOT SUPPORTED FOR
    1	    837  ! 		PROCESS PERMANENT FILES) ERROR MESSAGE.
    1	    838  ! 
    1	    839  ! 	X-17	PMV0025		PETER M. VATNE		24-NOV-1986
    1	    840  ! 		ADD NEW MESSAGE, RMS$_NOTSAMEJNL.  THIS STATUS IS
    1	    841  ! 		USED TO RESTRICT AI/BI WITH RU JOURNALING TO A
    1	    842  ! 		SINGLE LONG-TERM JOURNAL FILE.
    1	    843  ! 
    1	    844  ! 	X-16	DAS		DAVID A. SOLOMON	18-NOV-1986
    1	    845  ! 		ADD NEW MESSAGE, RMS$_DELJNS. REMOVE RMS$_XCR (BY REPLACING IT
    1	    846  ! 		WITH A PLACEHOLDER), AS JOURNALING BITS ARE NO LONGER
    1	    847  ! 		SPECIFIED IN THE $XABJNL. SLIGHT WORDING CHANGE ON DETACHED
    1	    848  ! 		RU RECOVERY ERROR MESSAGES.
    1	    849  ! 
    1	    850  ! 	X-15	DAS		DAVID A. SOLOMON	12-NOV-1986
    1	    851  ! 		FIX ERROR IN X-5/X-6: JOURNALING VARIANT NOT MERGED
    1	    852  ! 		CORRECTLY, RESULTING IN SEVERAL JOURNALING MESSAGES NUMBERS
    1	    853  ! 		BEING DIFFERENT IN THE MAININE THAN WHAT THEY WERE ON THE
    1	    854  ! 		JOURNALING VARIANT. ALSO, MOVE NEW SNADTF MESSAGES TO RE-USE
    1	    855  ! 		AVAILABLE UNUSED MESSAGE NUMBERS, INSTEAD OF GENERATING NEW
    1	    856  ! 		ONES. FINALLY, CHANGE RMS$_BUG_ABORT TO RMS$_BUG_RU_ACTIVE.
    1	    857  ! 
    1	    858  ! 	X-14	SAD0014		STUART A. DAVIDSON	 4-NOV-1986
    1	    859  ! 		SNADTF - FIX TYPO IN DTFACC, DTFCRE

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   5
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	    860  ! 
    1	    861  ! 	X-13	SAD0014		STUART A. DAVIDSON	 3-NOV-1986
    1	    862  ! 		SNADTF - FIX TYPO, ADD 2 ADDITIONAL MESSAGES.
    1	    863  ! 
    1	    864  ! 	X-12	JEJ0377		JAMES E JOHNSON		29-OCT-1986
    1	    865  ! 		ADD NOEXTEND ERROR CODE TO FLAG FAILED RELATIVE FILE
    1	    866  ! 		EXTENDS DUE TO PREVIOUS FAILURES.
    1	    867  ! 
    1	    868  ! 	X-11	KPS0131		KENNETH P. SIEGEL	25-OCT-1986
    1	    869  ! 		ADDED SNS ERROR CODE FOR STATISTICS NOT SUPPORT ON
    1	    870  ! 		NON-DISK DEVICES.
    1	    871  ! 
    1	    872  ! 	X-10	SAD009		STUART A. DAVIDSON	06-OCT-1986
    1	    873  ! 		ADD COMPLETION CODES FOR SNADTF (IBM DATA XFER)
    1	    874  ! 
    1	    875  ! 	X-9	GJA0003		GARY J. ALLISON		29-SEP-1986
    1	    876  ! 		ADD DETACHED RECOVERY ERROR MESSAGES
    1	    877  ! 
    1	    878  ! 	X-8	PMV0008		PETER M. VATNE		24-SEP-1986
    1	    879  ! 		MODIFY RMS$_ACC_AIJ, RMS$_ACC_BIJ, AND RMS$_ACC_ATJ
    1	    880  ! 		TO ALSO OUTPUT THE STV.
    1	    881  ! 
    1	    882  ! 	X-7	JWT0243		JIM TEAGUE		 2-SEP-1986
    1	    883  ! 		ADD NEW ERRORS FOR COLLATED KEYS.
    1	    884  ! 
    1	    885  ! 	X-6	GJA		GARY J. ALLISON		29-JUL-1986
    1	    886  ! 		REMOVE DUPS FROM JNL MERGE.
    1	    887  ! 
    1	    888  ! 	X-5	GJA		GARY J. ALLISON		29-JUL-1986
    1	    889  ! 		MERGE JOURNALING INTO MAINLINE
    1	    890  ! 
    1	    891  ! 		X-3J6	DAS		DAVID A. SOLOMON	14-APR-1986
    1	    892  ! 			REMOVE RMS$_RUH_FILE (USING A GENERAL RUF MESSAGE INSTEAD).
    1	    893  ! 			CHANGE RMS$_RUH TEXT TO NOT HAVE FAO PARAMETERS. ADD
    1	    894  ! 			RMS$_BUG_RURECERR.
    1	    895  ! 	
    1	    896  ! 		X-3J5	JEJ0302		JAMES E JOHNSON		 4-APR-1986
    1	    897  ! 			ADD RMS$_RRF (ERROR DURING RU RECOVERY) AND
    1	    898  ! 			RMS$_RUH/RMS$_RUH_FILE (USED TO FORM TEXT OF RU HANDLER ERRORS
    1	    899  ! 			SENT TO OPCOM).
    1	    900  ! 	
    1	    901  ! 		X-3J4	JEJ0272		JAMES E JOHNSON		11-FEB-1986
    1	    902  ! 			ADD RMS$_RUF, RMS$_BUG_ABORT CODES.
    1	    903  ! 	
    1	    904  ! 		X-3J3	JEJ0237		JAMES E JOHNSON		16-DEC-1985
    1	    905  ! 			ADD RMS$_RUNDOWN CODE
    1	    906  ! 	
    1	    907  ! 		X-3J2	JEJ0205		JAMES E JOHNSON		25-OCT-1985
    1	    908  ! 			ADD JOURNAL SPECIFIC WRTJNL_XXJ ERROR CODES TO REPLACE
    1	    909  ! 			THE GENERIC ERRWRTJNL CODE.
    1	    910  ! 
    1	    911  ! 	X-4	JEJ0216		JAMES E JOHNSON		18-NOV-1985
    1	    912  ! 		MERGE X-3J2 INTO MAIN LINE FOR V4.4.
    1	    913  ! 
    1	    914  ! 		X-3J2	JEJ0205		JAMES E JOHNSON		25-OCT-1985
    1	    915  ! 			ADD JOURNAL SPECIFIC WRTJNL_XXJ ERROR CODES TO REPLACE
    1	    916  ! 			THE GENERIC ERRWRTJNL CODE.

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   6
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	    917  ! 
    1	    918  ! 	X-3	JEJ0161		JAMES E JOHNSON		 9-SEP-1985
    1	    919  ! 		UPDATE RMS JOURNALING MESSAGES.
    1	    920  ! 
    1	    921  ! 	X-2	JWT0212		JIM TEAGUE		 4-SEP-1985
    1	    922  ! 		ADD (WHAT IS FOR NOW) AN INTERNAL STATUS CODE TO 
    1	    923  ! 		DIFFERENTIATE BETWEEN FINDING A DELETED RECORD (DEL)
    1	    924  ! 		AND FINDING IT BUT WITH A DIFFERENT KEY (KEY_MISMATCH).
    1	    925  ! 		
    1	    926  ! 	V03-024	RAS0314		RON SCHAEFER		21-JUN-1984
    1	    927  ! 		WORK OVER THE MESSAGES ONE MORE TIME:  FIX TYPO IN OK_RNF,
    1	    928  ! 		DELETE ACPEOF ERROR, DELETE WSF ERROR.
    1	    929  ! 
    1	    930  ! 	V03-023	RAS0282		RON SCHAEFER		28-MAR-1984
    1	    931  ! 		MINOR TEXT CHANGES AND COMMENTS ADDED.
    1	    932  ! 		DELETE RMS$_COP ERROR.
    1	    933  ! 
    1	    934  ! 	V03-022	DAS0005		DAVID SOLOMON		19-MAR-1984
    1	    935  ! 		REMOVE RMS$_ECHO (NO LONGER NEEDED AS A RESULT OF NEW
    1	    936  ! 		IMPLEMENTATION FOR ECHO SYS$INPUT -> SYS$OUTPUT).
    1	    937  ! 
    1	    938  ! 	V03-021	JWT0150		JIM TEAGUE		01-FEB-1984
    1	    939  ! 		ADD RMS$_IFF FOR TRYING TO WRITE-ACCESS A FILE ON 
    1	    940  ! 		MAGTAPE THAT HAS NON-0 VALUE FOR ANSI BUFFER OFFSET.
    1	    941  ! 
    1	    942  ! 	V03-020	RAS0233		RON SCHAEFER		 9-JAN-1984
    1	    943  ! 		ADD RMS$_NOVALPRS ERROR FOR $SEARCH NOT PRECEDED BY
    1	    944  ! 		VALID $PARSE.
    1	    945  ! 
    1	    946  ! 	V03-019	JWT0148		JIM TEAGUE		20-DEC-1983
    1	    947  ! 		ADD A JNL XAB ERROR FOR CONFLICTING RU ATTRIBUTES
    1	    948  ! 		ON $CREATE: RMS$_XCR.
    1	    949  ! 
    1	    950  ! 	V03-018	RAS0171		RON SCHAEFER		28-JUL-1983
    1	    951  ! 		ADD RMS$_BUSY; A STRUCTURE-LESS ERROR (R0-ONLY STATUS)
    1	    952  ! 		REPLACING TEMP3.
    1	    953  ! 
    1	    954  ! 	V03-017	DAS0004		DAVID SOLOMON		28-JUN-1983
    1	    955  ! 		ADD RMS$_FILEPURGED; ADD RMS$_ACPEOF FOR ZALEWSKI.
    1	    956  ! 
    1	    957  ! 	V03-016	KPL0007		PETER LIEBERWIRTH	 8-JUN-1983
    1	    958  ! 		FIX SPELLING IN JNL ERROR MESSAGES, ADD CJF ERROR WHICH
    1	    959  ! 		WILL SOON SUBSUME COP AND CQE.
    1	    960  ! 
    1	    961  ! 	V03-015	DAS0003		DAVID SOLOMON		18-FEB-1983
    1	    962  ! 		ADD XNF (REPLACING TEMP9), TMR (NEW), LWC (NEW).
    1	    963  ! 
    1	    964  ! 	V03-014	KBT0497		KEITH B. THOMPSON	18-FEB-1983
    1	    965  ! 		ADD INCOMPSHR ERROR (REUSE OF TEMP1 SLOT)
    1	    966  ! 
    1	    967  ! 	V03-013	RAS0120		RON SCHAEFER		 2-FEB-1983
    1	    968  ! 		ADD ECHO PSEUDO-STATUS TO SUPPORT ECHO OF SYS$INPUT
    1	    969  ! 		TO SYS$OUTPUT.
    1	    970  ! 
    1	    971  ! 	V03-012	JWH0174		JEFFRY W. HORN		24-JAN-1983
    1	    972  ! 		ADD CQE AND COP ERRORS.
    1	    973  ! 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   7
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	    974  ! 	V03-011	KPL0006		PETER LIEBERWIRTH	 7-JAN-1983
    1	    975  ! 		ADD OK_RULK FOR RECOVERY UNIT SUPPORT.
    1	    976  ! 
    1	    977  ! 		ADD REENT ERROR FOR $RENAME.
    1	    978  ! 		
    1	    979  ! 	V03-009	JWH0153		JEFFREY W. HORN		 8-DEC-1982
    1	    980  ! 		ADD NRU ERROR.
    1	    981  ! 
    1	    982  ! 	V03-008	JWH0152		JEFFREY W. HORN		 8-DEC-1982
    1	    983  ! 		ADD JNS ERROR.
    1	    984  ! 
    1	    985  ! 	V03-007 MCN0002		MARIA DEL C. NASR	15-NOV-1982
    1	    986  ! 		REPLACE ORD ERROR CODE ELIMINATED BY MCN0001, SINCE
    1	    987  ! 		THE NETWORK CODE REFERENCES IT.
    1	    988  ! 
    1	    989  ! 	V03-006 MCN0001		MARIA DEL C. NASR	26-OCT-1982
    1	    990  ! 		PRINT KEY OF REFERENCE OR AREA IDENTIFICATION NUMBER
    1	    991  ! 		INSTEAD OF XAB ADDRESS FOR ERRORS RETURNED DURING
    1	    992  ! 		INDEXED FILE CREATION.  ALSO RENAME ALL UNUSED ERROR
    1	    993  ! 		CODES TO TEMP.
    1	    994  ! 
    1	    995  ! 	V03-005	JWH0102		JEFFREY W. HORN		24-SEP-1982
    1	    996  ! 		ADD RUP ERROR.
    1	    997  ! 
    1	    998  ! 	V03-004	RAS0095		RON SCHAEFER		 7-SEP-1982
    1	    999  ! 		ADD OVRDSKQUOTA ERROR.
    1	   1000  ! 
    1	   1001  ! 	V03-002	JWH0002		JEFFREY W. HORN		26-JUL-1982
    1	   1002  ! 		CONVERT TO .MSG FORMAT.   ADD RUM ERROR.
    1	   1003  ! 
    1	   1004  ! 	V03-001	JWH0001		JEFFREY W. HORN		20-JUL-1982
    1	   1005  ! 		ADD JNF, JOP, AND NOJ ERRORS.
    1	   1006  ! 
    1	   1007  ! 	V02-042	KPL0005		PETER LIEBERWIRTH	 4-FEB-1982
    1	   1008  ! 		ADD ERROR MESSAGES RMS$_EXENQLM AND RMS$_DEADLOCK
    1	   1009  ! 		CORRECTLY.
    1	   1010  ! 
    1	   1011  ! 	V02-041	CDS0001		C D SAETHER	24-JAN-1982
    1	   1012  ! 		ADD GBC AND CRMP ERRORS.
    1	   1013  ! 
    1	   1014  ! 	V02-040	JAK0069		J A KRYCKA	15-JAN-1982
    1	   1015  ! 		ADD SUPPORT AND NETFAIL ERROR CODES.
    1	   1016  ! 
    1	   1017  ! 	V02-039	JAK0068		J A KRYCKA	31-DEC-1981
    1	   1018  ! 		MODIFY TEXT FOR SUP, NET, BUG_DAP, AND ENV ERROR MESSAGES.
    1	   1019  ! 
    1	   1020  ! 	V02-038 LJA0001		LAURIE ANDERSON 20-DEC-1981
    1	   1021  ! 		MODIFIED SOME MESSAGES TO READ BETTER.
    1	   1022  ! 
    1	   1023  ! 	V02-037	JAK0063		J A KRYCKA	31-AUG-1981
    1	   1024  ! 		ADD CRE_STM SUCCESS CODE.
    1	   1025  ! 
    1	   1026  ! 	V02-036	KPL0004		PETER LIEBERWIRTH	13-JAN-1981
    1	   1027  ! 		ADD ENQ SEVERE ERROR MESSAGE, TO INDICATE $ENQ/$DEQ FAILURE.
    1	   1028  ! 		ALSO ADD SUCCESS CODES OK_RRL, AND OK_WAT.
    1	   1029  ! 
    1	   1030  ! 	V02-035	REFORMAT	J A KRYCKA	30-JUL-1980

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   8
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	   1031  ! 
    1	   1032  ! --
    1	   1033 	PARAMETER RMS$_FACILITY = '00000001'X
    1	   1034 	PARAMETER RMS$V_STVSTATUS = '0000000E'X	 !  MOVE TO BIT 14 OF THE
    1	   1035  !  STATUS CODE IT INDICATES
    1	   1036  !  THAT STV CONTAINS A SECONDARY
    1	   1037  !  STATUS CODE.
    1	   1038 	PARAMETER RMS$_SUC = '00010001'X
    1	   1039 	PARAMETER RMS$_NORMAL = '00010001'X
    1	   1040  ! +
    1	   1041  ! 
    1	   1042  ! 	SUCCESS CODES
    1	   1043  ! 
    1	   1044  ! -
    1	   1045  !  BIT 16 = BIT 15 = 1
    1	   1046 	PARAMETER RMS$_STALL = '00018001'X
    1	   1047  !  (NOTE: USER NEVER RECEIVES THIS CODE)
    1	   1048 	PARAMETER RMS$_PENDING = '00018009'X
    1	   1049 	PARAMETER RMS$_OK_DUP = '00018011'X
    1	   1050 	PARAMETER RMS$_OK_IDX = '00018019'X
    1	   1051  !   (RECORD HAS BEEN INSERTED, BUT INDEX STRUCTURE IS NO LONGER
    1	   1052  !   OPTIMAL.)
    1	   1053 	PARAMETER RMS$_OK_RLK = '00018021'X
    1	   1054  !  (BECAUSE LOCKER SET RLK IN ROP FIELD WHEN RECORD WAS LOCKED.)
    1	   1055 	PARAMETER RMS$_OK_RRL = '00018029'X
    1	   1056  !  (BECAUSE READER SET RRL IN ROP FIELD WHEN ACCESSING RECORD.)
    1	   1057  !  (THIS CODE USED TO BE OK_RRV)
    1	   1058  ! OK_RRV	;MSG <record was inserted successfully in primary>
    1	   1059  !   (BUT IT MAY NOT BE ACCESSIBLE VIA ONE-OR-MORE SECONDARY KEYS,
    1	   1060  !   AND NOT BY RFA ADDRESSING. FILE RE-ORGANIZATION RECOMMENDED!)
    1	   1061 	PARAMETER RMS$_KFF = '00018031'X
    1	   1062 	PARAMETER RMS$_OK_ALK = '00018039'X
    1	   1063 	PARAMETER RMS$_OK_DEL = '00018041'X
    1	   1064 	PARAMETER RMS$_OK_RNF = '00018049'X
    1	   1065 	PARAMETER RMS$_OK_LIM = '00018051'X
    1	   1066 	PARAMETER RMS$_OK_NOP = '00018059'X
    1	   1067 	PARAMETER RMS$_OK_WAT = '00018061'X
    1	   1068  !  (BECAUSE WAT BIT IN ROP WAS SET AND RECORD WAS ALREADY
    1	   1069  !  LOCKED.)
    1	   1070 	PARAMETER RMS$_CRE_STM = '00018069'X
    1	   1071 	PARAMETER RMS$_OK_RULK = '00018071'X
    1	   1072 	PARAMETER RMS$_SYNCH = '00018079'X
    1	   1073 	PARAMETER RMS$_OK_ACT = '00018081'X
    1	   1074 	PARAMETER RMS$_OK_NOCURTID = '00018089'X
    1	   1075  ! +
    1	   1076  ! 
    1	   1077  ! 	SUCCESS CODES PASSED THRU FROM DRIVERS AND ACP -	BIT 15 = 0
    1	   1078  ! 
    1	   1079  ! -
    1	   1080 	PARAMETER RMS$_CONTROLC = '00010651'X	 !  TERMINAL I/O ABORTED DUE TO CTRL/C
    1	   1081 	PARAMETER RMS$_CONTROLO = '00010609'X
    1	   1082  !  TERMINAL I/O ABORTED DUE TO CTRL/O
    1	   1083 	PARAMETER RMS$_CONTROLY = '00010611'X
    1	   1084  !  TERMINAL I/O ABORTED DUE TO CTRL/Y
    1	   1085 	PARAMETER RMS$_CREATED = '00010619'X
    1	   1086  !  FILE WAS CREATED, NOT OPENED
    1	   1087 	PARAMETER RMS$_SUPERSEDE = '00010631'X

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page   9
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	   1088  !  CREATED FILE SUPERSEDED EXISTING VERSION
    1	   1089 	PARAMETER RMS$_OVRDSKQUOTA = '00010669'X
    1	   1090  !  DISK USAGE EXCEEDS DISK QUOTA
    1	   1091 	PARAMETER RMS$_FILEPURGED = '00010679'X
    1	   1092  !  CREATE FILE CAUSED OLDEST FILE
    1	   1093  !  VERSION TO BE PURGED
    1	   1094  ! +
    1	   1095  ! 
    1	   1096  ! 	WARNING CODES
    1	   1097  ! 
    1	   1098  ! -
    1	   1099  !  BIT 16 = BIT 15 = 1, BIT 14 = 0
    1	   1100 	PARAMETER RMS$_BOF = '00018198'X
    1	   1101 	PARAMETER RMS$_RNL = '000181A0'X
    1	   1102 	PARAMETER RMS$_RTB = '000181A8'X
    1	   1103 	PARAMETER RMS$_TMO = '000181B0'X
    1	   1104 	PARAMETER RMS$_TNS = '000181B8'X
    1	   1105 	PARAMETER RMS$_BES = '000181C0'X
    1	   1106 	PARAMETER RMS$_PES = '000181C8'X
    1	   1107  ! +
    1	   1108  ! 
    1	   1109  ! 	ERROR CODES - WITHOUT STV (THAT IS, STV MAY BE USED BUT NO ASSOCIATED
    1	   1110  ! 		      CONDITION CODE IS IN STV)
    1	   1111  ! 
    1	   1112  ! -
    1	   1113  !  BIT 16 = BIT 15 = 1, BIT 14 = 0
    1	   1114 	PARAMETER RMS$_ACT = '0001825A'X
    1	   1115 	PARAMETER RMS$_DEL = '00018262'X
    1	   1116 	PARAMETER RMS$_INCOMPSHR = '0001826A'X
    1	   1117 	PARAMETER RMS$_DNR = '00018272'X
    1	   1118 	PARAMETER RMS$_EOF = '0001827A'X
    1	   1119 	PARAMETER RMS$_FEX = '00018282'X
    1	   1120 	PARAMETER RMS$_FLK = '0001828A'X
    1	   1121 	PARAMETER RMS$_FNF = '00018292'X
    1	   1122 	PARAMETER RMS$_PRV = '0001829A'X
    1	   1123 	PARAMETER RMS$_REX = '000182A2'X
    1	   1124 	PARAMETER RMS$_RLK = '000182AA'X
    1	   1125 	PARAMETER RMS$_RNF = '000182B2'X
    1	   1126  !   (RECORD NEVER WAS IN FILE, OR HAS BEEN DELETED.)
    1	   1127 	PARAMETER RMS$_WLK = '000182BA'X
    1	   1128 	PARAMETER RMS$_EXP = '000182C2'X
    1	   1129 	PARAMETER RMS$_NMF = '000182CA'X
    1	   1130 	PARAMETER RMS$_SUP = '000182D2'X
    1	   1131  !  (NOTE THAT SUPPORT HAS REPLACED SUP EXCEPT WHEN RMS CANNOT
    1	   1132  !  MAP THE DAP STATUS CODE INTO A FAL STATUS CODE.)
    1	   1133  !  (NOTE ALSO THAT SUP SHOULD HAVE BEEN DEFINED AS A SEVERE
    1	   1134  !  ERROR CODE. HOWEVER, SUPPORT IS A SEVERE ERROR CODE.)
    1	   1135 	PARAMETER RMS$_RSA = '000182DA'X
    1	   1136 	PARAMETER RMS$_CRC = '000182E2'X
    1	   1137 	PARAMETER RMS$_WCC = '000182EA'X
    1	   1138 	PARAMETER RMS$_IDR = '000182F2'X
    1	   1139 	PARAMETER RMS$_LWC = '000182FA'X
    1	   1140 	PARAMETER RMS$_UNUSED1 = '00018302'X
    1	   1141 	PARAMETER RMS$_NOVALPRS = '0001830A'X
    1	   1142 	PARAMETER RMS$_KEY_MISMATCH = '00018312'X
    1	   1143 	PARAMETER RMS$_RUH = '0001831A'X
    1	   1144 	PARAMETER RMS$_JND = '00018322'X

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  10
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	   1145 	PARAMETER RMS$_BADPHASE = '0001832A'X
    1	   1146 	PARAMETER RMS$_TOWDR = '00018332'X
    1	   1147 	PARAMETER RMS$_NEXDR = '0001833A'X
    1	   1148 	PARAMETER RMS$_INVDRMSG = '00018342'X
    1	   1149 	PARAMETER RMS$_RU_ACTIVE = '0001834A'X
    1	   1150 	PARAMETER RMS$_UNKRUFAC = '00018352'X
    1	   1151 	PARAMETER RMS$_LIMBO = '0001835A'X
    1	   1152 	PARAMETER RMS$_IVATRACE = '00018362'X
    1	   1153 	PARAMETER RMS$_OPNOTSUP = '0001836A'X
    1	   1154 	PARAMETER RMS$_EXTNOTFOU = '00018372'X
    1	   1155 	PARAMETER RMS$_EXT_ERR = '0001837A'X
    1	   1156 	PARAMETER RMS$_SEMANTICS = '00018382'X
    1	   1157 	PARAMETER RMS$_LSCAN = '0001838A'X
    1	   1158 	PARAMETER RMS$_ROOTSRCH = '00018392'X
    1	   1159 	PARAMETER RMS$_IDXSEARCH = '0001839A'X
    1	   1160 	PARAMETER RMS$_NETBTS = '000183A2'X
    1	   1161  ! +
    1	   1162  ! 
    1	   1163  ! 	ERROR CODES - WITH STV ERROR CODE (THAT IS, STV CONTAINS AN ASSOCIATED CONDITION CODE)
    1	   1164  ! 
    1	   1165  ! -
    1	   1166  !  BIT 16 = BIT 15 = BIT 14 = 1
    1	   1167 	PARAMETER RMS$_ACC = '0001C002'X
    1	   1168 	PARAMETER RMS$_CRE = '0001C00A'X
    1	   1169 	PARAMETER RMS$_DAC = '0001C012'X
    1	   1170 	PARAMETER RMS$_ENT = '0001C01A'X
    1	   1171 	PARAMETER RMS$_EXT = '0001C022'X
    1	   1172 	PARAMETER RMS$_FND = '0001C02A'X
    1	   1173 	PARAMETER RMS$_MKD = '0001C032'X
    1	   1174 	PARAMETER RMS$_DPE = '0001C03A'X
    1	   1175 	PARAMETER RMS$_SPL = '0001C042'X
    1	   1176 	PARAMETER RMS$_DNF = '0001C04A'X
    1	   1177 	PARAMETER RMS$_RUF = '0001C052'X
    1	   1178 	PARAMETER RMS$_WRTJNL_AIJ = '0001C05A'X
    1	   1179 	PARAMETER RMS$_WRTJNL_BIJ = '0001C062'X
    1	   1180 	PARAMETER RMS$_WRTJNL_ATJ = '0001C06A'X
    1	   1181 	PARAMETER RMS$_WRTJNL_RUJ = '0001C072'X
    1	   1182 	PARAMETER RMS$_RRF = '0001C07A'X
    1	   1183 	PARAMETER RMS$_DDTM_ERR = '0001C082'X
    1	   1184  ! +
    1	   1185  ! 
    1	   1186  ! 	SEVERE ERROR CODES - WITHOUT STV (THAT IS, STV MAY BE USED BUT NO ASSOCIATED
    1	   1187  ! 			     CONDITION CODE IS IN STV)
    1	   1188  ! 
    1	   1189  ! -
    1	   1190  !  BIT 16 = BIT 15 = 1, BIT 14 = 0
    1	   1191 	PARAMETER RMS$_DTFCDDREC = '000183EC'X
    1	   1192 	PARAMETER RMS$_AID = '000183F4'X
    1	   1193 	PARAMETER RMS$_ALN = '000183FC'X
    1	   1194 	PARAMETER RMS$_ALQ = '00018404'X
    1	   1195 	PARAMETER RMS$_ANI = '0001840C'X
    1	   1196 	PARAMETER RMS$_AOP = '00018414'X
    1	   1197 	PARAMETER RMS$_BKS = '0001841C'X
    1	   1198 	PARAMETER RMS$_BKZ = '00018424'X
    1	   1199 	PARAMETER RMS$_BLN = '0001842C'X
    1	   1200 	PARAMETER RMS$_BUG = '00018434'X
    1	   1201 	PARAMETER RMS$_BUG_DDI = '0001843C'X

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  11
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	   1202 	PARAMETER RMS$_BUG_DAP = '00018444'X
    1	   1203 	PARAMETER RMS$_BUG_RU_ACTIVE = '0001844C'X
    1	   1204 	PARAMETER RMS$_BUG_RURECERR = '00018454'X
    1	   1205 	PARAMETER RMS$_BUG_FLUSH_JNL_FAILED = '0001845C'X
    1	   1206 	PARAMETER RMS$_BUG_RU_ABORT_FAIL = '00018464'X
    1	   1207 	PARAMETER RMS$_BUG_RU_COMMIT_FAIL = '0001846C'X
    1	   1208 	PARAMETER RMS$_BUG_XX6 = '00018474'X
    1	   1209 	PARAMETER RMS$_BUG_XX7 = '0001847C'X
    1	   1210 	PARAMETER RMS$_BUG_XX8 = '00018484'X
    1	   1211 	PARAMETER RMS$_BUSY = '0001848C'X
    1	   1212 	PARAMETER RMS$_CCR = '00018494'X
    1	   1213 	PARAMETER RMS$_CHG = '0001849C'X
    1	   1214 	PARAMETER RMS$_CHK = '000184A4'X
    1	   1215 	PARAMETER RMS$_COD = '000184AC'X
    1	   1216 	PARAMETER RMS$_CUR = '000184B4'X
    1	   1217 	PARAMETER RMS$_DAN = '000184BC'X
    1	   1218 	PARAMETER RMS$_DEV = '000184C4'X
    1	   1219 	PARAMETER RMS$_DIR = '000184CC'X
    1	   1220 	PARAMETER RMS$_DME = '000184D4'X
    1	   1221 	PARAMETER RMS$_DNA = '000184DC'X
    1	   1222 	PARAMETER RMS$_DTP = '000184E4'X
    1	   1223 	PARAMETER RMS$_DUP = '000184EC'X
    1	   1224 	PARAMETER RMS$_DVI = '000184F4'X
    1	   1225 	PARAMETER RMS$_ESA = '000184FC'X
    1	   1226 	PARAMETER RMS$_ESS = '00018504'X
    1	   1227 	PARAMETER RMS$_FAB = '0001850C'X
    1	   1228 	PARAMETER RMS$_FAC = '00018514'X
    1	   1229 	PARAMETER RMS$_FLG = '0001851C'X
    1	   1230 	PARAMETER RMS$_FNA = '00018524'X
    1	   1231 	PARAMETER RMS$_FNM = '0001852C'X
    1	   1232 	PARAMETER RMS$_FSZ = '00018534'X
    1	   1233 	PARAMETER RMS$_FOP = '0001853C'X
    1	   1234 	PARAMETER RMS$_FUL = '00018544'X
    1	   1235 	PARAMETER RMS$_IAL = '0001854C'X
    1	   1236 	PARAMETER RMS$_IAN = '00018554'X
    1	   1237 	PARAMETER RMS$_IDX = '0001855C'X
    1	   1238 	PARAMETER RMS$_IFI = '00018564'X
    1	   1239 	PARAMETER RMS$_IMX = '0001856C'X
    1	   1240 	PARAMETER RMS$_IOP = '00018574'X
    1	   1241 	PARAMETER RMS$_IRC = '0001857C'X
    1	   1242 	PARAMETER RMS$_ISI = '00018584'X
    1	   1243 	PARAMETER RMS$_KBF = '0001858C'X
    1	   1244 	PARAMETER RMS$_KEY = '00018594'X
    1	   1245 	PARAMETER RMS$_KRF = '0001859C'X
    1	   1246 	PARAMETER RMS$_KSZ = '000185A4'X
    1	   1247 	PARAMETER RMS$_LAN = '000185AC'X
    1	   1248 	PARAMETER RMS$_RUNDOWN = '000185B4'X
    1	   1249 	PARAMETER RMS$_LNE = '000185BC'X
    1	   1250 	PARAMETER RMS$_DTFCVT = '000185C4'X
    1	   1251 	PARAMETER RMS$_MRN = '000185CC'X
    1	   1252 	PARAMETER RMS$_MRS = '000185D4'X
    1	   1253 	PARAMETER RMS$_NAM = '000185DC'X
    1	   1254 	PARAMETER RMS$_NEF = '000185E4'X
    1	   1255 	PARAMETER RMS$_DTFQUASYN = '000185EC'X
    1	   1256 	PARAMETER RMS$_NOD = '000185F4'X
    1	   1257 	PARAMETER RMS$_NPK = '000185FC'X
    1	   1258 	PARAMETER RMS$_ORD = '00018604'X	 ! ! NOT USED AS OF V4

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  12
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	   1259 	PARAMETER RMS$_ORG = '0001860C'X
    1	   1260 	PARAMETER RMS$_PBF = '00018614'X
    1	   1261 	PARAMETER RMS$_PLG = '0001861C'X
    1	   1262 	PARAMETER RMS$_POS = '00018624'X
    1	   1263 	PARAMETER RMS$_DTFQUAVAL = '0001862C'X
    1	   1264 	PARAMETER RMS$_QUO = '00018634'X
    1	   1265 	PARAMETER RMS$_RAB = '0001863C'X
    1	   1266 	PARAMETER RMS$_RAC = '00018644'X
    1	   1267 	PARAMETER RMS$_RAT = '0001864C'X
    1	   1268 	PARAMETER RMS$_RBF = '00018654'X
    1	   1269 	PARAMETER RMS$_RFA = '0001865C'X
    1	   1270 	PARAMETER RMS$_RFM = '00018664'X
    1	   1271 	PARAMETER RMS$_RHB = '0001866C'X
    1	   1272 	PARAMETER RMS$_RLF = '00018674'X
    1	   1273 	PARAMETER RMS$_ROP = '0001867C'X
    1	   1274 	PARAMETER RMS$_RRV = '00018684'X
    1	   1275 	PARAMETER RMS$_RVU = '0001868C'X
    1	   1276 	PARAMETER RMS$_RSS = '00018694'X
    1	   1277 	PARAMETER RMS$_RST = '0001869C'X
    1	   1278 	PARAMETER RMS$_RSZ = '000186A4'X
    1	   1279 	PARAMETER RMS$_SEQ = '000186AC'X
    1	   1280 	PARAMETER RMS$_SHR = '000186B4'X
    1	   1281 	PARAMETER RMS$_SIZ = '000186BC'X
    1	   1282 	PARAMETER RMS$_SQO = '000186C4'X
    1	   1283 	PARAMETER RMS$_DTFSESEST = '000186CC'X
    1	   1284 	PARAMETER RMS$_SYN = '000186D4'X
    1	   1285 	PARAMETER RMS$_TRE = '000186DC'X
    1	   1286 	PARAMETER RMS$_TYP = '000186E4'X
    1	   1287 	PARAMETER RMS$_UBF = '000186EC'X
    1	   1288 	PARAMETER RMS$_USZ = '000186F4'X
    1	   1289 	PARAMETER RMS$_VER = '000186FC'X
    1	   1290 	PARAMETER RMS$_XNF = '00018704'X
    1	   1291 	PARAMETER RMS$_XAB = '0001870C'X
    1	   1292 	PARAMETER RMS$_ESL = '00018714'X
    1	   1293 	PARAMETER RMS$_DTFSESTER = '0001871C'X
    1	   1294 	PARAMETER RMS$_ENV = '00018724'X
    1	   1295 	PARAMETER RMS$_PLV = '0001872C'X
    1	   1296 	PARAMETER RMS$_MBC = '00018734'X
    1	   1297 	PARAMETER RMS$_RSL = '0001873C'X
    1	   1298 	PARAMETER RMS$_WLD = '00018744'X
    1	   1299 	PARAMETER RMS$_NET = '0001874C'X	 !  (NOTE THAT NETFAIL HAS REPLACED NET EXCEPT WHEN RMS CANNOT
    1	   1300  !  MAP THE DAP STATUS CODE INTO A FAL STATUS CODE.)
    1	   1301 	PARAMETER RMS$_IBF = '00018754'X
    1	   1302 	PARAMETER RMS$_REF = '0001875C'X
    1	   1303 	PARAMETER RMS$_IFL = '00018764'X
    1	   1304 	PARAMETER RMS$_DFL = '0001876C'X
    1	   1305 	PARAMETER RMS$_KNM = '00018774'X
    1	   1306 	PARAMETER RMS$_IBK = '0001877C'X
    1	   1307 	PARAMETER RMS$_KSI = '00018784'X
    1	   1308 	PARAMETER RMS$_LEX = '0001878C'X
    1	   1309 	PARAMETER RMS$_SEG = '00018794'X
    1	   1310 	PARAMETER RMS$_SNE = '0001879C'X	 ! ! NOT USED AS OF V4
    1	   1311 	PARAMETER RMS$_SPE = '000187A4'X	 ! ! NOT USED AS OF V4
    1	   1312 	PARAMETER RMS$_UPI = '000187AC'X
    1	   1313 	PARAMETER RMS$_ACS = '000187B4'X
    1	   1314 	PARAMETER RMS$_STR = '000187BC'X
    1	   1315 	PARAMETER RMS$_FTM = '000187C4'X

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  13
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	   1316 	PARAMETER RMS$_GBC = '000187CC'X
    1	   1317 	PARAMETER RMS$_DEADLOCK = '000187D4'X
    1	   1318 	PARAMETER RMS$_EXENQLM = '000187DC'X
    1	   1319 	PARAMETER RMS$_JOP = '000187E4'X
    1	   1320 	PARAMETER RMS$_RUM = '000187EC'X
    1	   1321 	PARAMETER RMS$_JNS = '000187F4'X
    1	   1322 	PARAMETER RMS$_NRU = '000187FC'X
    1	   1323 	PARAMETER RMS$_IFF = '00018804'X
    1	   1324 	PARAMETER RMS$_DTFTRATBL = '0001880C'X
    1	   1325 	PARAMETER RMS$_DTFUNSTYP = '00018814'X
    1	   1326 	PARAMETER RMS$_DTFVERMIS = '0001881C'X
    1	   1327  ! +
    1	   1328  ! 
    1	   1329  ! 	ERROR CODES - WITHOUT STV
    1	   1330  ! 
    1	   1331  ! 	  DTFACC AND DTFCRE WERE ORIGINALLY INCLUDED IN THIS FATAL SEVERITY 
    1	   1332  ! 	  (NO STV) GROUPING.  IN ORDER TO CHANGE THEIR SEVERITY TO ERROR 
    1	   1333  ! 	  (NO STV) AND RETAIN THE SAME MESSAGE CODE VALUE, THE FOLLOWING 
    1	   1334  ! 	  SHIFTS IN SEVERITY FROM FATAL TO ERROR AND THEN BACK AGAIN ARE
    1	   1335  ! 	  DONE, WHILE RETAINING THE SAME ORIGINAL BASE ASSOCIATED WITH EACH.
    1	   1336  ! 
    1	   1337  ! -
    1	   1338  !  BIT 16 = BIT 15 = 1, BIT 14 = 0
    1	   1339 	PARAMETER RMS$_DTFACC = '00018822'X
    1	   1340  ! +
    1	   1341  ! 
    1	   1342  ! 	SEVERE ERROR CODES - WITHOUT STV
    1	   1343  ! 
    1	   1344  ! -
    1	   1345  !  BIT 16 = BIT 15 = 1, BIT 14 = 0
    1	   1346 	PARAMETER RMS$_BOGUSCOL = '0001882C'X
    1	   1347 	PARAMETER RMS$_ERRREADCOL = '00018834'X
    1	   1348 	PARAMETER RMS$_ERRWRITECOL = '0001883C'X
    1	   1349 	PARAMETER RMS$_SNS = '00018844'X
    1	   1350 	PARAMETER RMS$_NOEXTEND = '0001884C'X	 ! +
    1	   1351  ! 
    1	   1352  ! 	ERROR CODES - WITHOUT STV
    1	   1353  ! 
    1	   1354  ! -
    1	   1355  !  BIT 16 = BIT 15 = 1, BIT 14 = 0
    1	   1356 	PARAMETER RMS$_DTFCRE = '00018852'X
    1	   1357  ! +
    1	   1358  ! 
    1	   1359  ! 	SEVERE ERROR CODES - WITHOUT STV
    1	   1360  ! 
    1	   1361  ! -
    1	   1362  !  BIT 16 = BIT 15 = 1, BIT 14 = 0
    1	   1363 	PARAMETER RMS$_DELJNS = '0001885C'X
    1	   1364 	PARAMETER RMS$_NOTSAMEJNL = '00018864'X
    1	   1365 	PARAMETER RMS$_SNPPF = '0001886C'X
    1	   1366  ! +
    1	   1367  ! 
    1	   1368  ! 	SEVERE ERRORS - WITH STV ERROR CODE (THAT IS, STV CONTAINS AN ASSOCIATED CONDITION CODE)
    1	   1369  ! 
    1	   1370  ! -
    1	   1371  !  BIT 16 = BIT 15 = BIT 14 = 1
    1	   1372 	PARAMETER RMS$_ATR = '0001C0CC'X

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  14
                                                                 4-NOV-1994 21:24:10    SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1($RMSDEF)

    1	   1373 	PARAMETER RMS$_ATW = '0001C0D4'X
    1	   1374 	PARAMETER RMS$_CCF = '0001C0DC'X
    1	   1375 	PARAMETER RMS$_CDA = '0001C0E4'X
    1	   1376 	PARAMETER RMS$_CHN = '0001C0EC'X
    1	   1377 	PARAMETER RMS$_RER = '0001C0F4'X
    1	   1378 	PARAMETER RMS$_RMV = '0001C0FC'X
    1	   1379 	PARAMETER RMS$_RPL = '0001C104'X
    1	   1380 	PARAMETER RMS$_SYS = '0001C10C'X
    1	   1381 	PARAMETER RMS$_WER = '0001C114'X
    1	   1382 	PARAMETER RMS$_WPL = '0001C11C'X
    1	   1383 	PARAMETER RMS$_IFA = '0001C124'X
    1	   1384 	PARAMETER RMS$_WBE = '0001C12C'X
    1	   1385 	PARAMETER RMS$_ENQ = '0001C134'X
    1	   1386 	PARAMETER RMS$_NETFAIL = '0001C13C'X
    1	   1387 	PARAMETER RMS$_SUPPORT = '0001C144'X
    1	   1388 	PARAMETER RMS$_CRMP = '0001C14C'X
    1	   1389 	PARAMETER RMS$_DTFCFGFIL = '0001C154'X
    1	   1390 	PARAMETER RMS$_REENT = '0001C15C'X
    1	   1391 	PARAMETER RMS$_ACC_RUJ = '0001C164'X
    1	   1392 	PARAMETER RMS$_TMR = '0001C16C'X
    1	   1393 	PARAMETER RMS$_ACC_AIJ = '0001C174'X
    1	   1394 	PARAMETER RMS$_ACC_BIJ = '0001C17C'X
    1	   1395 	PARAMETER RMS$_ACC_ATJ = '0001C184'X
    1	   1396 	PARAMETER RMS$_DTFDEFFIL = '0001C18C'X
    1	   1397 	PARAMETER RMS$_DTFREGFIL = '0001C194'X
    1	   1398 	PARAMETER RMS$_JNLNOTAUTH = '0001C19C'X
    1	   1399 CDEC$ END OPTIONS
    1	   1400 
	   1401 
	   1402 C  	************************************************
	   1403 C	*		data file names                *
	   1404 C	************************************************
	   1405 
	   1406       INTEGER*4 L1_LUN/19/,OUTUNIT,OPENMODE      !lu unit numbers for input,output,
	   1407 C						   mode option for searching 
	   1408 C						   for additional input files
	   1409       INTEGER*4 NAMELEN		        !number of characters in file name
	   1410       CHARACTER L1FILENAME*80		!input L1 data file name
	   1411       CHARACTER FULL_L1_NAME*80		!L1 data file with full directory information
	   1412       CHARACTER INPUTFILES(1:100)*80	!L1 file name array for multiple inputs
	   1413       INTEGER*4 IFILE		        !number of L1 files used (use with INPUTFILES)
	   1414 
	   1415 C     naming the output file
	   1416       LOGICAL   BRACK   		!A variable which is .TRUE. if there is 
	   1417 C                     			   a set of square brackets in the input file name.
	   1418       INTEGER*4 NINDEX, 		!used in rearranging the input file name to     
	   1419 C                      			   create the output file name.                    
	   1420      .          JSAVE   		!used in rearranging the input file name to 
	   1421 C                        		   create the output file name.
	   1422       CHARACTER*90 LISFIL1,LISFIL2,	!holds the name of the input file for use
	   1423      .             LISFIL3,LISFIL4		!  in creating the default output file names
	   1424       CHARACTER OUTFILENAME1*90, OUTFILENAME2*90,
	   1425      .          OUTDPUFILE*90, OUTFILENAME3*90
	   1426       CHARACTER*40 USERNAME1,USERNAME2	!user defined output file name
	   1427 
	   1428       LOGICAL FIRSTFILE			!set to true if this is the first input file 
	   1429 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  15
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1430 C  	************************************************
	   1431 C	*		file, record or data status     *
	   1432 C	************************************************
	   1433 
	   1434       INTEGER*4 STATUS			!did L1 file open successfully
	   1435       LOGICAL   GOODSPIN		!data record has good data
	   1436 
	   1437 C  	************************************************
	   1438 C	*		type of output files           *
	   1439 C	************************************************
	   1440 
	   1441       INTEGER*4  MATRIX_FORMAT		!option = 1 for STANDARD NM VS NQ format
	   1442       INTEGER*4 TABLE_FORMAT            !option for pha table listing
	   1443       INTEGER*4 STANDARD		!option =1 for standard responses - 
	   1444 C					 save time by skipping inquiries
	   1445 
	   1446 C  	************************************************
	   1447 C	*		time search status     *
	   1448 C	************************************************
	   1449 
	   1450       LOGICAL COMPARE_TIME_GE,			!check on whether time is inbounds
	   1451      .        STARTFOUND,ENDFOUND,		!start/end time found?
	   1452      .        USE_SC_CLOCK			!which time on L1 to use (wall or s/c)
	   1453 
	   1454       INTEGER*4 MONTH,DAYOFMONTH,		 !user requested start and stop times
	   1455      .          ENDMONTH,ENDDAYOFMONTH		 ! month and day of month
	   1456 
	   1457 C  	************************************************
	   1458 C	*    intrument and s/c housekeeping info       *
	   1459 C	************************************************
	   1460 
	   1461       CHARACTER FIFO*3, TGS*3, RATEFLAG*1			!FIFO, TGS, BIT RATE characters
	   1462       CHARACTER*17 MODE(10) /'Science mode     ','Engineering mode ',
	   1463      &                       'Maneuver mode    ','Contingency mode ',
	   1464      &                       'Science mode     ','Engineering mode ',
	   1465      &                       'Maneuver mode    ','Contingency mode ',
	   1466      &                       'Transitional mode','Unknown mode     '/,
	   1467      &             MODE_AT_START			      	!value on first good record
	   1468 
	   1469       INTEGER*4 TRIGGER_MODE_CODE			      	!ADC trigger logic
	   1470       CHARACTER*22 TRIGGER_MODE(0:7) /
	   1471      &   'E                      ','Tn                    ',
	   1472      &   '(Tn.!E)+(Tn.En)        ','Tn.En                 ',
	   1473      &   'E+T                    ','(E.!T)+(Tn.!E)+(Tn.En)',
	   1474      &   'C.(E+T)                ','(E.!T)+(Tn.En)        '/
	   1475 
	   1476       LOGICAL CODE_C1,CODE_C2		!rate compression codes for rate groups 1 and 2
	   1477 
	   1478       LOGICAL*1 BITRATE			!telemetry bit rate 
	   1479       INTEGER*4 INCREMENT    		!this value based on bitrate
	   1480 
	   1481 C    DPPS information
	   1482       INTEGER*4 DPPSPLUS,		!STICS +DPPS on=1, off=0
	   1483      .          DPPSMINUS,		!STICS -DPPS on=1, off=0
	   1484      .		DVSTEP			!DPPS voltage step number (0-31)
	   1485 
	   1486 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  16
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1487 C  	************************************************
	   1488 C	*    data selection options                    *
	   1489 C	************************************************
	   1490 
	   1491       INTEGER*4  DATA_FILTER,		!data filter options 
	   1492      .           DATA_FILTER_COINC,	!data filtering by coincidence 
	   1493 C					 conditions
	   1494      .           DATA_FILTER_DVSTEP,	!data filter by voltage step
	   1495      .           DATA_DVSTEP_MIN,	!dv step min-max values for data filter
	   1496      .           DATA_DVSTEP_MAX,
	   1497      .           DATA_FILTER_RANGE,       !range selection
	   1498      .           DATA_FILTER_RANGECHECK,  !check calculated vs. dpu range
	   1499      .           DIRECTION_FILTER,        !select data by telescope info
	   1500      .           DIRECTION_FILTER_START,  ! start anode id
	   1501      .           DIRECTION_FILTER_STOP,   ! stop mcp id
	   1502      .		 DIRECTION_FILTER_SSD,    ! solid state detector id
	   1503      .           DIRECTION_CHECK,         !telescope check
	   1504      .           TELE_FLAG,TELE_IDENT,    !    flag on telescope check, telescope id
	   1505      .           DATA_FILTER_MSPEED,      !speed filter
	   1506      .           DATA_MSPEED_MIN,         !	select data only if MASS solar
	   1507      .           DATA_MSPEED_MAX          !	speed is .GE. MIN and .LE. MAX
	   1508 
	   1509       CHARACTER*10 COINC(0:2) / '       ALL',           !trigger coincidence selection choices
	   1510      .                          '  M/Q-only',
	   1511      .                          '   M/Q & M'/
	   1512 
	   1513       CHARACTER*3 RONOFF, TONOFF            		!range selection ON, OFF status
	   1514       CHARACTER*5 RANGESEL(0:6) /			!range selection choices
	   1515      .                           '2 1 0' ,
	   1516      .                           '    0' ,
	   1517      .                           '  1  ' ,
	   1518      .                           '2    ' ,
	   1519      .                           '2   0' ,
	   1520      .                           '2 1  ' ,
	   1521      .                           '  1 0' /
	   1522       LOGICAL SEL_RANGE(0:2)
	   1523 
	   1524 
	   1525 C  	************************************************
	   1526 C	*    DPU DEFAULT VALUES and Calculations       *
	   1527 C	************************************************
	   1528 
	   1529 C    dpu default coefficients
	   1530       REAL*4
	   1531      .          DPU_ELOW, DPU_EHIGH,DPU_TLOW,DPU_THIGH,	 !dpu values for Emin,Emax,Tmin,Tmax
	   1532      .          DPU_AM(6),DPU_BM(6),			 !dpu values for mass (A) and 
	   1533 C							      Nm (B) coefficients
	   1534      .          DPU_C1_EQ,DPU_C2A_EQ,			 !    E/Q (C and D) coefficients
	   1535      .          DPU_C2B_EQ,DPU_D1_EQ,DPU_D2_EQ,
	   1536      .          DPU_EMQ(3),				 !    Nq (E) coefficients
	   1537      .          DPU_BK_MQ				 !    M/Q value where C2A vs C2B is used
	   1538       INTEGER*4 DPU_BK_C2	      			 !    Nq value where C2A vs C2B is used
	   1539 
	   1540 C    dpu algorithm values for e/q, mass and m/q:
	   1541       REAL*4    DPU_E_OVER_Q,		!calculated e/q,m, and m/q using dpu algorithm
	   1542      .          DPU_MASS,
	   1543      .          DPU_MASS_OVER_Q

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  17
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1544 
	   1545       INTEGER*4 DPU_RANGE		!dpu algorithm calculation for range
	   1546 
	   1547 C  	************************************************************
	   1548 C	*    DPU DEFAULT MASS, M/Q Matrix binning parameters       *
	   1549 C	************************************************************
	   1550 
	   1551       INTEGER*4 DPU_NQ_MAX,DPU_NM_MAX	!dpu max NQ,NM values (i.e, number of bins)
	   1552       REAL*4    DPU_MQMAX,DPU_MQMIN,	!    max M/Q, min M/Q 
	   1553      .          DPU_MMAX,DPU_MMIN	!    max mass, min mass
	   1554       REAL*4    DPU_KM,DPU_KQ		!    Nm, Nq resolution (KM, KQ)
	   1555 
	   1556       INTEGER*4 DPU_NM,DPU_NQ		!dpu algorithm calculation for Nm and Nm assignments
	   1557 
	   1558       REAL*4    DPU_NM_M(0:70),DPU_NQ_MPQ(0:130)       !mass and m/q values of NM,NQ bin boundaries
	   1559 C						        (lower bounds)
	   1560 
	   1561       INTEGER*4 DPU_NQNM(0:130,0:70)         	       !DPU NM,NQ matrix 
	   1562 C								- no br or eff corrections
	   1563       CHARACTER*5 DPU_CNQNM (0:130,0:70)		     !character format
	   1564 
	   1565 C  	************************************************
	   1566 C	*    USER DEFINED  Coefficients		       *
	   1567 C	************************************************
	   1568 
	   1569       REAL*4    ELOW,EHIGH,TLOW,THIGH,               !energy and time range
	   1570      .          AM(6),BM(6), 			     !mass algorithm coefficients
	   1571      .          C1_EQ,C2A_EQ,C2B_EQ,D1_EQ,D2_EQ,     !e/q, m/q algorihm coefficients
	   1572      .          EMQ(3),BK_MQ, 
	   1573      .		RKM, RKQ			     !NM,NQ binning resolution
	   1574       INTEGER*4 BK_C2				     !NQ value for selecting C2
	   1575 
	   1576 C  	************************************************************
	   1577 C	*    USER DEFINED MASS, M/Q Matrix binning parameters      *
	   1578 C	************************************************************
	   1579 
	   1580 C    binning parameters
	   1581       INTEGER*4 NQ_MAX,NM_MAX,		!user defined max NQ,NM values (i.e, number of bins)
	   1582      .          USER_NQ_MAX,USER_NM_MAX !user request for Nq_max,Nm_max 
	   1583 C					   (allows -1 to mean "use dpu default values")
	   1584       REAL*4    MQMAX,MQMIN,		!user defined M/Q max, min
	   1585      .          USER_MQMAX,USER_MQMIN,	!     request              (-1 = dpu values)
	   1586      .          MMAX, MMIN,		!user defined Mass max, min
	   1587      .          USER_MMAX,USER_MMIN	!     request              (-1 = dpu values)
	   1588 
	   1589       INTEGER*4 PHA_NQ, PHA_NM		!algorithm calculation for Nm and Nm assignments
	   1590 
	   1591       REAL*4    USER_NM_M(0:200)  ,USER_NQ_MPQ(0:300)   !mass and m/q values of bin boundaries
	   1592       REAL*4    USER_NM_MID(0:200),USER_NQ_MID(0:300)   !mass and m/q values of bin middle
	   1593       REAL*4    SPECIES_ENERGY, SPECIES_MASS,		!species energy by voltage step
	   1594      .          SPECIES_CHARGE		  		!species mass and charge of each bin
	   1595 
	   1596 C	:::::  MATRICES  :::::
	   1597 
	   1598       REAL*4  OMNI_NQNM(0:300,0:200),   !nq nm matrix array by USER bin values, 
	   1599      .         SUN_NQNM(0:300,0:200)    !  normalized by basic rate weight factor each
	   1600 C					   readout, omni and sun only (T2,8-11) direction 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  18
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1601       CHARACTER*5 OMNI_CNQNM(0:300,0:200),   !character format
	   1602      .             SUN_CNQNM(0:300,0:200)
	   1603 
	   1604       INTEGER*4 SUN1_NQNM_VS_R (0:31,0:300,0:200,0:2), !by range and voltage step - SUN 8,9
	   1605      .          SUN2_NQNM_VS_R (0:31,0:300,0:200,0:2)  ! SUN 10,11
	   1606       REAL*4    SUN_EFF_NQNM   (0:300,0:200)           ! SUN with br and eff corrections
	   1607       CHARACTER*5 SUN_EFF_CNQNM(0:300,0:200)	       ! character format
	   1608 
	   1609       REAL*4 OMNI_MAX,   SUN_MAX,   SUN_EFF_MAX, DPU_MAX,
	   1610      .       OMNI_SCALE, SUN_SCALE, SUN_EFF_SCALE, DPU_SCALE
	   1611 
	   1612       REAL*4  SUM_FE
	   1613 
	   1614 C  	************************************************
	   1615 C	*    STICS DATA			               *
	   1616 C	************************************************
	   1617 
	   1618 C    pha word - dissected:
	   1619       INTEGER*4 START_ID_RANGE,
	   1620      .          STOP_ID,
	   1621      .          ENERGY,
	   1622      .          SECTOR,
	   1623      .          SSD_ID,
	   1624      .          TIME_OF_FLIGHT,
	   1625      .          PSTART,
	   1626      .          RANGE
	   1627       INTEGER*4 ISECT           !PHA SECTOR grouped by 2's corresponding to
	   1628 C				      Basic Rate sectors
	   1629 
	   1630 C  STICS rates
	   1631       INTEGER*4 WIND_DECOMPRESS		!function to return decompressed rates
	   1632       INTEGER*4 STICS_RATES(179),	!all the stics rates
	   1633 C	                                !Basic rate arrays - accumulated over entire data set
	   1634      .          BR_SECT(1:8,0:31,0:2),	!Basic rate sectors in a voltage step,range arrray
	   1635      .          BR_OMNI(0:31,0:2),      ! sum of above
	   1636      .          
	   1637 C	                                !Basic rate arrays - current readout, only
	   1638      .          BASIC_RATE (1:8,0:2),
	   1639      .          BASIC_RATE_OMNI(0:2),	!basic rates by range summed over all sectors
	   1640 C					 for a given voltage step
	   1641      .          BR_OMNI_SUMMED           !basic rate summed over all ranges, 
	   1642 C				         and all sectors for given voltage step
	   1643     
	   1644 C  counters for pha falling within a basic rate domain
	   1645 C	                                
	   1646        INTEGER*4 PHA_SECT(1:8,0:31,0:2),!PHA COUNT ARRAYS by sector,volt step, and range
	   1647      .           PHA_OMNI(0:31,0:2),    !  - sum over all sectors
	   1648 
	   1649      .           BASIC_PHA_OMNI(0:2),	!PHA COUNTS by range 0:2 - omni
	   1650      .	         BASIC_PHA(1:8,0:2)	!		         - sector
	   1651 
	   1652 C Basic rate weight factor
	   1653 C             weight factors for a given voltage step
	   1654        REAL*4 BASIC_W(1:8,0:2),		!weight factor by range 0:2 for a 
	   1655 C		             		!  given voltage step, with full
	   1656 C			                !  directional information
	   1657 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  19
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1658 C             weight factors determined by entire data set
	   1659      .        BR_SECT_WEIGHT(1:8,0:31,0:2), !weight factor sector, voltage step ,range arrray
	   1660      .        BR_OMNI_WEIGHT(0:31,0:2)      !
	   1661 
	   1662        INTEGER*4 ISUN                         !pha data sun sector (8-11) flag
	   1663 
	   1664        REAL*4  EFF /1.0/
	   1665        REAL*4  EFF_VS_MMQ		     !efficiency TCR/Io for each bin
	   1666        REAL*4  DCR_RSR,TCR_FSR,DCR_FSR
	   1667        INTEGER*4 EFF_HITS		     !efficiency was zero, had to make >0
	   1668        REAL*4 ENERGY_BANDWIDTH	     !energy bandwidth allowed 
	   1669 
	   1670 C  	************************************************
	   1671 C	*    MASS derived Solar Wind values           *
	   1672 C	************************************************
	   1673 
	   1674        REAL*4  AVE_SPEED,		!Average solar wind speed
	   1675      .         H_SPEED,			!Proton speed
	   1676      .         H_UNCER,			!Uncertainty in proton speed from width
	   1677      .         HE2_SPEED,		!Alpha speed
	   1678      .	       HE2_UNCER,		!Uncertainty in alpha speed  from width
	   1679      .         SPEED_HITS,		!Number of valid speed values in interval
	   1680      .         SUM_HE2_SPEED,		!Sum of alpha speeds over interval
	   1681      .         SW_SPEED                 !chosen solar wind speed to check against                      
	   1682 
	   1683 C  	************************************************
	   1684 C	*	DUMMY and TEMPORARY VARIABLES          *
	   1685 C	************************************************
	   1686 
	   1687       CHARACTER*1 YORN			!yes or no answer
	   1688       INTEGER*4   I,II,J,JJ,KK,K,L,N,NN,MM,CNTR,ITEMP,ITEMP2
	   1689       INTEGER*4   INQ,INM, ISTEP
	   1690 
	   1691 C  	************************************************
	   1692 C	*	Getting SMS L1 data:                   *
	   1693 C	************************************************
	   1694 
	   1695       RECORD /CORE/ SCI
	   1696       RECORD /HDBstr/ HDB
	   1697       RECORD /ST_RATE/ STICS_RATE
	   1698       RECORD /ST_PHA/ STICS_PHA
	   1699       RECORD /T/ START, END, TIME_TO_USE
	   1700       RECORD /MA_RATE/ MASS_RATE   ! receives data on rates from MASS sensor
	   1701       RECORD /MA_PHA/ MASS_PHA     ! receives data on tof's from the mass sensor
	   1702 
	   1703 
	   1704 
	   1705 
	   1706 C   **********************************************************
	   1707 C   *							     *
	   1708 C   *		USER PROMPTS	: input file		     *
	   1709 C   *				  table format		     *
	   1710 C   *				  data filtering	     *
	   1711 C   *				  times			     *
	   1712 C   *							     *
	   1713 C   **********************************************************
	   1714 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  20
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1715 C			FILE NAME PROMPTS
	   1716 C
	   1717 C Get input L1 filename
	   1718 C
	   1719       L1FILENAME = 'DATA_DIR:WI*L1*.DAT'
	   1720       CALL WIND_GET_FILENAME(L1FILENAME, STATUS)
	   1721       IF(STATUS.NE.1) THEN
	   1722 	WRITE (*,2) STATUS
	   1723     2   FORMAT(' FILE STATUS = ',I3)
	   1724         STOP
	   1725       ENDIF
	   1726 
	   1727 C
	   1728 C Prompt user for output filename
	   1729 C
	   1730       WRITE(6,*)'Enter name for output MATRIX file or <RETURN> for default name'
	   1731       READ(5,'(A)') USERNAME1
	   1732 
	   1733       STANDARD = 0		!user prompts required
	   1734 
	   1735       TYPE 4
	   1736     4 FORMAT(' Are standard user requests desired? [Y/N]: ',$)
	   1737       ACCEPT 7, YORN
	   1738       IF (YORN.EQ.'Y' .OR. YORN.EQ.'y') STANDARD=1
	   1739 
	   1740 C			TABLE and MATRIX FORMAT PROMPTS
	   1741 
	   1742 C
	   1743 C Prompt user if table desired
	   1744 C 
	   1745       MATRIX_FORMAT = 1     !default MvsM/Q, EvsT format not implemented
	   1746       TABLE_FORMAT  = 0
	   1747       IF (STANDARD .EQ. 0) THEN 
	   1748          TYPE 5
	   1749     5    FORMAT(' Is table listing of PHA events desired [Y/N]: ',$)
	   1750          ACCEPT 7, YORN
	   1751          IF (YORN.EQ.'Y' .OR. YORN.EQ.'y') THEN
	   1752             TABLE_FORMAT = 1
	   1753             WRITE(6,*)'Enter output PHA filename or <RETURN> for default name'
	   1754             READ(5,'(A)')USERNAME2
	   1755          ENDIF
	   1756       ENDIF
	   1757 
	   1758 C
	   1759 C Prompt user for matrix resolution :  DPU DEFAULT VALUES are NM_MAX =  59
	   1760 C								NMIN = 0.5
	   1761 C								NMAX =  95
	   1762 C 
	   1763 
	   1764       USER_NM_MAX = -1	     !use DPU default
	   1765       USER_MMIN   = -1	     !use DPU default
	   1766       USER_MMAX   = -1       !use DPU default
	   1767       NM_MAX      = USER_NM_MAX
	   1768       MMIN        = USER_MMIN
	   1769       MMAX        = USER_MMAX
	   1770 
	   1771 C

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  21
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1772 C Prompt user for matrix resolution :  DPU DEFAULT VALUES are NQ_MAX = 126
	   1773 C								NMIN = 0.9
	   1774 C								NMAX = 42
	   1775 
	   1776       USER_NQ_MAX  = -1   !use DPU default
	   1777       USER_MQMIN   = -1	  !use DPU default
	   1778       USER_MQMAX   = -1	  !use DPU default
	   1779       NQ_MAX       = USER_NQ_MAX
	   1780       MQMIN        = USER_MQMIN
	   1781       MQMAX        = USER_MQMAX
	   1782      
	   1783 C   ***********************************************************************
	   1784 C   *                    determine Nm, Nq coefficients                    *
	   1785 C   ***********************************************************************
	   1786 
	   1787        CALL USER_NMNQ_COEFF(USER_NQ_MAX,USER_MQMAX,USER_MQMIN,  !user input
	   1788      .                 USER_NM_MAX,USER_MMAX,USER_MMIN,
	   1789      .                 ELOW,EHIGH,TLOW,THIGH,      		!return values
	   1790      .                 NQ_MAX,MQMAX,MQMIN,
	   1791      .                 NM_MAX,MMAX ,MMIN,
	   1792      .                 RKM,RKQ,
	   1793      .                 AM,BM,C1_EQ,C2A_EQ,C2B_EQ,D1_EQ,D2_EQ,EMQ,
	   1794      .                 BK_C2, BK_MQ)
	   1795 
	   1796       DO INM = 0,200
	   1797          USER_NM_M(INM) = 0.
	   1798          IF(INM.GT.0.  .AND.  INM.LE.NM_MAX) THEN
	   1799             USER_NM_M(INM) = MMIN * RKM**(FLOAT(INM)-1.)	!lower bounds
	   1800 	    USER_NM_MID(INM) = 0.5* MMIN * (RKM**(FLOAT(INM)-1.) + RKM**FLOAT(INM)) !mid point
	   1801 	 ELSE IF (INM.EQ.0) THEN
	   1802 	    USER_NM_MID(INM) = 0.
	   1803 	 END IF
	   1804       END DO
	   1805 
	   1806       DO INQ = 0, 300
	   1807          USER_NQ_MPQ(INQ) = 0.
	   1808          IF(INQ.GT.0  .AND.  INQ.LE.NQ_MAX+1) THEN
	   1809            USER_NQ_MPQ(INQ) = MQMIN *RKQ**(FLOAT(INQ)-1.)
	   1810  	   USER_NQ_MID(INQ) = 0.5 * MQMIN *( RKQ**(FLOAT(INQ)-1.) + RKQ**FLOAT(INQ))
	   1811          ELSE IF (INQ.EQ.0) THEN
	   1812 	   USER_NQ_MID(INQ) = 0.5 * MQMIN
	   1813 	 ENDIF
	   1814       END DO
	   1815 
	   1816     
	   1817 
	   1818 C			DATA FILTER PROMPTS
	   1819 
	   1820 C
	   1821 C Prompt user for filtering
	   1822 C 
	   1823 C     Initialize default conditions
	   1824       DATA_FILTER = 0			!no data filtering
	   1825       DATA_FILTER_COINC = 0		!no filtering by m or m/q conditions
	   1826       DATA_FILTER_DVSTEP  = -1		!no filtering by e/q
	   1827       DATA_DVSTEP_MIN = 0			!min dv step = 0
	   1828       DATA_DVSTEP_MAX = 31			!max dv step = 31

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  22
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1829       DATA_FILTER_RANGE = 0		!no filtering by range
	   1830       DATA_FILTER_RANGECHECK = 0 	!no filtering by range check
	   1831       SEL_RANGE(0) = .TRUE.			!accept range 0 events
	   1832       SEL_RANGE(1) = .TRUE.			!accept range 1 events
	   1833       SEL_RANGE(2) = .TRUE.			!accept range 2 events
	   1834       DATA_FILTER_MSPEED = -1        	!no check on MASS solar wind speed
	   1835       DATA_MSPEED_MAX    = 10000     		!max sw speed selection is 10000 km/sec
	   1836       DATA_MSPEED_MIN    = 0      		!min sw speed selection is 100 km/sec
	   1837 
	   1838 
	   1839       DIRECTION_FILTER = 1         !YES - filtering by telescope info - see direction_check
	   1840       DIRECTION_FILTER_START = -1  	!no selection by start id
	   1841       DIRECTION_FILTER_STOP  = -1  	!no selection by stop id
	   1842       DIRECTION_FILTER_SSD   = -1  	!no selection by ssd
	   1843       DIRECTION_CHECK =  1         	!YES - check on telescope id for consistency
	   1844 
	   1845       IF (STANDARD .EQ. 0) THEN
	   1846         TYPE 6
	   1847     6   FORMAT(' Is data filtering by DATA TYPE desired? '
	   1848      .      /' (i.e.:  M,M/Q conditions, E/Q (VS), PHA Range, '
	   1849      .      /' Solar Wind Speed)    [Y/N] '$)
	   1850         ACCEPT 7, YORN
	   1851     7   FORMAT (A)
	   1852         IF (YORN.EQ.'Y' .OR. YORN.EQ.'y') THEN
	   1853            DATA_FILTER = 1
	   1854 	   CALL USER_REQUESTS_DATA_TYPE(
	   1855      .           DATA_FILTER_COINC,
	   1856      .           DATA_FILTER_DVSTEP,
	   1857      .		 DATA_DVSTEP_MIN,
	   1858      .		 DATA_DVSTEP_MAX,
	   1859      .           DATA_FILTER_RANGE,
	   1860      .           SEL_RANGE, 
	   1861      .           DATA_FILTER_RANGECHECK,
	   1862      .           DATA_FILTER_MSPEED,
	   1863      .           DATA_MSPEED_MIN,
	   1864      .           DATA_MSPEED_MAX)
	   1865         ENDIF
	   1866       ENDIF
	   1867                                   
	   1868 C			TIME PROMPTS
	   1869  
	   1870 C
	   1871 C Prompt user for start and stop times
	   1872 C
	   1873       TYPE 11
	   1874   11  FORMAT(/' Enter Start time( -1/ = whole file) - ',/,
	   1875      .       ' Year,Month,Day,Hour,Min,Sec: '$) 
	   1876       ACCEPT*, START.YEAR,MONTH,DAYOFMONTH,START.HR,START.MIN,START.SEC
	   1877       IF(START.YEAR.GE.0)THEN
	   1878 C
	   1879 C Convert month and day to day of year.
	   1880 C
	   1881         CALL CNVRT_T_YRMONDAY_TO_YEARDAY( START, MONTH, DAYOFMONTH)
	   1882         IF(START.YEAR.LT.100)START.YEAR=START.YEAR+1900        ! Allow for 2-digit years
	   1883         IF(START.YEAR.LT.1980)START.YEAR=START.YEAR+100        ! Allow for years beyond 1999
	   1884         TYPE 12
	   1885   12    FORMAT(' Enter End time - ',/,

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  23
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1886      .         ' Year,Month,Day,Hour,Min,Sec: '$) 
	   1887         ACCEPT*, END.YEAR,ENDMONTH,ENDDAYOFMONTH,END.HR,END.MIN,END.SEC
	   1888 C
	   1889 C Convert month and day to day of year.
	   1890 C
	   1891         CALL CNVRT_T_YRMONDAY_TO_YEARDAY( END, ENDMONTH, ENDDAYOFMONTH)
	   1892         IF(END.YEAR.LT.100)END.YEAR=END.YEAR+1900        ! Allow for 2-digit years
	   1893         IF(END.YEAR.LT.1980)END.YEAR=END.YEAR+100        ! Allow for years beyond 1999
	   1894       ELSE
	   1895         END.YEAR=3000
	   1896       ENDIF
	   1897 
	   1898 C   **********************************************************
	   1899 C   *							     *
	   1900 C   *		INITIALIZATION				     *
	   1901 C   *							     *
	   1902 C   **********************************************************
	   1903 
	   1904 C Set time format to "wall" time (=0).  For flight data, s/c clock
	   1905 C and wall clock should be equivalent
	   1906 
	   1907        USE_SC_CLOCK = 0
	   1908 
	   1909        FIRSTFILE = .TRUE.
	   1910        EFF_HITS  = 0
	   1911 
	   1912 
	   1913 
	   1914        DO INQ = 0,130			!zero out nm nq array for dpu default
	   1915           DO INM = 0,70
	   1916             DPU_NQNM(INQ,INM)     = 0
	   1917 	    DPU_CNQNM(INQ,INM) = '     '
	   1918           END DO
	   1919        END DO
	   1920 
	   1921        DO INQ = 0,300			!zero out nm nq array
	   1922           DO INM = 0,200
	   1923 	    OMNI_NQNM(INQ,INM)    = 0.
	   1924 	    SUN_NQNM (INQ,INM)    = 0.
	   1925 	    SUN_EFF_NQNM(INQ,INM) = 0.
	   1926 	    OMNI_CNQNM(INQ,INM)    = '     '
	   1927             SUN_CNQNM (INQ,INM)    = '     '
	   1928 	    SUN_EFF_CNQNM(INQ,INM) = '     '
	   1929           END DO
	   1930        ENDDO
	   1931 
	   1932        DO ISTEP = 0,31					!voltage step
	   1933           DO J=0,2					!range
	   1934 		DO INQ=0,300				!Nq
	   1935                    DO INM = 0,200			!Nm
	   1936 		      SUN1_NQNM_VS_R(ISTEP,INQ,INM,J) = 0
	   1937 		      SUN2_NQNM_VS_R(ISTEP,INQ,INM,J) = 0
	   1938                    END DO
	   1939 		END DO
	   1940 
	   1941 	        DO MM = 1,8     !sector
	   1942      	          BR_SECT(MM,ISTEP,J)   = 0  !basic rate sector, voltage step ,range arrray

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  24
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   1943      	          PHA_SECT(MM,ISTEP,J)   = 0 !total PHA sector, voltage step ,range arrray
	   1944                 END DO
	   1945 
	   1946 	    BR_OMNI(ISTEP,J) = 0
	   1947             PHA_OMNI(ISTEP,J) = 0
	   1948 	  END DO
	   1949        END DO
	   1950 
	   1951 C   get dpu default values for mass, mq, e/q, etc calculations -
	   1952 C   used here for header information only
	   1953 
	   1954        CALL DPU_DEFAULT_COEFF
	   1955      .                (DPU_NQ_MAX,DPU_MQMAX,DPU_MQMIN,
	   1956      .                 DPU_NM_MAX,DPU_MMAX,DPU_MMIN,
	   1957      .                 DPU_ELOW, DPU_EHIGH,DPU_TLOW,DPU_THIGH,
	   1958      .                 DPU_AM,DPU_BM,DPU_C1_EQ,DPU_C2A_EQ,
	   1959      .                 DPU_C2B_EQ,DPU_D1_EQ,DPU_D2_EQ,
	   1960      .                 DPU_EMQ,DPU_BK_C2,DPU_BK_MQ,DPU_KM,
	   1961      .                 DPU_KQ, DPU_NM_M, DPU_NQ_MPQ)
	   1962 
	   1963 C   **********************************************************
	   1964 C   *							     *
	   1965 C   *			CREATE OUTPUT FILE NAME		     *
	   1966 C   *                        either DEFAULT or		     *
	   1967 C   *                               USER DEFINED             *
	   1968 C   *							     *
	   1969 C   **********************************************************
	   1970 C
	   1971 C   Strip the extension off of the input file name so
	   1972 C   that we can give a new extension to the output file
	   1973 C
	   1974       NINDEX  = 80
	   1975       DO WHILE (L1FILENAME(NINDEX:NINDEX) .NE. '_')
	   1976          NINDEX = NINDEX - 1
	   1977       END DO
	   1978 C
	   1979 C   Find out if the input file name contains some directory
	   1980 C   designation.  This, if it exists, it will also be stripped off.
	   1981 C
	   1982       I = 1
	   1983       DO WHILE (.NOT. BRACK .AND. I .LT. NINDEX)
	   1984          IF (L1FILENAME(I:I) .EQ. '[') BRACK = .TRUE.
	   1985          I = I + 1
	   1986       END DO
	   1987 C
	   1988 C   Now, finally, load the input file name into the output
	   1989 C   file name and add proper extension.  Format of input
	   1990 C   file is SMSDISK3:[WIND.L1DATA]WI_L1_SMS_YYYYMMDD_Vxx.DAT
	   1991 C   Write over all but the _YYYYMMDD_ part.
	   1992 C
	   1993       JSAVE = 1
	   1994       DO 3 I = 1, NINDEX
	   1995          IF (BRACK) THEN
	   1996             IF (L1FILENAME(I:I) .EQ. ']') BRACK = .FALSE.
	   1997          ELSE
	   1998             LISFIL1(JSAVE:JSAVE) = L1FILENAME(I:I)
	   1999             JSAVE = JSAVE + 1

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  25
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2000          ENDIF
	   2001    3  CONTINUE
	   2002       LISFIL1(1:9) = 'STICS_FLX_'
	   2003       LISFIL2 = LISFIL1
	   2004       LISFIL3 = LISFIL1
	   2005       LISFIL4 = LISFIL1
	   2006       LISFIL3(1:9) = 'STICS_DPU'
	   2007       LISFIL4(1:9) = 'STICS_FLX'
	   2008       IF  (MATRIX_FORMAT .EQ. 1) THEN
	   2009 	      LISFIL1(JSAVE:JSAVE+6) = 'MMQ.MTX'        ! mass vs mq
	   2010               LISFIL2(JSAVE:JSAVE+6) = 'MMQ.TBL'
	   2011               LISFIL3(JSAVE:JSAVE+6) = 'MMQ.MTX'
	   2012               LISFIL4(JSAVE:JSAVE+6) = 'IRON.NQ'
	   2013       ELSE						
	   2014 	      LISFIL1(JSAVE:JSAVE+6) = 'ENT.MTX'        ! energy and time
	   2015               LISFIL2(JSAVE:JSAVE+6) = 'ENT.TBL'        ! not yet implemented
	   2016               LISFIL3(JSAVE:JSAVE+6) = 'ENT.MTX'
	   2017       ENDIF
	   2018 
	   2019       IF(USERNAME1(1:12) .NE. '            ') THEN
	   2020         OUTFILENAME1 = USERNAME1
	   2021       ELSE
	   2022         OUTFILENAME1 = LISFIL1 		   ! default matrix filename
	   2023       ENDIF      
	   2024       IF(USERNAME2(1:12) .NE. '            ') THEN
	   2025          OUTFILENAME2 = USERNAME2
	   2026       ELSE
	   2027          OUTFILENAME2 = LISFIL2            ! default table filename
	   2028       ENDIF      
	   2029          OUTDPUFILE = LISFIL3
	   2030          OUTFILENAME3 = LISFIL4
	   2031       
	   2032       
	   2033 C   **********************************************************
	   2034 C   *							     *
	   2035 C   *			OPEN L1 INPUT FILE 		     *
	   2036 C   *			READ DATA			     *
	   2037 C   *							     *
	   2038 C   **********************************************************
	   2039 
	   2040 C
	   2041 C Open L1 file for input, and read first SR, Core, HDB, and STICS_RATES
	   2042 C
	   2043  1000 CONTINUE
	   2044       IF (FIRSTFILE .EQ. .FALSE.) THEN
	   2045         IFILE = IFILE + 1
	   2046 	OPENMODE = 1
	   2047 	CALL WIND_L1_OPEN_NEXT(L1_LUN,OPENMODE,L1FILENAME,L1_FILE_HEADER,STATUS)
	   2048       ELSE
	   2049         IFILE = 1
	   2050         FIRSTFILE = .FALSE.
	   2051         CALL WIND_L1_OPEN( L1_LUN, L1FILENAME, L1_FILE_HEADER, STATUS)
	   2052       ENDIF
	   2053       IF (STATUS .NE. 1) GOTO 9010
	   2054 
	   2055       INQUIRE(FILE=L1FILENAME,NAME=FULL_L1_NAME)
	   2056       INPUTFILES(IFILE) = FULL_L1_NAME

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  26
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2057       WRITE(6,1001) FULL_L1_NAME
	   2058  1001 FORMAT(' OPEN FILE ',A)
	   2059   
	   2060       NAMELEN = INDEX(FULL_L1_NAME,' ') - 1
	   2061       IF (NAMELEN .LT. 1) NAMELEN=LEN(FULL_L1_NAME)
	   2062 
	   2063   13  CALL WIND_L1_READ_SR( L1_LUN, CNTR, L1_SR_HEADER, STATUS )
	   2064       IF(STATUS.EQ.RMS$_EOF)GO TO 900
	   2065       IF (STATUS .NE. 1) GOTO 9020
	   2066       CALL WIND_L1_GET_BASIC( L1_LUN, SCI, STATUS)
	   2067       IF (STATUS .NE. 1) GOTO 9030
	   2068       CALL WIND_L1_GET_HDB( L1_LUN, HDB, STATUS)
	   2069       IF (STATUS .NE. 1) GOTO 9050
	   2070       CALL WIND_L1_GET_STICS( L1_LUN, STICS_RATE, STICS_PHA, STATUS )
	   2071       IF (STATUS .NE. 1) GOTO 9080
	   2072 C
	   2073 C Find first good spin, get year and DOY from it.
	   2074 C
	   2075       N=0
	   2076       GOODSPIN=.FALSE.
	   2077       DO 14 WHILE(.NOT.GOODSPIN)
	   2078         K=N/32+1
	   2079         NN=MOD(N,32)
	   2080         GOODSPIN=BTEST(L1_SR_HEADER.PRESENT(K),NN)
	   2081         N=N+1
	   2082         IF(N.GT.59)GOTO 13 ! This SCI-REC all bad; get next
	   2083   14  CONTINUE
	   2084 C
	   2085 C If low bitrate, make sure that N points to an even spin (odd spins 
	   2086 C have been emptied by concatenation).
	   2087 C If high bitrate, decrement because N was incremented after the 1st 
	   2088 C good spin was found.
	   2089 C
	   2090       IF(.NOT.SCI.EDB(N).BITRATE)THEN
	   2091         N=N+MOD(N,2)
	   2092         IF(N.GE.60)GOTO 13   ! This SCI-REC all bad; get next 
	   2093       ELSE
	   2094         N=N-1
	   2095       ENDIF
	   2096 C
	   2097 C Check FIFO mode, telemetry mode, TGS mode, and trigger mode; place info in header.
	   2098 C
	   2099       ITEMP = HDB.BDH.DAT(221)
	   2100       IF(IBITS(ITEMP,7,1).EQ.1)THEN
	   2101         FIFO='ON '
	   2102       ELSE
	   2103         FIFO='OFF'
	   2104       ENDIF
	   2105 C  
	   2106       ITEMP = SCI.EDB(N).TLM_Mode
	   2107       IF(ITEMP.EQ.0)ITEMP=10
	   2108       IF(ITEMP.EQ.128)ITEMP=9
	   2109       IF(ITEMP.EQ.256)ITEMP=10
	   2110       MODE_AT_START = MODE(ITEMP)
	   2111 C
	   2112       ITEMP = STICS_RATE.EDB(N).RATE(179)
	   2113       IF(IBITS(ITEMP,7,1).EQ.1)THEN

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  27
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2114         TGS='ON '
	   2115       ELSE
	   2116         TGS='OFF'
	   2117       ENDIF
	   2118 C
	   2119       ITEMP = HDB.BDH.DAT(25)
	   2120       TRIGGER_MODE_CODE = IBITS(ITEMP,1,3)
	   2121 
	   2122 C   **********************************************************
	   2123 C   *							     *
	   2124 C   *			OPEN OUTPUT FILES		     *
	   2125 C   *			WRITE HEADER			     *
	   2126 C   *							     *
	   2127 C   **********************************************************
	   2128 C
	   2129 	RONOFF = 'OFF'					!some info on user input
	   2130         IF(DATA_FILTER_RANGECHECK.EQ.1) RONOFF = ' ON'
	   2131         TONOFF = 'OFF'
	   2132         IF(DIRECTION_CHECK.EQ.1) TONOFF = ' ON'
	   2133 
	   2134 C Open PHA file for table listing output
	   2135 C
	   2136        IF (TABLE_FORMAT.GT.0) THEN
	   2137 
	   2138         IF(IFILE.EQ. 1) OPEN(UNIT= 50, NAME= OUTFILENAME2, 
	   2139      &     DEFAULTFILE='SMSDISK4:[WIND.L2DATA.STICS]', FORM='FORMATTED', 
	   2140      &     TYPE='NEW', RECL=168)
	   2141 
	   2142         WRITE(50,15) 
	   2143         WRITE(50,16) FULL_L1_NAME(1:NAMELEN)
	   2144         WRITE(50,17) OUTFILENAME2
	   2145         WRITE(50,18) 'Wall', DATA_DVSTEP_MIN, DATA_DVSTEP_MAX,
	   2146      .                  DIRECTION_FILTER_START
	   2147         WRITE(50,19)
	   2148      .              TRIGGER_MODE(TRIGGER_MODE_CODE),COINC(DATA_FILTER_COINC),
	   2149      .              DIRECTION_FILTER_STOP, 
	   2150      .              FIFO,RANGESEL(DATA_FILTER_RANGE),DIRECTION_FILTER_SSD,
	   2151      .              TGS,RONOFF,TONOFF,MODE_AT_START,DATA_MSPEED_MIN,
	   2152      .              DATA_MSPEED_MAX,
	   2153      .              START.YEAR,MONTH,DAYOFMONTH,START.HR,START.MIN,START.SEC,
	   2154      .              END.YEAR,ENDMONTH,ENDDAYOFMONTH,END.HR,END.MIN,END.SEC
	   2155         WRITE(50,195)
	   2156        ENDIF
	   2157 
	   2158 C
	   2159 C Open PHA file for matrix listing output
	   2160 C
	   2161        IF(IFILE.EQ.1) THEN
	   2162 	   OPEN(UNIT= 55, NAME= OUTFILENAME1, 
	   2163      &     DEFAULTFILE='SMSDISK4:[WIND.L2DATA.STICS]', FORM='FORMATTED', 
	   2164      &     TYPE='NEW', RECL=2600)
	   2165 
	   2166 	   OPEN(UNIT= 56, NAME= OUTDPUFILE, 
	   2167      &     DEFAULTFILE='SMSDISK4:[WIND.L2DATA.STICS]', FORM='FORMATTED', 
	   2168      &     TYPE='NEW', RECL=2600)
	   2169 
	   2170            OPEN(UNIT= 57, NAME= OUTFILENAME3, 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  28
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2171      &     DEFAULTFILE='SMSDISK4:[WIND.L2DATA.STICS]', FORM='FORMATTED', 
	   2172      &     TYPE='NEW', RECL=2600)
	   2173 
	   2174          DO OUTUNIT = 55,57
	   2175           WRITE(OUTUNIT,155)
	   2176           WRITE(OUTUNIT,16) FULL_L1_NAME(1:NAMELEN)
	   2177          END DO
	   2178 
	   2179           WRITE(55,17) OUTFILENAME1
	   2180           WRITE(56,17) OUTDPUFILE
	   2181           WRITE(57,17) OUTFILENAME3
	   2182 
	   2183          DO OUTUNIT = 55,57
	   2184           WRITE(OUTUNIT,18) 'Wall', DATA_DVSTEP_MIN, DATA_DVSTEP_MAX,
	   2185      .                  DIRECTION_FILTER_START
	   2186 
	   2187           WRITE(OUTUNIT,19)TRIGGER_MODE(TRIGGER_MODE_CODE),COINC(DATA_FILTER_COINC),
	   2188      .              DIRECTION_FILTER_STOP, 
	   2189      .              FIFO,RANGESEL(DATA_FILTER_RANGE),DIRECTION_FILTER_SSD,
	   2190      .              TGS,RONOFF,TONOFF,MODE_AT_START,DATA_MSPEED_MIN, 
	   2191      .              DATA_MSPEED_MAX,
	   2192      .              START.YEAR,MONTH, DAYOFMONTH,START.HR,START.MIN,START.SEC,
	   2193      .              END.YEAR,ENDMONTH,ENDDAYOFMONTH,END.HR,END.MIN,END.SEC
	   2194 
	   2195  	   WRITE(OUTUNIT,480) DPU_D1_EQ,DPU_D2_EQ,DPU_C2A_EQ,
	   2196      .                 DPU_BK_MQ,DPU_C2B_EQ,DPU_BK_MQ,DPU_C1_EQ,
	   2197      .                (I,DPU_EMQ(I), I=1,3)
	   2198            WRITE(OUTUNIT,481) 
	   2199            WRITE(OUTUNIT,482)(I,DPU_AM(I), I,DPU_BM(I), I = 1, 6)
	   2200            WRITE(OUTUNIT,483) DPU_ELOW, DPU_EHIGH, DPU_KQ,
	   2201      .                      DPU_TLOW, DPU_THIGH, DPU_KM
	   2202          END DO
	   2203        ENDIF		!first input file
	   2204 
	   2205 C    format statements for headers:
	   2206 
	   2207   15    FORMAT('1',' 1  STICS TIME, PHA and DPU M & M/Q TABLE LISTING')
	   2208   155   FORMAT(' 1  STICS  NM vs NQ MATRIX ')
	   2209   16    FORMAT(' 2',T10,'Input Level 1 Filename: ',A)
	   2210   17    FORMAT(' 3',T10,'       Output Filename: ',A)
	   2211   18    FORMAT(' 4'/,' 5',T5,'Clock selected: ',A,
	   2212      .           17X,'FILTERING CHOICES:   Voltage step selection =  ' I2 ' to ' I2 ' ',
	   2213      .           10X,'   Start anode =  ' I2)
	   2214 
	   2215   19     FORMAT(' 6',T5,'Trigger mode is ',A22,20X,'Event type selection   =' 
	   2216      .              A10,14X,'Stop MCP    =  ' I2,/
	   2217      .         ' 7',T5,'FIFO mode is ',A3,    42X,'Range selection        =     ' 
	   2218      .              A5,14X, 'SSD ID      =  ' I2/,
	   2219      .         ' 8',T5,'TGS  mode is ',A3,    42X,'Range checking is 'A3,
	   2220      .              27X,'Telescope checking is 'A3,/,
	   2221      .	       ' 9',T5,'Telemetry mode is ',A17, 23X,'Velocity range         = '
	   2222      .              I4,' to', I6, /,
	   2223      .         ' 10',T5,'Start Time ',I4,1X,I2"/"I2,1X,
	   2224      .           I2.2,2(':',I2.2),5X,'End Time ',I4,1X,I2"/"I2,1X,
	   2225      .           I2.2,2(':',I2.2))
	   2226 
	   2227   195    FORMAT(' 11',/' 12    SR BR  Year  Day    Time    VS     E/Q'

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  29
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2228      .  '    StopID  StartID/R  E(Ed)  Sect  SSD',
	   2229      &  '  ToF(Td) START RANGE  SPEED   M/Q    MASS   NM   NQ  NRG  BR(R)/BR012',/)
	   2230 
	   2231  480      FORMAT(/,'  DPU DEFAULT ALGORITHMS: '//,
	   2232      $ '  DPU  E/Q = ',F7.4,' * (',F8.6,')**DVSTEP',//,
	   2233      $ '  DPU  M/Q = C1 * [ (E/Q) - ',F5.2,
	   2234      $               ' ]  *  (TOF)**2 , for m/q < 'F5.2/,
	   2235      $ '  DPU  M/Q = C1 * [ (E/Q) - ',F5.2,
	   2236      $               ' ]  *  (TOF)**2 , for m/q > 'F5.2/
	   2237      $ '     where   C1 = ',1PE11.4//,
	   2238      $       3(10X,'  E(',I1,') = 'G14.7/),/)
	   2239     
	   2240  481     FORMAT(/'  DPU Log(M) = A1 + A2*Log(E)'
	   2241      $          ' + A3*Log(T) + A4*Log(E)*Log(T) + '
	   2242      $          'A5*[Log(E)]**2 + A6*[Log(T)]**3 '/25X,
	   2243      $          ', where T=measured TOF, E=measured Energy'//)
	   2244  482     FORMAT(5X,'A',I1,' =',G14.7,5X,'B',I1,' =',G14.7/)
	   2245 
	   2246  483     FORMAT (/'  DPU Energy and Time windows: ',20X,
	   2247      .		 '  DPU Binning Resolution: '
	   2248      .          /'  Emin = 'F5.2' keV    Emax = 'F8.2' keV'
	   2249      .           29X,'  MQ = MQmin * kQ**(Nq-1) :  DPU_kQ = ' F7.5,/,
	   2250      .           '  Tmin = 'F5.2' nsec   Tmax = 'F8.2' nsec'
	   2251      .           29X,' M  =  Mmin * kM**(Nm-1) :  DPU_kM = ' F7.5,/)
	   2252 
	   2253 
	   2254 C     ***************************************************
	   2255 C     *		Get the Basic Core data			*
	   2256 C     ***************************************************
	   2257 C
	   2258  100  CALL WIND_L1_GET_BASIC( L1_LUN, SCI, STATUS)
	   2259       IF (STATUS .NE. 1) GOTO 9030
	   2260 C
	   2261 C Get Housekeeping Data Block
	   2262 C
	   2263       CALL WIND_L1_GET_HDB( L1_LUN, HDB, STATUS)
	   2264       IF (STATUS .NE. 1) GOTO 9050
	   2265 C
	   2266 C Get STICS rates and PHA
	   2267 C
	   2268       CALL WIND_L1_GET_STICS( L1_LUN, STICS_RATE, STICS_PHA, STATUS )
	   2269       IF (STATUS .NE. 1) GOTO 9080
	   2270 C
	   2271 C Get MASS rates and PHA
	   2272 C
	   2273       CALL WIND_L1_GET_MASS(L1_LUN,MASS_RATE,MASS_PHA,STATUS)   ! mass data
	   2274       IF (STATUS .NE. 1) GOTO 9085
	   2275 C
	   2276 C Get solar wind speed from MASS
	   2277 C
	   2278       SW_SPEED = -100.		!set solar wind speed to outside normal range values
	   2279       CALL MASS_SPEED(HDB,MASS_RATE,H_SPEED,H_UNCER,HE2_SPEED,HE2_UNCER)
	   2280       WRITE(6,*) H_SPEED, HE2_SPEED
	   2281       IF((HE2_SPEED.GE.140.0).AND.(HE2_SPEED.LE.1500))THEN   !to find average speed		
	   2282          SW_SPEED = HE2_SPEED              !use helium for iron speeds
	   2283          SPEED_HITS = SPEED_HITS +1.0
	   2284          SUM_HE2_SPEED = SUM_HE2_SPEED + HE2_SPEED

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  30
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2285       ENDIF 
	   2286 
	   2287 
	   2288 
	   2289 C Get bitrate of 1st good spin.  At HBR, there is data in every spin;
	   2290 C At LBR there is data only in even-numbered spins.
	   2291 
	   2292       BITRATE = SCI.EDB(N).BITRATE
	   2293       IF(BITRATE)THEN
	   2294         INCREMENT = 1
	   2295       ELSE
	   2296         INCREMENT = 2
	   2297       ENDIF
	   2298 C
	   2299 C Set flags for start and stop
	   2300       STARTFOUND=.FALSE.
	   2301       ENDFOUND=.FALSE.
	   2302 
	   2303 C
	   2304 C Output STICS PHA one science record.
	   2305 
	   2306       DO 800 J=0,59,INCREMENT		!0-59 spins
	   2307         IF(USE_SC_CLOCK)THEN
	   2308           TIME_TO_USE = SCI.EDB(J).SC_TIME
	   2309         ELSE
	   2310           TIME_TO_USE = SCI.EDB(J).W_TIME
	   2311         ENDIF
	   2312 C
	   2313 C Compare time read to start time. If the time read is greater than or equal to the user-
	   2314 C specified start time, then begin processing data.
	   2315 C
	   2316         IF(.NOT.STARTFOUND)THEN
	   2317           STARTFOUND=COMPARE_TIME_GE(TIME_TO_USE,START)
	   2318         ENDIF
	   2319         IF(STARTFOUND)THEN
	   2320 C
	   2321 C Compare time read to end time. If time read is greater than the user-specified end time, 
	   2322 C we're done. Go to the part of the code that closes files and STOP's program.
	   2323 C
	   2324           ENDFOUND=COMPARE_TIME_GE(TIME_TO_USE,END)
	   2325           IF(ENDFOUND)GO TO 901
	   2326 C
	   2327 C Check quality flags. If PHA, BR, or overall quality flags are bad, skip this spin
	   2328 C
	   2329           IF(BITRATE)THEN
	   2330             IF(SCI.EDB(J).Qual.NE.0)GOTO 800
	   2331           ELSE
	   2332             IF((SCI.EDB(J).Qual.NE.0).OR.(SCI.EDB(J+1).Qual.NE.0))GOTO 800
	   2333           ENDIF
	   2334           IF(SCI.EDB(J).ST_BR_Qual.NE.0)GOTO 800
	   2335           IF(SCI.EDB(J).ST_P_Qual.NE.0)GOTO 800
	   2336 C
	   2337 C Get dpps enable inforation, voltage step, and default value of e/q. 
	   2338 C
	   2339           ITEMP =HDB.BDH.DAT(24)
	   2340           ITEMP2=HDB.BDH.DAT(25)
	   2341 	  DPPSPLUS  = IBITS(ITEMP,7,1)

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  31
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2342           DPPSMINUS = IBITS(ITEMP2,0,1) 
	   2343 
	   2344           ITEMP = STICS_RATE.EDB(J).RATE(179)
	   2345           DVSTEP = IBITS(ITEMP,0,5)
	   2346 	
	   2347 C    check voltage step filter and solar wind speed filter
	   2348 
	   2349           IF ( (DVSTEP.GE.DATA_DVSTEP_MIN) .AND.
	   2350      .         (DVSTEP.LE.DATA_DVSTEP_MAX) .AND.
	   2351 		
	   2352      .         (DATA_FILTER_MSPEED.EQ.-1 
	   2353      .          .OR. SW_SPEED.GE.DATA_MSPEED_MIN) .AND.
	   2354      .         (DATA_FILTER_MSPEED.EQ.-1 
	   2355      .          .OR. SW_SPEED.LE.DATA_MSPEED_MAX) ) THEN
	   2356 C
	   2357 C If HDB flag is bad, calculate e/q as if both DPPS plates are ON
	   2358 C
	   2359 	     IF(HDB.Qual .NE. 0) THEN
	   2360                 DPU_E_OVER_Q = 6.190722 * (1.1225857**DVSTEP)
	   2361 	     ELSE
	   2362   	        CALL DPU_EQ(DPPSPLUS,DPPSMINUS,DVSTEP,DPU_E_OVER_Q)
	   2363              ENDIF
	   2364 C
	   2365 C Get bit rate
	   2366 C
	   2367             IF(SCI.EDB(J).BITRATE)THEN
	   2368                RATEFLAG='H'                ! High bit rate
	   2369             ELSEIF(TIME_TO_USE.YEAR.NE.0)THEN
	   2370                RATEFLAG='L'                ! Low bit rate
	   2371             ELSE
	   2372                RATEFLAG='?'                ! Bit rate indeterminate, due to bad quality data
	   2373             ENDIF
	   2374 
	   2375 C	*************************************************
	   2376 C       *						*
	   2377 C	*	Determine BR weighting factor   	*
	   2378 C	*						*
	   2379 C	*************************************************
	   2380 
	   2381 	    ITEMP = HDB.BDH.DAT(189)		      !rate compression codes
	   2382             CODE_C1 = BTEST(ITEMP,1)
	   2383             CODE_C2 = BTEST(ITEMP,2)
	   2384 
	   2385 	    ITEMP = STICS_RATE.EDB(J).RATE(179)       !if TGS off, then there 
	   2386 	    IF (IBITS (ITEMP,7,1) .EQ. 1) THEN	      !also Fe matrix rates available
	   2387 		TGS = 'ON'
	   2388 	    ELSE
	   2389 		TGS = 'OFF'
	   2390 	    ENDIF
	   2391 
	   2392 C		***** get the PHA COUNT in each basic rate  ******
	   2393 
	   2394 	    DO II=0,2		!range
	   2395 	      BASIC_PHA_OMNI(II) = 0		!initialize for this voltage step
	   2396               DO MM = 1,8	!sector
	   2397 	        BASIC_PHA(MM,II)   = 0
	   2398 	      END DO

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  32
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2399             END DO
	   2400 
	   2401 C	  look through all the pha for this voltage step,
	   2402 C         and determine the count in each basic rate region
	   2403 
	   2404           DO I = 0, (SCI.EDB(J).STICS_Len-1) * 4, 4
	   2405               CALL DISSECT_STICS_PHA(STICS_PHA.EDB(J).PHA(I),
	   2406      .                      STOP_ID,START_ID_RANGE,ENERGY,SECTOR,
	   2407      .                      SSD_ID,TIME_OF_FLIGHT,PSTART,RANGE)
	   2408 
	   2409 C          get count on pha within each range, without regard for direction
	   2410              BASIC_PHA_OMNI(RANGE) = BASIC_PHA_OMNI(RANGE) + 1
	   2411 
	   2412 C          get count on pha within each range, by sector
	   2413 	     IF (SECTOR.GE.0 .AND. SECTOR.LE.1) ISECT = 1
	   2414 	     IF (SECTOR.GE.2 .AND. SECTOR.LE.3) ISECT = 2
	   2415 	     IF (SECTOR.GE.4 .AND. SECTOR.LE.5) ISECT = 3
	   2416 	     IF (SECTOR.GE.6 .AND. SECTOR.LE.7) ISECT = 4
	   2417 	     IF (SECTOR.GE.8 .AND. SECTOR.LE.9) ISECT = 5
	   2418 	     IF (SECTOR.GE.10.AND. SECTOR.LE.11)ISECT = 6
	   2419 	     IF (SECTOR.GE.12.AND. SECTOR.LE.13)ISECT = 7
	   2420 	     IF (SECTOR.GE.14.AND. SECTOR.LE.15)ISECT = 8
	   2421 	
	   2422              BASIC_PHA(ISECT,RANGE) = BASIC_PHA(ISECT,RANGE) + 1
	   2423           END DO
	   2424 
	   2425 
	   2426 C		***** get the Basic Rates  ******
	   2427 
	   2428 	    DO 220 II=120,143			!these are the basic rates
	   2429 	     STICS_RATES(II+1) = 
	   2430      .            WIND_DECOMPRESS(STICS_RATE.EDB(J).RATE(II),CODE_C1)
	   2431  220        CONTINUE
	   2432 
	   2433 C 	get out basic rates for ranges R0, R1, R2
	   2434 
	   2435 	    BR_OMNI_SUMMED = 0		!initialize for this voltage step
	   2436 
	   2437 	    DO 230 II=0,2	!range
	   2438              BASIC_RATE_OMNI(II)= 0
	   2439 
	   2440              DO MM = 1,8   	!ISECT
	   2441 		BASIC_RATE(MM,II) = STICS_RATES(120+II*8+MM)
	   2442 
	   2443                 IF (BASIC_PHA(MM,II).GT.0) THEN
	   2444 	              BASIC_W(MM,II) = FLOAT(BASIC_RATE(MM,II))
	   2445      .				/  FLOAT(BASIC_PHA(MM,II))
	   2446 		ELSE
	   2447 		      BASIC_W(MM,II) = 1.0
	   2448 		END IF
	   2449 
	   2450 	        BASIC_RATE_OMNI(II) = BASIC_RATE_OMNI(II) 
	   2451      .                              + STICS_RATES(120+II*8+MM)
	   2452 
	   2453 	        BR_SECT(MM,DVSTEP,II) = BR_SECT(MM,DVSTEP,II) 
	   2454      .				      + STICS_RATES(120+II*8+MM)
	   2455              END DO	!over sectors

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  33
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2456 
	   2457 	     BR_OMNI(DVSTEP,II) = BR_OMNI(DVSTEP,II) + BASIC_RATE_OMNI(II)
	   2458 
	   2459              BR_OMNI_SUMMED = BR_OMNI_SUMMED + BASIC_RATE_OMNI(II)
	   2460 
	   2461  230        CONTINUE	!end do over range
	   2462 
	   2463 
	   2464 C
	   2465 C Do loop for all STICS PHA words in this voltage step
	   2466 C
	   2467          DO 300 I=0, (SCI.EDB(J).STICS_Len-1) * 4, 4
	   2468 C
	   2469 C Get parts of PHA word
	   2470 C
	   2471           CALL DISSECT_STICS_PHA(STICS_PHA.EDB(J).PHA(I),
	   2472      .                      STOP_ID,START_ID_RANGE,ENERGY,SECTOR,
	   2473      .                      SSD_ID,TIME_OF_FLIGHT,PSTART,RANGE)
	   2474 
	   2475 C         get corresponding basic rate sector
	   2476 	     IF (SECTOR.GE.0 .AND. SECTOR.LE.1) ISECT = 1
	   2477 	     IF (SECTOR.GE.2 .AND. SECTOR.LE.3) ISECT = 2
	   2478 	     IF (SECTOR.GE.4 .AND. SECTOR.LE.5) ISECT = 3
	   2479 	     IF (SECTOR.GE.6 .AND. SECTOR.LE.7) ISECT = 4
	   2480 	     IF (SECTOR.GE.8 .AND. SECTOR.LE.9) ISECT = 5
	   2481 	     IF (SECTOR.GE.10.AND. SECTOR.LE.11)ISECT = 6
	   2482 	     IF (SECTOR.GE.12.AND. SECTOR.LE.13)ISECT = 7
	   2483 	     IF (SECTOR.GE.14.AND. SECTOR.LE.15)ISECT = 8
	   2484 
	   2485 	     PHA_SECT(ISECT,DVSTEP,RANGE)  = PHA_SECT(ISECT,DVSTEP,RANGE) + 1
	   2486 	
	   2487 	     PHA_OMNI(DVSTEP,RANGE) = PHA_OMNI(DVSTEP,RANGE) + 1
	   2488 
	   2489 C check data quality on telescope consistency
	   2490           CALL TELESCOPE_ID (TIME_OF_FLIGHT,ENERGY,
	   2491      .       PSTART,STOP_ID,SSD_ID, TELE_IDENT, TELE_FLAG)
	   2492 C
	   2493 C Calculate Mass and M/Q using DPU algorithms
	   2494 C
	   2495           CALL MMPQ_DPU_WSTICS(DPPSPLUS,DPPSMINUS,DVSTEP,
	   2496      .                           ENERGY,TIME_OF_FLIGHT,
	   2497      .                           DPU_MASS_OVER_Q,DPU_MASS,
	   2498      .                           DPU_NM,DPU_NQ,DPU_RANGE)
	   2499 	  IF (FIFO .EQ. 'ON ') DPU_RANGE = 2
	   2500 		
	   2501           CALL USER_NMNQ_PHA_BINNED(DPPSPLUS,DPPSMINUS,DVSTEP,  !pha event information
	   2502      .                ENERGY,TIME_OF_FLIGHT,
	   2503      .                NQ_MAX,MQMAX,MQMIN,    !information for binning
	   2504      .                NM_MAX,MMAX, MMIN,
	   2505      .                ELOW,EHIGH,TLOW,THIGH,      !return values
	   2506      .                RKM,RKQ,
	   2507      .                AM,BM,C1_EQ,C2A_EQ,C2B_EQ,D1_EQ,D2_EQ,EMQ,
	   2508      .                BK_C2, BK_MQ,
	   2509      .                PHA_NQ,PHA_NM)			!return information
	   2510 
	   2511               	                  
	   2512 C

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  34
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2513 C Print out PHA data by word. There will thus be one row per PHA word, and no enties in the
	   2514 C table for voltage steps that have no PHA words.
	   2515 C
	   2516 
	   2517 	  IF ( (DATA_FILTER_RANGE.EQ.0)  .OR.
	   2518      .         (RANGE .EQ. 0 .AND. SEL_RANGE(0))  .OR.
	   2519      .         (RANGE .EQ. 1 .AND. SEL_RANGE(1))  .OR.
	   2520      .         (RANGE .EQ. 2 .AND. SEL_RANGE(2)) ) THEN
	   2521 
	   2522 	      IF ( (DATA_FILTER_COINC.EQ.0)  .OR. 
	   2523      .         (DATA_FILTER_COINC.EQ.1 .AND. DPU_MASS.EQ.0.)  .OR.
	   2524      .         (DATA_FILTER_COINC.EQ.2 .AND. DPU_MASS.GT.0.) ) THEN
	   2525 
	   2526               IF ( (DIRECTION_FILTER.EQ.0)               .OR.
	   2527      .            (( (DIRECTION_FILTER_SSD.LT.0) .OR.
	   2528      .               (DIRECTION_FILTER_SSD.EQ.SSD_ID)  ) .AND.
	   2529      .             ( (DIRECTION_FILTER_STOP.LT.0) .OR.
	   2530      .               (DIRECTION_FILTER_STOP.EQ.STOP_ID)) .AND.
	   2531      .             ( (DIRECTION_FILTER_START.LT.0) .OR.
	   2532      .               (DIRECTION_FILTER_START.EQ.PSTART)) ) ) THEN
	   2533 
	   2534 	      IF ( 
	   2535      .              (  DATA_FILTER_RANGECHECK.EQ.0 .OR.
	   2536      .                (DATA_FILTER_RANGECHECK.EQ.1 .AND.	! range OK
	   2537      .                       RANGE.EQ.DPU_RANGE)  )
	   2538      .                .AND.
	   2539      .              (  DIRECTION_CHECK.EQ.0 .OR.
	   2540      .                (DIRECTION_CHECK.EQ.1 .AND. TELE_FLAG.EQ.0)  ) ! telescope OK
	   2541      .                ) THEN	         
	   2542                IF (TABLE_FORMAT.GT.0) WRITE(50,250) L1_SR_HEADER.SR_COUNT,RATEFLAG,
	   2543      &			    TIME_TO_USE.YEAR,TIME_TO_USE.DOY,
	   2544      &                      TIME_TO_USE.HR,TIME_TO_USE.MIN,TIME_TO_USE.SEC,
	   2545      &                      DVSTEP,
	   2546      &                      DPU_E_OVER_Q,
	   2547      &                      STOP_ID,
	   2548      &                      START_ID_RANGE,
	   2549      &                      ENERGY,
	   2550      &                      SECTOR,
	   2551      &                      SSD_ID,
	   2552      &                      TIME_OF_FLIGHT,
	   2553      &                      PSTART,
	   2554      &                      RANGE,
	   2555      &                      SW_SPEED,
	   2556      &                      DPU_MASS_OVER_Q,
	   2557      &                      DPU_MASS,
	   2558      &                      DPU_NM,
	   2559      &                      DPU_NQ,
	   2560      &                      DPU_RANGE,
	   2561      &                      BASIC_RATE_OMNI(RANGE),
	   2562      &                      BR_OMNI_SUMMED
	   2563  250           FORMAT(1X,I8,2X,A1,  !sr counter, bit rate
	   2564      .                2X,I4,2X,I3.3,2X,I2,':',I2.2,':',I2.2,  	! time
	   2565      &             2X,I2,2X,F7.2,5X,I2,7X,I2,5X,I3,5X,I2,4X,	!dvstep,e/q,stop,start,E,sec,
	   2566      &             I2,2X,I4,7X,I1,5X,I1,			!ssd,tof,pstart,range
	   2567      &             3X,F6.1,F6.2,3X,F5.1,3X,I2,2X,I3,3X,I2,   !sw speed, 
	   2568 C								m/q,m,derived nm,nq,range
	   2569      &             2X,I5,'/',I5)					!basic rate (range)

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  35
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2570 
	   2571 C
	   2572 C Increment NQNM arrays
	   2573 C
	   2574 	       IF (PHA_NQ.GE.0  .AND.  PHA_NM.GE.0) THEN
	   2575 
	   2576 	          CALL SPECIES_IDENTIFIER( USER_NM_MID(PHA_NM), 
	   2577      .					USER_NQ_MID(PHA_NQ) , 
	   2578      .				        SPECIES_MASS,SPECIES_CHARGE)
	   2579 	          SPECIES_ENERGY = SPECIES_CHARGE * DPU_D1_EQ * (DPU_D2_EQ**DVSTEP)
	   2580 		  ENERGY_BANDWIDTH = 0.019*SPECIES_ENERGY
	   2581 	          CALL WSTICSEFF(SPECIES_ENERGY, SPECIES_MASS, 
	   2582      .                        DCR_RSR,TCR_FSR,DCR_FSR)
	   2583 	          IF (PHA_NM .NE. 0) THEN
	   2584 		       EFF_VS_MMQ = TCR_FSR * DCR_RSR * ENERGY_BANDWIDTH
	   2585 	          ELSE
	   2586 		       EFF_VS_MMQ = DCR_FSR * DCR_RSR * ENERGY_BANDWIDTH	
	   2587 	          ENDIF
	   2588 
	   2589 C                 check against zero efficiency
	   2590 		  IF (EFF_VS_MMQ .EQ. 0.) THEN
	   2591 	              EFF_VS_MMQ = DCR_FSR * DCR_RSR * ENERGY_BANDWIDTH
	   2592 		      IF (EFF_VS_MMQ .EQ. 0.) EFF_VS_MMQ = 1.0E-6
	   2593 	              EFF_HITS = EFF_HITS + 1
	   2594 		  END IF
	   2595 
	   2596 C				*******************
	   2597 C				*   OMNI ARRAYS   *
	   2598 C				*******************
	   2599 
	   2600 C               omnidirectional, all ranges together, 
	   2601 C		corrected for basic rate (sector,range),by each readout
	   2602      	        OMNI_NQNM(PHA_NQ,PHA_NM) = OMNI_NQNM(PHA_NQ,PHA_NM) + 
	   2603      .               1.*( BASIC_W(ISECT,RANGE)/EFF_VS_MMQ )
	   2604 
	   2605 C				*******************
	   2606 C				*   SOLAR ARRAYS  *
	   2607 C				*******************
	   2608 
	   2609 C		solar direction event matrix:
	   2610 		IF (ISECT.EQ.5 .AND. TELE_IDENT.EQ.2) THEN       !solar wind direction
	   2611 
	   2612 C		 corrected for basic rate (sector,range),by each readout
	   2613                  SUN_NQNM(PHA_NQ,PHA_NM) = SUN_NQNM(PHA_NQ,PHA_NM) + 
	   2614      .               1.*( BASIC_W(ISECT,RANGE)/EFF_VS_MMQ )
	   2615 
	   2616 C		 accumulate for later correction
	   2617 		 SUN1_NQNM_VS_R(DVSTEP,PHA_NQ,PHA_NM,RANGE) = 
	   2618      .		      SUN1_NQNM_VS_R(DVSTEP,PHA_NQ,PHA_NM,RANGE) + 1
	   2619 
	   2620 		ELSE IF (ISECT.EQ.6 .AND. TELE_IDENT.EQ.2) THEN  !solar wind direction
	   2621 
	   2622 C		 corrected for basic rate (sector,range),by each readout
	   2623                  SUN_NQNM(PHA_NQ,PHA_NM) = SUN_NQNM(PHA_NQ,PHA_NM) + 
	   2624      .               1.*( BASIC_W(ISECT,RANGE)/EFF_VS_MMQ )
	   2625 
	   2626 C		 accumulate for later correction

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  36
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2627 		 SUN2_NQNM_VS_R(DVSTEP,PHA_NQ,PHA_NM,RANGE) = 
	   2628      .				SUN2_NQNM_VS_R(DVSTEP,PHA_NQ,PHA_NM,RANGE) + 1
	   2629 
	   2630                 END IF
	   2631                END IF
	   2632 
	   2633 
	   2634 C				**********************
	   2635 C				*   DPU-RAW ARRAYS   *
	   2636 C				**********************
	   2637 
	   2638 C	       omnidirectional, all ranges, no corrections, dpu defaults used
	   2639 	       IF (DPU_NQ.GE.0  .AND.  DPU_NM.GE.0) THEN
	   2640 		   DPU_NQNM(DPU_NQ,DPU_NM) = DPU_NQNM(DPU_NQ,DPU_NM) + 1
	   2641                ENDIF
	   2642 		
	   2643 
	   2644               ENDIF     !check range and/or telescope conditions
	   2645               ENDIF     !data filtering by direction 
	   2646               ENDIF	!data_filtering by coincidence conditions
	   2647               ENDIF     !data filtering by range
	   2648 
	   2649  300        CONTINUE		!end pha for this given voltage step
	   2650 
	   2651           ENDIF   ! data within user selected voltage step range
	   2652 
	   2653         ENDIF     ! data within user selected time
	   2654 
	   2655  800  CONTINUE
	   2656 
	   2657 C
	   2658 C Read next Science Record
	   2659 C
	   2660       CALL WIND_L1_READ_SR( L1_LUN, CNTR, L1_SR_HEADER, STATUS )
	   2661       IF(STATUS.EQ.RMS$_EOF)GO TO 900
	   2662       IF (STATUS .NE. 1) GOTO 9020
	   2663 C
	   2664       GO TO 100
	   2665 C
	   2666 C Close files and STOP
	   2667 C
	   2668  900  IF (START.YEAR .GE. 0) GO TO 1000
	   2669  901  CALL WIND_L1_CLOSE( L1_LUN, STATUS )      ! Close input file
	   2670       IF (STATUS .NE. 1) GOTO 9090
	   2671       IF (TABLE_FORMAT.GT.0) CLOSE(UNIT=50)                            ! Close PHA TABLE file
	   2672 
	   2673       DO JJ = 1,IFILE
	   2674         WRITE(55,16) INPUTFILES(JJ)
	   2675         WRITE(57,16) INPUTFILES(JJ)
	   2676       END DO              
	   2677 
	   2678 
	   2679 
	   2680        CALL WEIGHT_FACTORS_VS( PHA_SECT,PHA_OMNI,  		!input
	   2681      .      BR_SECT,BR_OMNI,
	   2682      .      BR_SECT_WEIGHT,BR_OMNI_WEIGHT)			!return
	   2683 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  37
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2684 C      sun-direction binning
	   2685        DO ISTEP = 0,31		!voltage step
	   2686            DO INQ = 0,NQ_MAX+1	!Nq
	   2687              DO INM = 0,NM_MAX	!Nm
	   2688                DO MM = 0,2
	   2689 
	   2690 		IF( SUN1_NQNM_VS_R(ISTEP,INQ,INM,MM).NE.0 .OR.
	   2691      .		    SUN2_NQNM_VS_R(ISTEP,INQ,INM,MM).NE.0) THEN
	   2692 		
	   2693 	           CALL SPECIES_IDENTIFIER( USER_NM_MID(INM), 
	   2694      .					    USER_NQ_MID(INQ) , 
	   2695      .				            SPECIES_MASS,SPECIES_CHARGE)
	   2696 	           SPECIES_ENERGY = SPECIES_CHARGE * DPU_D1_EQ * (DPU_D2_EQ**ISTEP)
	   2697                    ENERGY_BANDWIDTH = 0.019 * SPECIES_ENERGY
	   2698 	           CALL WSTICSEFF(SPECIES_ENERGY, SPECIES_MASS, 
	   2699      .                        DCR_RSR,TCR_FSR,DCR_FSR)
	   2700 	           IF (INM .NE. 0) THEN
	   2701 		       EFF_VS_MMQ = TCR_FSR * DCR_RSR * ENERGY_BANDWIDTH
	   2702 	           ELSE
	   2703 		       EFF_VS_MMQ = DCR_FSR * DCR_RSR * ENERGY_BANDWIDTH
	   2704 	           ENDIF
	   2705 
	   2706 C                 check against zero efficiency
	   2707 		  IF (EFF_VS_MMQ .EQ. 0.) THEN
	   2708 	              EFF_VS_MMQ = DCR_FSR * DCR_RSR * ENERGY_BANDWIDTH
	   2709 		      IF (EFF_VS_MMQ .EQ. 0.) EFF_VS_MMQ = 1.0E-6
	   2710 		  END IF
	   2711 
	   2712                    SUN_EFF_NQNM(INQ,INM) = SUN_EFF_NQNM(INQ,INM) + 
	   2713      .               SUN1_NQNM_VS_R(ISTEP,INQ,INM,MM) * BR_SECT_WEIGHT(5,ISTEP,MM) 
	   2714      .						   / EFF_VS_MMQ
	   2715      .	              +
	   2716      . 		     SUN2_NQNM_VS_R(ISTEP,INQ,INM,MM) * BR_SECT_WEIGHT(6,ISTEP,MM)
	   2717      .						  / EFF_VS_MMQ
	   2718 		ENDIF
	   2719 
	   2720                END DO
	   2721              END DO
	   2722           END DO
	   2723        END DO
	   2724 
	   2725 
	   2726 C   **********************************************************
	   2727 C   *							     *
	   2728 C   *			WRITE TO                             *
	   2729 C   *                   OUTPUT matrix FILE		     *
	   2730 C   *							     *
	   2731 C   **********************************************************
	   2732       IF (NQ_MAX .EQ. -1) NQ_MAX = 126
	   2733       IF (NM_MAX .EQ. -1) NM_MAX = 59
	   2734 
	   2735       OMNI_MAX    = 0.
	   2736       SUN_MAX     = 0.
	   2737       SUN_EFF_MAX = 0.
	   2738       DO I = 1,NQ_MAX+1
	   2739          DO J = 1,NM_MAX+4
	   2740 	 	IF (OMNI_NQNM(I,J) .GT. OMNI_MAX) OMNI_MAX = OMNI_NQNM(I,J)

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  38
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2741 	 	IF (SUN_NQNM(I,J)  .GT.  SUN_MAX)  SUN_MAX = SUN_NQNM(I,J)
	   2742 	 	IF (SUN_EFF_NQNM(I,J) .GT. SUN_EFF_MAX) SUN_EFF_MAX = SUN_EFF_NQNM(I,J)
	   2743          END DO
	   2744       END DO
	   2745 
	   2746       OMNI_SCALE = OMNI_MAX / 9999.
	   2747            IF (OMNI_SCALE .LE. 1.) THEN
	   2748 	     OMNI_SCALE = 1.0
	   2749            ELSE
	   2750 	     OMNI_SCALE = IFIX(OMNI_SCALE) + 1.
	   2751 	   END IF
	   2752 
	   2753       SUN _SCALE = SUN _MAX / 9999.
	   2754            IF (SUN_SCALE .LE. 1.) THEN
	   2755 	     SUN_SCALE = 1.0
	   2756            ELSE
	   2757 	     SUN_SCALE = IFIX(SUN_SCALE) + 1.
	   2758 	   END IF
	   2759 
	   2760       SUN_EFF_SCALE = SUN_EFF_MAX / 9999.
	   2761            IF (SUN_EFF_SCALE .LE. 1.) THEN
	   2762 	     SUN_EFF_SCALE = 1.0
	   2763            ELSE
	   2764 	     SUN_EFF_SCALE = IFIX(SUN_EFF_SCALE) + 1.
	   2765 	   END IF
	   2766 
	   2767       DO I = 0,NQ_MAX+1
	   2768          DO J = 0,NM_MAX+4
	   2769 
	   2770 	     OMNI_NQNM(I,J) = OMNI_NQNM(I,J) / OMNI_SCALE
	   2771              IF(J.NE.0) ENCODE(5,356,OMNI_CNQNM(I,J)) OMNI_NQNM(I,J)
	   2772              IF(OMNI_NQNM(I,J) .EQ. 0) OMNI_CNQNM(I,J) = '     '
	   2773 
	   2774 	     SUN_NQNM(I,J) = SUN_NQNM(I,J) / SUN_SCALE
	   2775              IF(J.NE.0) ENCODE(5,356,SUN_CNQNM(I,J)) SUN_NQNM(I,J)
	   2776              IF(SUN_NQNM(I,J) .EQ. 0) SUN_CNQNM(I,J) = '     '
	   2777 
	   2778 	     SUN_EFF_NQNM(I,J) = SUN_EFF_NQNM(I,J) / SUN_EFF_SCALE
	   2779              IF(J.NE.0) ENCODE(5,356,SUN_EFF_CNQNM(I,J)) SUN_EFF_NQNM(I,J)
	   2780              IF(SUN_EFF_NQNM(I,J) .EQ. 0) SUN_EFF_CNQNM(I,J) = '     '
	   2781 
	   2782          END DO
	   2783       END DO
	   2784 
	   2785   355        FORMAT(I5)
	   2786   356        FORMAT(F5.0)
	   2787 
	   2788 C print out matrices
	   2789   365 FORMAT(/,'  NQ ::       NM = ',/
	   2790      .              '  ||       '200(1X,I5))
	   2791   366 FORMAT(1X ,   '           '200(F6.2)/)
	   2792   367 FORMAT(/,'  NQ ::       NM = ',/
	   2793      .              '  ||       '16(1X,I5),5X,'Fe SUM Nm=49-56')
	   2794   368 FORMAT(1X ,   '           '16(F6.2),5X, '  38.45-79.28'/)
	   2795   370 FORMAT (1X,I3,1X,F5.2,F8.0,199(1X,A5))
	   2796   371 FORMAT (1X,I3,1X,F5.2,I8,199(1X,A5))
	   2797   372 FORMAT (1X,I3,1X,F5.2,I8,15(1X,A5),5X,F10.2)

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  39
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2798   375 FORMAT (1H1,1X,' BASIC RATE + EFF CORRECTED AT EACH VOLTAGE STEP AND ALL SECTORS '/
	   2799      .            1X,' SCALE FACTOR = ' F5.2, ' EFFICIENCY HITS = 'I7)
	   2800   376 FORMAT (1H1,1X,' BASIC RATE + EFF CORRECTED AT EACH VOLTAGE STEP - SUN SECTORS '/
	   2801      .            1X,' SCALE FACTOR = ' F5.2, ' EFFICIENCY HITS = 'I7)
	   2802   373 FORMAT (1H1,1X,' BASIC RATE + EFF CORRECTED AT END OF ACCUMULATION - SUN SECTORS '/
	   2803      .            1X,' SCALE FACTOR = ' F5.2)
	   2804   374 FORMAT (1H1,1X,' RAW DATA - DPU ALGORITHMS AND DPU BINNING USED '/
	   2805      .            1X,' SCALE FACTOR  = ' F5.2)
	   2806 
	   2807 C unit 55 is concentrated on heavy ion range + mass zero
	   2808 
	   2809       WRITE(55,375) OMNI_SCALE, EFF_HITS
	   2810       WRITE(55,365) (J, J=0,0),(II, II=33,NM_MAX)
	   2811       WRITE(55,366) USER_NM_M(0),(USER_NM_M(MM), MM=33,NM_MAX)
	   2812       DO I = 11,82
	   2813          WRITE(55,370) I,USER_NQ_MPQ(I),OMNI_NQNM(I,0),
	   2814      .                                (OMNI_CNQNM(I,K), K=33,NM_MAX)
	   2815       END DO
	   2816 
	   2817       WRITE(55,376) SUN_SCALE, EFF_HITS
	   2818       WRITE(55,365) (J, J=0,0),(II, II=33,NM_MAX)
	   2819       WRITE(55,366) USER_NM_M(0),(USER_NM_M(MM), MM=33,NM_MAX)
	   2820       DO I = 11,82
	   2821          WRITE(55,370) I,USER_NQ_MPQ(I),SUN_NQNM(I,0),
	   2822      .                                (SUN_CNQNM(I,K), K=33,NM_MAX)
	   2823       END DO
	   2824 
	   2825       WRITE(55,373) SUN_EFF_SCALE
	   2826       WRITE(55,365) (J, J=0,0),(II, II=33,NM_MAX)
	   2827       WRITE(55,366) USER_NM_M(0),(USER_NM_M(MM), MM=33,NM_MAX)
	   2828       DO I = 11,82
	   2829          WRITE(55,370) I,USER_NQ_MPQ(I),SUN_EFF_NQNM(I,0),
	   2830      .                                (SUN_EFF_CNQNM(I,K), K=33,NM_MAX)
	   2831       END DO
	   2832 
	   2833 
	   2834 
	   2835 
	   2836 C DPU VALUES
	   2837 
	   2838       DPU_MAX = 0.
	   2839       DO I = 0,127
	   2840          DO J = 1,63	!exclude mass zero for finding max
	   2841 	 	IF (DPU_NQNM(I,J) .GT. DPU_MAX) DPU_MAX = DPU_NQNM(I,J)
	   2842          END DO
	   2843       END DO
	   2844 
	   2845       DPU_SCALE = DPU_MAX / 9999.
	   2846       IF (DPU_SCALE .LE. 1.) THEN
	   2847 	 DPU_SCALE = 1.0
	   2848       ELSE
	   2849 	 DPU_SCALE = IFIX(DPU_SCALE) + 1.
	   2850       END IF
	   2851 
	   2852       DO I = 0,127
	   2853          DO J = 0,63
	   2854 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  40
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2855 	     DPU_NQNM(I,J) = FLOAT(DPU_NQNM(I,J)) / DPU_SCALE
	   2856              IF(J.NE.0) ENCODE(5,355,DPU_CNQNM(I,J)) DPU_NQNM(I,J)
	   2857              IF(DPU_NQNM(I,J) .EQ. 0) DPU_CNQNM(I,J) = '     '
	   2858 
	   2859          END DO
	   2860       END DO
	   2861 
	   2862 C unit 56 is the entire matrix - based on dpu values
	   2863 
	   2864       WRITE(56,374) DPU_SCALE
	   2865       WRITE(56,365) (J, J=0,63)
	   2866       WRITE(56,366) (DPU_NM_M(K), K=0,59)
	   2867 
	   2868       DO I = 0,127
	   2869          WRITE(56,371) I,DPU_NQ_MPQ(I),DPU_NQNM(I,0),
	   2870      .            (DPU_CNQNM(I,K), K=1,63)
	   2871       END DO
	   2872 
	   2873 
	   2874 C unit 57 is concentrated on iron ion range + mass zero
	   2875 
	   2876       WRITE(57,376) SUN_SCALE, EFF_HITS
	   2877       WRITE(57,365) (J, J=0,0),(II, II=45,NM_MAX)
	   2878       WRITE(57,366) USER_NM_M(0),(USER_NM_M(MM), MM=45,NM_MAX)
	   2879 
	   2880       DO I = 30,82
	   2881          SUM_FE = 0.
	   2882 	 DO KK = 49,56
	   2883 	   SUM_FE = SUM_FE + SUN_NQNM(I,KK)*SUN_SCALE
	   2884          END DO
	   2885          WRITE(57,372) I,USER_NQ_MPQ(I),IFIX(SUN_NQNM(I,0)),
	   2886      .               (SUN_CNQNM(I,K), K=45,NM_MAX), SUM_FE
	   2887       END DO
	   2888       
	   2889       WRITE(57,373) SUN_EFF_SCALE
	   2890       WRITE(57,365) (J, J=0,0),(II, II=45,NM_MAX)
	   2891       WRITE(57,366) USER_NM_M(0),(USER_NM_M(MM), MM=45,NM_MAX)
	   2892       DO I = 30,82
	   2893          SUM_FE = 0.
	   2894 	 DO KK = 49,56
	   2895 	   SUM_FE = SUM_FE + SUN_EFF_NQNM(I,KK)*SUN_EFF_SCALE
	   2896          END DO
	   2897          WRITE(57,372) I,USER_NQ_MPQ(I),IFIX(SUN_EFF_NQNM(I,0)),
	   2898      .               (SUN_EFF_CNQNM(I,K), K=45,NM_MAX),SUM_FE
	   2899       END DO
	   2900 
	   2901       WRITE(57,374) DPU_SCALE
	   2902       WRITE(57,365) (J, J=0,0),(II, II=45,NM_MAX)
	   2903       WRITE(57,366) DPU_NM_M(0),(DPU_NM_M(MM), MM=45,NM_MAX)
	   2904       DO I = 30,82
	   2905          SUM_FE = 0.
	   2906 	 DO KK = 49,56
	   2907 	   SUM_FE = SUM_FE + FLOAT(DPU_NQNM(I,KK))*DPU_SCALE
	   2908          END DO
	   2909          WRITE(57,372) I,DPU_NQ_MPQ(I),DPU_NQNM(I,0),
	   2910      .            (DPU_CNQNM(I,K), K=45,59),SUM_FE
	   2911       END DO

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  41
                                                                17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2912 
	   2913 C     ***********************************************************
	   2914 C     *								*
	   2915 C     *			CLOSE FILES				*
	   2916 C     ***********************************************************
	   2917 
	   2918       CLOSE(UNIT=55)				! Close PHA MATRIX file
	   2919       CLOSE(UNIT=56)                            ! Close "DPU MATRIX" file
	   2920       CLOSE(UNIT=57)				! Close Iron file
	   2921 
	   2922       TYPE *,' FILE WRITTEN TO  "STICS_TABLE:"'
	   2923 
	   2924       STOP
	   2925 
	   2926 
	   2927 
	   2928 C
	   2929 C Come here for errors
	   2930 C
	   2931 9010  TYPE *,'ERROR OPENING L1 FILE; STATUS=',STATUS
	   2932       STOP
	   2933 9020  TYPE *,'ERROR READING SCIENCE RECORD ',CNTR,'; STATUS=',STATUS
	   2934       STOP
	   2935 9030  TYPE *,'ERROR GETTING BASIC CORE; STATUS=',STATUS
	   2936       STOP
	   2937 9050  TYPE *,'ERROR GETTING HDB; STATUS=',STATUS
	   2938       STOP
	   2939 9080  TYPE *,'ERROR GETTING STICS DATA; STATUS=',STATUS
	   2940       STOP
	   2941 9085  TYPE *,'ERROR GETTING MASS DATA; STATUS=',STATUS
	   2942       STOP
	   2943 
	   2944 9090  TYPE *,'ERROR CLOSING L1 FILE; STATUS=',STATUS
	   2945       STOP
	   2946       END

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  42
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75



PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 496 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                             48311156 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT *32
  3 $IODATA$                              4988 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                               36688   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                2098 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 LIB$INITIALIZE                           4 NOPIC CON REL GBL NOSHR NOEXE   RD NOWRT LONG
  7 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated             48356074


ENTRY POINTS

    Address   Type  Name             
                                     
  4-00000000        STICS_FLUX_MATRIX


VARIABLES

    Address   Type  Name                       Address   Type  Name                       Address   Type  Name                  
                                                                                                                                
  2-000000F4  R*4   AVE_SPEED                0-000000A8  I*4   DIRECTION_FILTER_SSD     0-00000054# R*4   DPU_SCALE             
REG-0000000C  L*1   BITRATE                  0-000000A0  I*4   DIRECTION_FILTER_START   0-000000D0  R*4   DPU_THIGH             
  0-00000088  I*4   BK_C2                    0-000000A4  I*4   DIRECTION_FILTER_STOP    0-000000CC  R*4   DPU_TLOW              
      **      R*4   BK_MQ                    0-000000FC  I*4   DPPSMINUS                0-00000078  I*4   DVSTEP                
  2-00000084# L*4   BRACK                    0-000000F8  I*4   DPPSPLUS                 1-00000044  R*4   EFF                   
  0-0000004C  I*4   BR_OMNI_SUMMED               **      I*4   DPU_BK_C2                0-00000048  I*4   EFF_HITS              
      **      R*4   C1_EQ                    0-000000B8  R*4   DPU_BK_MQ              REG-########  R*4   EFF_VS_MMQ            
      **      R*4   C2A_EQ                   0-000000AC  R*4   DPU_C1_EQ                    **      R*4   EHIGH                 
      **      R*4   C2B_EQ                   0-000000B0  R*4   DPU_C2A_EQ                   **      R*4   ELOW                  
  2-00000114  I*4   CNTR                     0-000000B4  R*4   DPU_C2B_EQ               2-00000098  I*4   ENDDAYOFMONTH         
  0-00000100  L*4   CODE_C1                  0-000000BC  R*4   DPU_D1_EQ              REG-00000000  L*4   ENDFOUND              
      **      L*4   CODE_C2                  0-000000C0  R*4   DPU_D2_EQ                2-00000094  I*4   ENDMONTH              
      **      R*4   D1_EQ                    0-000000C8  R*4   DPU_EHIGH                2-000000C8  I*4   ENERGY                
      **      R*4   D2_EQ                    0-000000C4  R*4   DPU_ELOW               REG-########  R*4   ENERGY_BANDWIDTH      
  0-00000094  I*4   DATA_DVSTEP_MAX          2-0000009C  R*4   DPU_E_OVER_Q             2-00000038  CHAR  FIFO                  
  0-00000090  I*4   DATA_DVSTEP_MIN          0-000000D4  R*4   DPU_KM                   0-0000008C  L*4   FIRSTFILE             
      **      I*4   DATA_FILTER              0-000000D8  R*4   DPU_KQ                   2-02D0DFB0  CHAR  FULL_L1_NAME          
  0-00000074  I*4   DATA_FILTER_COINC        2-000000A0  R*4   DPU_MASS               REG-########  L*4   GOODSPIN              
  0-0000008C  I*4   DATA_FILTER_DVSTEP       2-000000A4  R*4   DPU_MASS_OVER_Q          2-00000100  R*4   HE2_SPEED             
  0-00000068  I*4   DATA_FILTER_MSPEED     REG-00000024  R*4   DPU_MAX                  2-00000104  R*4   HE2_UNCER             
  0-00000070  I*4   DATA_FILTER_RANGE            **      R*4   DPU_MMAX                 2-000000F8  R*4   H_SPEED               
  0-0000006C  I*4   DATA_FILTER_RANGECHECK       **      R*4   DPU_MMIN                 2-000000FC  R*4   H_UNCER               
  0-00000098  I*4   DATA_MSPEED_MAX              **      R*4   DPU_MQMAX                0-00000040# I*4   I                     
  0-0000009C  I*4   DATA_MSPEED_MIN        REG-00000025  R*4   DPU_MQMIN                2-00000080  I*4   IFILE                 
  2-00000090  I*4   DAYOFMONTH               2-000000AC  I*4   DPU_NM                   0-0000003C# I*4   II                    
  2-000000F0  R*4   DCR_FSR                      **      I*4   DPU_NM_MAX             REG-0000000F  I*4   INCREMENT             
  2-000000E8  R*4   DCR_RSR                  2-000000B0  I*4   DPU_NQ                 REG-########  I*4   INM                   
      **      I*4   DIRECTION_CHECK              **      I*4   DPU_NQ_MAX             REG-########  I*4   INQ                   
      **      I*4   DIRECTION_FILTER         2-000000A8  I*4   DPU_RANGE                2-000000E0  I*4   ISECT                 

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  43
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

    Address   Type  Name                       Address   Type  Name                       Address   Type  Name                  
                                                                                                                                
  0-0000007C# I*4   ISTEP                    0-00000084  I*4   NQ_MAX                   2-0000010C  R*4   SUM_HE2_SPEED         
  2-000000E4  I*4   ISUN                   REG-0000002C  R*4   OMNI_MAX               REG-0000002E  R*4   SUN_EFF_MAX           
REG-########  I*4   ITEMP                    0-00000060# R*4   OMNI_SCALE               0-00000058# R*4   SUN_EFF_SCALE         
REG-0000001A  I*4   ITEMP2                   0-000000DC  I*4   OPENMODE               REG-0000002D  R*4   SUN_MAX               
  0-00000038# I*4   J                        2-02D10180  CHAR  OUTDPUFILE               0-0000005C# R*4   SUN_SCALE             
REG-0000000C  I*4   JJ                       2-02D100C0  CHAR  OUTFILENAME1             0-00000044  R*4   SW_SPEED              
REG-00000017  I*4   JSAVE                    2-02D10120  CHAR  OUTFILENAME2             0-0000007C  I*4   TABLE_FORMAT          
REG-########  I*4   K                        2-02D101E0  CHAR  OUTFILENAME3             2-000000EC  R*4   TCR_FSR               
REG-########  I*4   KK                     REG-########  I*4   OUTUNIT                REG-00000008  I*4   TELE_FLAG             
  2-00000110  I*4   L                        2-000000B4  I*4   PHA_NM                 REG-00000004  I*4   TELE_IDENT            
  2-02D0DF60  CHAR  L1FILENAME             REG-00000009  I*4   PHA_NQ                   2-00000040  CHAR  TGS                   
  1-00000040  I*4   L1_LUN                   2-000000D8  I*4   PSTART                       **      R*4   THIGH                 
  2-02D0FF40  CHAR  LISFIL1                  2-000000DC  I*4   RANGE                    2-000000D4  I*4   TIME_OF_FLIGHT        
  2-02D0FFA0  CHAR  LISFIL2                  2-00000048  CHAR  RATEFLAG                     **      R*4   TLOW                  
  2-02D10000  CHAR  LISFIL3                REG-00000029  R*4   RKM                      2-00000058  CHAR  TONOFF                
  2-02D10060  CHAR  LISFIL4                REG-00000028  R*4   RKQ                    REG-0000000C  I*4   TRIGGER_MODE_CODE     
      **      I*4   MATRIX_FORMAT            2-00000050  CHAR  RONOFF                   2-00000118  CHAR  USERNAME1             
REG-########  I*4   MM                       2-000000CC  I*4   SECTOR                   2-00000140  CHAR  USERNAME2             
REG-0000002C  R*4   MMAX                     2-000000BC  R*4   SPECIES_CHARGE               **      R*4   USER_MMAX             
REG-00000026  R*4   MMIN                     0-00000064# R*4   SPECIES_ENERGY               **      R*4   USER_MMIN             
  2-00000168  CHAR  MODE_AT_START            2-000000B8  R*4   SPECIES_MASS                 **      R*4   USER_MQMAX            
  2-0000008C  I*4   MONTH                    2-00000108  R*4   SPEED_HITS                   **      R*4   USER_MQMIN            
REG-0000002D  R*4   MQMAX                    2-000000D0  I*4   SSD_ID                       **      I*4   USER_NM_MAX           
REG-00000027  R*4   MQMIN                  REG-00000003  I*4   STANDARD                     **      I*4   USER_NQ_MAX           
REG-########  I*4   N                        0-000000F4  L*4   STARTFOUND                   **      L*4   USE_SC_CLOCK          
REG-0000000D  I*4   NAMELEN                  2-000000C0  I*4   START_ID_RANGE           2-00000060  CHAR  YORN                  
REG-00000001  I*4   NINDEX                   2-00000088  I*4   STATUS                                                           
  0-00000080  I*4   NM_MAX                   2-000000C4  I*4   STOP_ID                                                          
REG-########  I*4   NN                       0-00000050# R*4   SUM_FE                                                           


RECORDS

    Address   Name            Structure                Bytes     Address   Name            Structure                Bytes
                                                                                                                         
  2-00000070  END             T                            8   2-02DF9100  SCI             CORE                      7384
  2-02DFADD8  HDB             HDBSTR                     324   2-00000068  START           T                            8
  7-00000000  L1_FILE_HEADER  ST_L1_FILE_HEADER          400   2-02DFDA40  STICS_PHA       ST_PHA                   36720
  7-00000190  L1_SR_HEADER    ST_L1_SR_HEADER            244   2-02DFAF20  STICS_RATE      ST_RATE                  11040
  2-02E07130  MASS_PHA        MA_PHA                   45960   2-00000078  TIME_TO_USE     T                            8
  2-02E069B0  MASS_RATE       MA_RATE                   1920                                                             


ARRAYS

     Address  Type  Name                   Bytes  Dimensions

  2-000001C8  R*4   AM                        24  (6)
  2-02E12934  I*4   BASIC_PHA                 96  (8, 0:2)
  2-00000210  I*4   BASIC_PHA_OMNI            12  (0:2)
  2-02E12754  I*4   BASIC_RATE                96  (8, 0:2)
  2-00000204  I*4   BASIC_RATE_OMNI           12  (0:2)
  2-02E12994  R*4   BASIC_W                   96  (8, 0:2)
  2-000001E0  R*4   BM                        24  (6)
  2-02E125D4  I*4   BR_OMNI                  384  (0:31, 0:2)

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  44
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

  2-02E129F4  R*4   BR_OMNI_WEIGHT           384  (0:31, 0:2)
  2-02D0BB60  I*4   BR_SECT                 3072  (8, 0:31, 0:2)
  2-02D0D360  R*4   BR_SECT_WEIGHT          3072  (8, 0:31, 0:2)
  1-00000048  CHAR  COINC                     30  (0:2)
  2-0000018C  R*4   DPU_AM                    24  (6)
  2-000001A4  R*4   DPU_BM                    24  (6)
  2-02D10240  CHAR  DPU_CNQNM              46505  (0:130, 0:70)
  2-000001BC  R*4   DPU_EMQ                   12  (3)
  2-02E124B8  R*4   DPU_NM_M                 284  (0:70)
  2-00000430  I*4   DPU_NQNM               37204  (0:130, 0:70)
  2-00000220  R*4   DPU_NQ_MPQ               524  (0:130)
  2-000001F8  R*4   EMQ                       12  (3)
  2-02D0E000  CHAR  INPUTFILES              8000  (100)
  1-00000090  CHAR  MODE                     170  (10)
  2-02D1B7F0  CHAR  OMNI_CNQNM            302505  (0:300, 0:200)
  2-0000A570  R*4   OMNI_NQNM             242004  (0:300, 0:200)
  2-02E127B4  I*4   PHA_OMNI                 384  (0:31, 0:2)
  2-02D0C760  I*4   PHA_SECT                3072  (8, 0:31, 0:2)
  1-00000068  CHAR  RANGESEL                  35  (0:6)
  2-00000180  L*4   SEL_RANGE                 12  (0:2)
  2-02D0B890  I*4   STICS_RATES              716  (179)
  2-00080830  I*4   SUN1_NQNM_VS_R      23232384  (0:31, 0:300, 0:200, 0:2)
  2-016A87B0  I*4   SUN2_NQNM_VS_R      23232384  (0:31, 0:300, 0:200, 0:2)
  2-02D655A0  CHAR  SUN_CNQNM             302505  (0:300, 0:200)
  2-02DAF350  CHAR  SUN_EFF_CNQNM         302505  (0:300, 0:200)
  2-02CD0730  R*4   SUN_EFF_NQNM          242004  (0:300, 0:200)
  2-000456D0  R*4   SUN_NQNM              242004  (0:300, 0:200)
  1-00000140  CHAR  TRIGGER_MODE             176  (0:7)
  2-00009590  R*4   USER_NM_M                804  (0:200)
  2-00009D80  R*4   USER_NM_MID              804  (0:200)
  2-0000A0B0  R*4   USER_NQ_MID             1204  (0:300)
  2-000098C0  R*4   USER_NQ_MPQ             1204  (0:300)



LABELS

    Address   Label     Address   Label     Address   Label     Address   Label     Address   Label     Address   Label
                                                                                                                       
      **       2          **       14     4-00000000   220        **       368        **       481        **       9020
  4-000014B8   3          **       15     4-00000000   230        **       370        **       482        **       9030
      **       4          **       16         **       250        **       371        **       483        **       9050
      **       5          **       17     4-00004904   300        **       372    4-00004910   800        **       9080
      **       6          **       18         **       355        **       373        **       900        **       9085
      **       7          **       19         **       356        **       374        **       901        **       9090
      **       11     4-00002EA0   100        **       365        **       375    4-00001728   1000                    
      **       12         **       155        **       366        **       376        **       1001                    
      **       13         **       195        **       367        **       480        **       9010                    



STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  45
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

FUNCTIONS AND SUBROUTINES REFERENCED

  Type  Name                                Type  Name                                Type  Name                             
                                                                                                                             
        CNVRT_T_YRMONDAY_TO_YEARDAY               USER_NMNQ_COEFF                           WIND_L1_GET_MASS                 
  L*4   COMPARE_TIME_GE                           USER_NMNQ_PHA_BINNED                      WIND_L1_GET_STICS                
        DISSECT_STICS_PHA                         USER_REQUESTS_DATA_TYPE                   WIND_L1_OPEN                     
        DPU_DEFAULT_COEFF                         WEIGHT_FACTORS_VS                         WIND_L1_OPEN_NEXT                
        DPU_EQ                              I*4   WIND_DECOMPRESS                           WIND_L1_READ_SR                  
        MASS_SPEED                                WIND_GET_FILENAME                         WSTICSEFF                        
        MMPQ_DPU_WSTICS                           WIND_L1_CLOSE                                                              
        SPECIES_IDENTIFIER                        WIND_L1_GET_BASIC                                                          
        TELESCOPE_ID                              WIND_L1_GET_HDB                                                            

STICS_FLUX_MATRIX                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  46
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   2947 
	   2948 
	   2949 C	*************************************************
	   2950 C	*		SUBROUTINES			*
	   2951 C	*************************************************
	   2952 
	   2953 
	   2954 C***************************************************************************
	   2955 
	   2956       SUBROUTINE USER_REQUESTS_DATA_TYPE(
	   2957      .           FILTER_COINC,
	   2958      .           FILTER_DVSTEP,
	   2959      .		 DVSTEP_MIN,
	   2960      .		 DVSTEP_MAX,
	   2961      .           FILTER_RANGE,
	   2962      .           SRANGE,
	   2963      .           RANGECHECK,
	   2964      .           FILTER_SPEED,
	   2965      .           SPEED_MIN,
	   2966      .           SPEED_MAX)
	   2967 
	   2968 C     user inputs for data filtering by data type
	   2969 C     13.Jan.95  ABG
	   2970 C     17.Aug.95  add solar wind speed
	   2971 
	   2972 
	   2973       IMPLICIT NONE
	   2974 
	   2975 C     data filtering options
	   2976       INTEGER*4  FILTER_COINC,	!data filtering by coincidence 
	   2977 C					 conditions
	   2978      .           FILTER_DVSTEP,	!data filter by voltage step
	   2979      .           DVSTEP_MIN,	!dv step min-max values for data filter
	   2980      .           DVSTEP_MAX,
	   2981      .           FILTER_RANGE,   !range selection
	   2982      .           RANGECHECK,
	   2983      .           FILTER_SPEED,       !MASS derived solar wind speed selection
	   2984      .           SPEED_MIN, 
	   2985      .           SPEED_MAX
	   2986 
	   2987       LOGICAL SRANGE(0:2)			!accept / reject this range
	   2988       CHARACTER*5 RSELECTION(0:6) /		!range selection
	   2989      .                           '2 1 0' ,
	   2990      .                           '    0' ,
	   2991      .                           '  1  ' ,
	   2992      .                           '2    ' ,
	   2993      .                           '2   0' ,
	   2994      .                           '2 1  ' ,
	   2995      .                           '  1 0' /
	   2996 
	   2997       INTEGER*4  I,J,K
	   2998       CHARACTER*1 YORN			!yes or no answer
	   2999 
	   3000 
	   3001 
	   3002       TYPE 7
	   3003     7 FORMAT(' Enter desired data filtering ',

USER_REQUESTS_DATA_TYPE                                         17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  47
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3004      .       'by coincidence conditions: ',/,
	   3005      .       '   0 = no filtering (no M or M/Q restrictions) ',/,
	   3006      .       '   1 = M/Q-only     (i.e., M/Q > 0, Mass = 0) ',/,
	   3007      .       '   2 = M & M/Q      (i.e., M/Q > 0, Mass > 0) ',/,
	   3008      .       '       ',$)
	   3009       ACCEPT *, FILTER_COINC
	   3010 
	   3011       TYPE 8
	   3012     8 FORMAT(' Enter desired data filtering by voltage step range: ',/,
	   3013      .       '   -1 = no voltage step filtering (all e/q values) ',/,
	   3014      .       '    0 = voltage step filtering desired',/,
	   3015      .       '        ',$)
	   3016       ACCEPT *, FILTER_DVSTEP
	   3017       IF (FILTER_DVSTEP .GT. -1) THEN
	   3018          TYPE 9
	   3019     9    FORMAT(' Enter minimum and maximum voltage steps (inclusive)',/
	   3020      .          '     ',$)	  
	   3021 	 ACCEPT *, DVSTEP_MIN, DVSTEP_MAX
	   3022       ENDIF
	   3023 
	   3024       TYPE 10 , (RSELECTION(I),I=0,6)
	   3025    10 FORMAT(' Enter range selection: ',/,
	   3026      .       '    0 = ',A5,'  (i.e., all ranges) ',/,
	   3027      .       '    1 = ',A5,/,
	   3028      .       '    2 = ',A5,/,
	   3029      .       '    3 = ',A5,/,
	   3030      .       '    4 = ',A5,/,
	   3031      .       '    5 = ',A5,/,
	   3032      .       '    6 = ',A5 )
	   3033        ACCEPT *, FILTER_RANGE
	   3034        TYPE 11, RSELECTION(FILTER_RANGE)
	   3035    11  FORMAT (/' User selected the following ranges : 'A5/)
	   3036       SRANGE(0) = .FALSE.	!reject range 0 events
	   3037       SRANGE(1) = .FALSE.	!reject range 1 events
	   3038       SRANGE(2) = .FALSE.	!reject range 2 events
	   3039 
	   3040        IF (  (FILTER_RANGE.EQ.0) .OR. (FILTER_RANGE.EQ.1) .OR.
	   3041      .       (FILTER_RANGE.EQ.4) .OR. (FILTER_RANGE.EQ.6) )
	   3042      .		SRANGE(0) = .TRUE.
	   3043        IF (  (FILTER_RANGE.EQ.0) .OR. (FILTER_RANGE.EQ.2) .OR.
	   3044      .       (FILTER_RANGE.EQ.5) .OR. (FILTER_RANGE.EQ.6) )
	   3045      .		SRANGE(1) = .TRUE.
	   3046        IF (  (FILTER_RANGE.EQ.0) .OR. (FILTER_RANGE.EQ.3) .OR.
	   3047      .       (FILTER_RANGE.EQ.4) .OR. (FILTER_RANGE.EQ.5) )
	   3048      .		SRANGE(2) = .TRUE.
	   3049 
	   3050        TYPE 12
	   3051    12  FORMAT(' Do you want to limit the output to range checks? '
	   3052      .        '[y/n] ',$)
	   3053        ACCEPT 13, YORN
	   3054    13  FORMAT (A)
	   3055        IF (YORN.EQ.'Y' .OR. YORN.EQ.'y') RANGECHECK=1
	   3056 
	   3057        TYPE 15
	   3058    15  FORMAT(' Enter desired data filtering by solar wind speed range: ',/,
	   3059      .       '    -1 = no filtering by MASS speed ',/,
	   3060      .       '    0  = MASS speed filtering desired',/,

USER_REQUESTS_DATA_TYPE                                         17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  48
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3061      .       '        ',$)
	   3062       ACCEPT *, FILTER_SPEED
	   3063       IF (FILTER_SPEED .GT. -1) THEN
	   3064          TYPE 16
	   3065    16    FORMAT(' Enter minimum and maximum solar wind speed (inclusive)',/
	   3066      .          '     ',$)	  
	   3067 	 ACCEPT *, SPEED_MIN, SPEED_MAX
	   3068       ENDIF
	   3069 
	   3070 
	   3071        RETURN
	   3072        END


PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 496 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                             48311156 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT *32
  3 $IODATA$                              4988 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                               36688   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                2098 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 LIB$INITIALIZE                           4 NOPIC CON REL GBL NOSHR NOEXE   RD NOWRT LONG
  7 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated             48356074


ENTRY POINTS

    Address   Type  Name                   
                                           
  4-00007870        USER_REQUESTS_DATA_TYPE


VARIABLES

    Address   Type  Name              Address   Type  Name              Address   Type  Name         
                                                                                                     
      **      I*4   DVSTEP_MAX          **      I*4   FILTER_SPEED        **      I*4   SPEED_MAX    
      **      I*4   DVSTEP_MIN    REG-00000005  I*4   I                   **      I*4   SPEED_MIN    
      **      I*4   FILTER_COINC    2-00000020  I*4   J               2-00000018  CHAR  YORN         
      **      I*4   FILTER_DVSTEP   2-00000024  I*4   K                                              
      **      I*4   FILTER_RANGE        **      I*4   RANGECHECK                                     


ARRAYS

     Address  Type  Name              Bytes  Dimensions

  1-00000000  CHAR  RSELECTION           35  (0:6)
      **      L*4   SRANGE               12  (0:2)




USER_REQUESTS_DATA_TYPE                                         17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  49
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

LABELS

    Address   Label     Address   Label     Address   Label     Address   Label     Address   Label
                                                                                                   
      **       7          **       9          **       11         **       13         **       16  
      **       8          **       10         **       12         **       15                      

USER_REQUESTS_DATA_TYPE                                         17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  50
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3073 
	   3074 
	   3075 C***************************************************************************
	   3076 
	   3077       SUBROUTINE DPU_DEFAULT_COEFF(DNQ_MAX,DMQMAX,DMQMIN,   
	   3078      .		            DNM_MAX,DMMAX, DMMIN,
	   3079      .                      DEMIN,DEMAX,DTMIN,DTMAX,
	   3080      .                      DA,DB,DC1,DC2A,DC2B,DD1,DD2,DE,
	   3081      .                      DBREAK_C2, DBREAK_MQ,
	   3082      .                      DKM,DKQ,DNM_BINS,DNQ_BINS)
	   3083 
	   3084 C***
	   3085 C     This SUBROUTINE returns DPU default coefficients
	   3086 C***
	   3087 
	   3088       IMPLICIT NONE
	   3089 
	   3090       REAL*4 DA(6),			!mass coefficients
	   3091      .       DB(6),      		!NM coefficients
	   3092      .       DC1,DC2A,DC2B		!mass/charge coefficients
	   3093 C			 		C1= time of flight **2 of 1 keV proton
	   3094 C			 		C2= carbon foil correction
	   3095       INTEGER*4 DBREAK_C2  		!NQ value of C2 break point (83)
	   3096       REAL*4    DBREAK_MQ  		!M/Q value of C2 break point (~11)
	   3097 
	   3098       REAL*4 DD1,DD2,	!E/Q coefficients, D1= analyzer constant
	   3099 C			                   D2= step resolution
	   3100      .       DE(3)
	   3101 
	   3102       REAL*4 DEMIN, DEMAX,		   !min max energy and time
	   3103      .       DTMIN, DTMAX
	   3104 
	   3105       INTEGER*4  DNM_MAX, DNQ_MAX !DPU default max bin values
	   3106 
	   3107       REAL*4 DMMAX, DMMIN,    !DPU DEFAULT measurable mass range in amu 
	   3108      .       DMQMAX, DMQMIN   !DPU DEFAULT measurable m/q range in amu/e        
	   3109 
	   3110       REAL*4  DKM,DKQ           !NM, NQ resolution parameters
	   3111       REAL*4  DNM_BINS(0:70),  !Nm and Nq bin lower boundary values in mass 
	   3112      .        DNQ_BINS(0:130)   !	and m/q, based on DKM and DKQ and 
	   3113 C				        M min,M/q min
	   3114 
	   3115       INTEGER*4 I,J,K
	   3116      
	   3117 C   ****
	   3118 C   *  Initialize constants with default dpu values (ref:  pages 345-349  
	   3119 C   *  of WIND SMS COMMAND AND DATA FORMATS FOR THE SMS INSTRUMENT R.3.0) 
	   3120 C   ****	
	   3121 
	   3122       DNM_MAX = 59
	   3123       DNQ_MAX = 126
	   3124       DMMAX  = 95.
	   3125       DMMIN  = 0.5
	   3126       DMQMAX = 42.
	   3127       DMQMIN = 0.9
	   3128 
	   3129       DA(1) = 2.69575

DPU_DEFAULT_COEFF                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  51
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3130       DA(2) = -0.843766
	   3131       DA(3) = -2.38009
	   3132       DA(4) = 0.385641
	   3133       DA(5) = 0.0513127
	   3134       DA(6) = 0.0690096
	   3135 
	   3136 
	   3137       DC1 = 1.9159E-05
	   3138       DC2A= 1.5
	   3139       DC2B= 2.5
	   3140       DBREAK_C2 = 83
	   3141 C          m/q = MQmin *   kQ                     **(nq-1)
	   3142       DBREAK_MQ = 0.9   * ( (42.0/0.9)**(1./126.) )**(83.-1.)
	   3143 
	   3144       DD1 = 6.190722
	   3145       DD2 = 1.1225857
	   3146 
	   3147       DEMIN = 21.0
	   3148       DEMAX = 2675.0
	   3149       DTMIN = 11.0
	   3150       DTMAX = 408.0
	   3151 
	   3152 C  ***
	   3153 C  *              calculate binning parameters                
	   3154 C  *              M(lower bound of Nm) = Mmin * kM**(Nm-1)    
	   3155 C  *              M/Q(lower bound of Nq) = MQmin * kQ**(Nq-1) 
	   3156 C  ***
	   3157 
	   3158       DKM = ( DMMAX/DMMIN )**(1./(FLOAT(DNM_MAX)-1.))   !substract 1 from
	   3159 C                                                    nm_max (= overflow m)
	   3160       DKQ = (DMQMAX/DMQMIN)**(1./FLOAT(DNQ_MAX))
	   3161 
	   3162       DO I = 0,70
	   3163          DNM_BINS(I) = 0.
	   3164          IF(I.GT.0.  .AND.  I.LE.DNM_MAX) 
	   3165      .        DNM_BINS(I) = DMMIN * DKM**(FLOAT(I)-1.)
	   3166       END DO
	   3167 
	   3168       DO I = 0, 130
	   3169          DNQ_BINS(I) = 0.
	   3170          IF(I.GT.0  .AND.  I.LE.DNQ_MAX+1) 
	   3171      .        DNQ_BINS(I) = DMQMIN *DKQ**(FLOAT(I)-1.)
	   3172       END DO
	   3173 
	   3174 C     coefficients related to both D values and binning resolution
	   3175       	DE(1) = -351.6997334
	   3176       	DE(2) = 32.7867706
	   3177       	DE(3) = 65.5735412
	   3178 
	   3179 C     coefficients related to both A values and binning resolution
	   3180         DB(1) = 38.4605
	   3181         DB(2) = -9.32689
	   3182         DB(3) = -26.3092
	   3183         DB(4) = 4.26283
	   3184         DB(5) = 0.567205
	   3185         DB(6) = 0.762824
	   3186 

DPU_DEFAULT_COEFF                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  52
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3187 
	   3188       RETURN
	   3189       END


PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 496 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                             48311156 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT *32
  3 $IODATA$                              4988 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                               36688   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                2098 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 LIB$INITIALIZE                           4 NOPIC CON REL GBL NOSHR NOEXE   RD NOWRT LONG
  7 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated             48356074


ENTRY POINTS

    Address   Type  Name             
                                     
  4-00007D68        DPU_DEFAULT_COEFF


VARIABLES

    Address   Type  Name          Address   Type  Name          Address   Type  Name          Address   Type  Name     
                                                                                                                       
      **      I*4   DBREAK_C2       **      R*4   DD2             **      R*4   DMMIN           **      R*4   DTMIN    
      **      R*4   DBREAK_MQ       **      R*4   DEMAX           **      R*4   DMQMAX    REG-########  I*4   I        
      **      R*4   DC1             **      R*4   DEMIN           **      R*4   DMQMIN      2-00000010  I*4   J        
      **      R*4   DC2A            **      R*4   DKM             **      I*4   DNM_MAX     2-00000014  I*4   K        
      **      R*4   DC2B            **      R*4   DKQ             **      I*4   DNQ_MAX                                
      **      R*4   DD1             **      R*4   DMMAX           **      R*4   DTMAX                                  


ARRAYS

     Address  Type  Name            Bytes  Dimensions

      **      R*4   DA                 24  (6)
      **      R*4   DB                 24  (6)
      **      R*4   DE                 12  (3)
      **      R*4   DNM_BINS          284  (0:70)
      **      R*4   DNQ_BINS          524  (0:130)


DPU_DEFAULT_COEFF                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  53
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3190 
	   3191 C**************************************************************************
	   3192       SUBROUTINE USER_NMNQ_COEFF(UNQ_MAX,UMQMAX,UMQMIN,    !user input
	   3193      .		            UNM_MAX,UMMAX, UMMIN,
	   3194      .                      EMIN,EMAX,TMIN,TMAX,      !return values
	   3195      .                      NQ_MAX,MQMAX,MQMIN,
	   3196      .                      NM_MAX,MMAX ,MMIN,
	   3197      .                      KM,KQ,
	   3198      .                      A,B,C1,C2A,C2B,D1,D2,E,
	   3199      .                      BREAK_C2, BREAK_MQ)
	   3200 C*******************************************************************
	   3201 C     This SUBROUTINE calculates coefficients for nm and nq        *
	   3202 C     parameters         					   *
	   3203 C     Original version 24 Jan 95 by ABG                            *
	   3204 C     History:							   *
	   3205 C                                                                  *
	   3206 c*******************************************************************
	   3207       IMPLICIT NONE
	   3208 
	   3209       REAL*4 A(6),	!mass coefficients
	   3210      .       B(6),      !NM coefficients
	   3211      .       C1,C2A,C2B	!mass/charge coefficients
	   3212 C			 C1= time of flight **2 of 1 keV proton
	   3213 C			 C2= carbon foil correction
	   3214       INTEGER*4 BREAK_C2  !NQ value of C2 break point (83)
	   3215       REAL*4    BREAK_MQ  !M/Q value of C2 break point (~11)
	   3216 
	   3217       REAL*4 D1,D2,	!E/Q coefficients, D1= analyzer constant
	   3218 C			                   D2= step resolution
	   3219      .       E(3)
	   3220 
	   3221       INTEGER*4 DEFAULT_NQ,DEFAULT_NM   !default dpu algorithm used
	   3222 
	   3223       REAL*4 EMIN, EMAX,		!min max energy and time
	   3224      .       TMIN, TMAX
	   3225 
	   3226       INTEGER*4  NM_MAX,  NQ_MAX, 	   !max bin values 
	   3227      .           UNM_MAX, UNQ_MAX, 	   !USER max bin values (-1 = use default)
	   3228      .           DNM_MAX/59/, DNQ_MAX/126/ !DPU default max bin values
	   3229 
	   3230       REAL*4 MMAX,  MMIN,    !measurable mass range in amu 
	   3231      .       MQMAX, MQMIN,   !measurable m/q range in amu/e
	   3232      .       UMMAX, UMMIN,   !USER measurable mass range in amu (-1 = use default)
	   3233      .       UMQMAX,UMQMIN,  !USER measurable m/q range in amu/e (-1 = use default)
	   3234      .       DMMAX  /95./, DMMIN  /0.5/,  !DPU DEFAULT measurable mass range in amu 
	   3235      .       DMQMAX /42./, DMQMIN /0.9/   !DPU DEFAULT measurable m/q range in amu/e        
	   3236 
	   3237       REAL*4  KM,KQ           !NM, NQ resolution parameters
	   3238 
	   3239       INTEGER*4 I,J,K
	   3240      
	   3241 C   ***********************************************************************
	   3242 C   *  Initialize constants with default dpu values (ref:  pages 345-349  *
	   3243 C   *  of WIND SMS COMMAND AND DATA FORMATS FOR THE SMS INSTRUMENT R.3.0) *
	   3244 C   ***********************************************************************	
	   3245 
	   3246       A(1) = 2.69575

USER_NMNQ_COEFF                                                 17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  54
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3247       A(2) = -0.843766
	   3248       A(3) = -2.38009
	   3249       A(4) = 0.385641
	   3250       A(5) = 0.0513127
	   3251       A(6) = 0.0690096
	   3252 
	   3253 
	   3254       C1 = 1.9159E-05
	   3255       C2A= 1.5
	   3256       C2B= 2.5
	   3257       BREAK_C2 = 83
	   3258 C          m/q = MQmin *   kQ                     **(nq-1)
	   3259       BREAK_MQ = 0.9   * ( (42.0/0.9)**(1./126.) )**(83.-1.)
	   3260 
	   3261       D1 = 6.190722
	   3262       D2 = 1.1225857
	   3263 
	   3264       EMIN = 21.0
	   3265       EMAX = 2675.0
	   3266       TMIN = 11.0
	   3267       TMAX = 408.0
	   3268 
	   3269 C   ***********************************************************************
	   3270 C   *  determine if default (i.e., dpu) binning will be used, in whole or *
	   3271 C   *  in part, or not at all.  Otherwise user input for min, max, number *
	   3272 C   *  of bins will be used.                                              *
	   3273 C   ***********************************************************************
	   3274 
	   3275       DEFAULT_NQ = 0		!initialize flag for dpu default
	   3276       DEFAULT_NM = 0
	   3277       IF(UMMIN.LT.0.  .AND.  UMMAX.LT.0.   .AND.   UNM_MAX.LT.0)
	   3278      .   DEFAULT_NM = 1		!if true, dpu bins for nm to be used
	   3279       IF(UMQMAX.LT.0. .AND.  UMQMIN.LT.0.  .AND.   UNQ_MAX.LT.0) 
	   3280      .   DEFAULT_NQ = 1		!if true, dpu bins for nq to be used
	   3281 
	   3282       IF(UMMIN.LT.0.)  THEN
	   3283              MMIN = DMMIN
	   3284       ELSE
	   3285              MMIN = UMMIN
	   3286       ENDIF
	   3287 
	   3288       IF(UMMAX.LT.0.) THEN
	   3289               MMAX = DMMAX
	   3290       ELSE
	   3291               MMAX = UMMAX
	   3292       ENDIF
	   3293 
	   3294       IF(UMQMIN.LT.0.) THEN
	   3295               MQMIN = DMQMIN
	   3296       ELSE
	   3297               MQMIN = UMQMIN
	   3298       ENDIF
	   3299 
	   3300       IF(UMQMAX.LT.0.) THEN
	   3301               MQMAX = DMQMAX 
	   3302       ELSE
	   3303               MQMAX = UMQMAX

USER_NMNQ_COEFF                                                 17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  55
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3304       ENDIF
	   3305 
	   3306       IF(UNM_MAX.LT.0) THEN
	   3307             NM_MAX = DNM_MAX
	   3308       ELSE
	   3309             NM_MAX = UNM_MAX +1   !(DPU formulas use overflow mass as nmmax)
	   3310       ENDIF
	   3311 
	   3312       IF(UNQ_MAX.LT.0) THEN
	   3313             NQ_MAX = DNQ_MAX
	   3314       ELSE
	   3315             NQ_MAX = UNQ_MAX
	   3316       ENDIF
	   3317 
	   3318 
	   3319 
	   3320 C  ************************************************************
	   3321 C  *              calculate binning parameters                *
	   3322 C  *              M(lower bound of Nm) = Mmin * kM**(Nm-1)    *
	   3323 C  *              M/Q(lower bound of Nq) = MQmin * kQ**(Nq-1) *
	   3324 C  ************************************************************
	   3325 
	   3326       KM = ( MMAX/MMIN )**(1./(FLOAT(NM_MAX)-1.))   !substract 1 from
	   3327 C                                                    nm_max (= overflow m)
	   3328       KQ = (MQMAX/MQMIN)**(1./FLOAT(NQ_MAX))
	   3329 
	   3330 
	   3331       IF (DEFAULT_NQ .EQ. 1) THEN
	   3332       	E(1) = -351.6997334
	   3333       	E(2) = 32.7867706
	   3334       	E(3) = 65.5735412
	   3335       ELSE
	   3336 	E(1) = 1. + (  (ALOG(C1) - ALOG(MQMIN))/ALOG(KQ) )
	   3337         E(2) = 1. / ALOG(KQ)
	   3338         E(3) = 2. / ALOG(KQ)
	   3339         BREAK_C2 = IFIX ( ALOG(BREAK_MQ/MQMIN) / ALOG(KQ) )
	   3340       END IF
	   3341 
	   3342       IF (DEFAULT_NM .EQ. 1) THEN
	   3343         B(1) = 38.4605
	   3344         B(2) = -9.32689
	   3345         B(3) = -26.3092
	   3346         B(4) = 4.26283
	   3347         B(5) = 0.567205
	   3348         B(6) = 0.762824
	   3349       ELSE
	   3350         B(1) = 1. + (  (A(1)-ALOG(MMIN)) / ALOG(KM) )
	   3351         B(2) = A(2) / ALOG(KM)
	   3352         B(3) = A(3) / ALOG(KM)
	   3353         B(4) = A(4) / ALOG(KM)
	   3354         B(5) = A(5) / ALOG(KM)
	   3355         B(6) = A(6) / ALOG(KM)
	   3356       ENDIF
	   3357 
	   3358       RETURN
	   3359       END

USER_NMNQ_COEFF                                                 17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  56
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75



PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 496 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                             48311156 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT *32
  3 $IODATA$                              4988 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                               36688   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                2098 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 LIB$INITIALIZE                           4 NOPIC CON REL GBL NOSHR NOEXE   RD NOWRT LONG
  7 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated             48356074


ENTRY POINTS

    Address   Type  Name           
                                   
  4-00008028        USER_NMNQ_COEFF


VARIABLES

    Address   Type  Name           Address   Type  Name           Address   Type  Name           Address   Type  Name      
                                                                                                                           
      **      I*4   BREAK_C2     1-00000034  R*4   DMMIN            **      R*4   KM               **      R*4   UMMAX     
      **      R*4   BREAK_MQ     1-00000038  R*4   DMQMAX           **      R*4   KQ               **      R*4   UMMIN     
      **      R*4   C1           1-0000003C  R*4   DMQMIN           **      R*4   MMAX             **      R*4   UMQMAX    
      **      R*4   C2A          1-00000028  I*4   DNM_MAX          **      R*4   MMIN             **      R*4   UMQMIN    
      **      R*4   C2B          1-0000002C  I*4   DNQ_MAX          **      R*4   MQMAX            **      I*4   UNM_MAX   
      **      R*4   D1               **      R*4   EMAX             **      R*4   MQMIN            **      I*4   UNQ_MAX   
      **      R*4   D2               **      R*4   EMIN             **      I*4   NM_MAX                                   
REG-00000007  I*4   DEFAULT_NM   2-00000028  I*4   I                **      I*4   NQ_MAX                                   
REG-00000006  I*4   DEFAULT_NQ   2-0000002C  I*4   J                **      R*4   TMAX                                     
  1-00000030  R*4   DMMAX        2-00000030  I*4   K                **      R*4   TMIN                                     


ARRAYS

     Address  Type  Name        Bytes  Dimensions

      **      R*4   A              24  (6)
      **      R*4   B              24  (6)
      **      R*4   E              12  (3)


USER_NMNQ_COEFF                                                 17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  57
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3360 
	   3361 
	   3362 C**************************************************************************
	   3363       
	   3364       SUBROUTINE USER_NMNQ_PHA_BINNED(DPPSP,DPPSM,DVSTEP,ECHN,TCHN,    !this pha event
	   3365      .                      NQ_MAX,MQMAX,MQMIN,    !information for binning
	   3366      .                      NM_MAX,MMAX, MMIN,
	   3367      .                      EMIN,EMAX,TMIN,TMAX,      
	   3368      .                      KM,KQ,
	   3369      .                      A,B,C1,C2A,C2B,D1,D2,E,
	   3370      .                      BREAK_C2, BREAK_MQ,
	   3371      .                      NQ,NM)			!return information
	   3372 
	   3373 C*******************************************************************
	   3374 C     This SUBROUTINE calculates ln bins for MASS and MASS/CHARGE  *
	   3375 C     given the number of bins requested by the user, plus         * 
	   3376 C     the status of the +/- DPPS, DV Step number, the compressed   *
	   3377 C     energy channel number,and the time-of-flight channel number  *
	   3378 C     for WIND-STICS. The algorithms for m, m/q are those used by  *
	   3379 C     the DPU  as of July 17, 1992.                                *
	   3380 C     Original version 24 Jan 95 by ABG from a routine by SChotoo. *
	   3381 C     History:
	   3382 C                
	   3383 c*******************************************************************
	   3384       IMPLICIT NONE
	   3385 
	   3386       REAL*4 A(6),	!mass coefficients
	   3387      .       B(6),      !NM coefficients
	   3388      .       C1,C2A,C2B	!mass/charge coefficients
	   3389 C			 C1= time of flight **2 of 1 keV proton
	   3390 C			 C2= carbon foil correction
	   3391       INTEGER*4 BREAK_C2  !NQ value of C2 break point (83)
	   3392       REAL*4    BREAK_MQ  !M/Q value of C2 break point (~11)
	   3393 
	   3394       REAL*4 D1,D2,	!E/Q coefficients, D1= analyzer constant
	   3395 C			                   D2= step resolution
	   3396      .       E(3)
	   3397       INTEGER*4 DPPSP,  !enable bit for dpps plus plate
	   3398      .          DPPSM,  !enable bit for dpps minus plate
	   3399      .          DVSTEP, !deflection voltage step number 
	   3400      .          ECHN    !compressed energy channel number
	   3401       REAL*4 ED,        !decompressed energy channel number            
	   3402      .       EMEAS,     !measured energy in keV
	   3403      .       EMIN,EMAX, !measurable energy range in keV 
	   3404      .       EPQ,       !E/Q
	   3405      .       M,         !mass in amu
	   3406      .       MPQ	!mass per charge in amu/e
	   3407       INTEGER*4  NM,NQ   		   !mass bin, m/q bin
	   3408       INTEGER*4  NM_MAX,  NQ_MAX 	   !max bin values 
	   3409 
	   3410       REAL*4 MMAX,  MMIN,    !measurable mass range in amu 
	   3411      .       MQMAX, MQMIN   !measurable m/q range in amu/e
	   3412 
	   3413       REAL*4  KM,KQ           !NM, NQ resolution parameters
	   3414 
	   3415    
	   3416       INTEGER*4 TCHN    !time channel number

USER_NMNQ_PHA_BINNED                                            17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  58
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3417       REAL*4 TEMP,         
	   3418      .       TMIN,TMAX, !measurable time-of-flight range in ns
	   3419      .       TOF,       !measured time-of-flight in ns
	   3420      .       XX,YY
	   3421 
	   3422       INTEGER*4 I,J,K
	   3423      
	   3424 C  **************************************************************
	   3425 C  *			PHA Channel number conversions	 	*
	   3426 C  **************************************************************
	   3427 
	   3428 C     Energy Channel Number (ECHN) must first be decompressed (ED) 
	   3429 C     from 9-bit to 10-bit
	   3430       IF (ECHN .LT. 256) ED = ECHN
	   3431       IF ((ECHN .GE. 256).AND.(ECHN .LT. 384))ED = 2.0*ECHN - 256.0 + 0.5
	   3432       IF (ECHN .GE. 384) ED = 4.0*ECHN - 1024.0 + 1.5
	   3433 
	   3434 C     Calculate measured energy in keV from decompressed channel number
	   3435       EMEAS = (ED + 6)/0.37654782
	   3436 
	   3437      
	   3438 C     Calculate time of flight in ns from time channel number
	   3439       TOF = (TCHN - 44)/2.3725306895
	   3440 
	   3441 
	   3442 C  ******************************************************************
	   3443 C  *                   E/Q, M/Q, and M algorithms                   *
	   3444 C  *                   Nm, Nq values                                *
	   3445 C  ******************************************************************
	   3446 
	   3447 C     Calculate the e/q value based on the default dpu algorithm and constants.
	   3448           IF(IAND(DPPSP, DPPSM).EQ.1)THEN               !both plates on
	   3449             EPQ = D1 * (D2**DVSTEP)
	   3450           ELSE IF (DPPSP.EQ.1 .OR. DPPSM.EQ.1) THEN     !one plate on  
	   3451             EPQ = 0.5 * D1 * (D2**DVSTEP)                
	   3452           ELSE                                          !neither plate on
	   3453             EPQ = 0
	   3454           ENDIF
	   3455 
	   3456 C     Calculate mass per charge in amu/e
	   3457     
	   3458       MPQ = C1*(EPQ - C2A)*(TOF**2) 
	   3459       IF (MPQ .GE. BREAK_MQ) MPQ = C1*(EPQ - C2B)*(TOF**2)   
	   3460 
	   3461       IF (TOF .GT. 0) THEN
	   3462            NQ = E(1) + E(2)*ALOG(D1* (D2**DVSTEP) - C2A) +
	   3463      .          E(3)*ALOG(TOF)
	   3464            IF (NQ .GE. BREAK_C2)       
	   3465      .      NQ = E(1) + E(2)*ALOG(D1* (D2**DVSTEP) - C2B) +
	   3466      .     	 E(3)*ALOG(TOF)
	   3467            IF (NQ .GT. NQ_MAX) NQ = NQ_MAX+1	!M/Q overflow
	   3468            IF (NQ .LT. 1  ) NQ = 0	        !M/Q underflow
	   3469       ELSE
	   3470          NQ = 0
	   3471       ENDIF
	   3472 
	   3473 C     Calculate mass in amu

USER_NMNQ_PHA_BINNED                                            17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  59
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3474       IF ((EMEAS .GT. EMIN) .AND. (EMEAS .LT. EMAX) .AND.                
	   3475      .    (TOF   .GT. TMIN) .AND. (TOF   .LT. TMAX) ) THEN
	   3476 
	   3477          XX = ALOG(EMEAS)
	   3478          YY = ALOG(TOF)
	   3479          TEMP = A(1) + A(2)*XX + A(3)*YY + A(4)*XX*YY
	   3480          TEMP = TEMP + A(5)*XX*XX + A(6)*YY*YY*YY
	   3481          M = EXP(TEMP)
	   3482 
	   3483          NM = B(1) + B(2)*XX + B(3)*YY + B(4)*XX*YY +
	   3484      .        B(5)*XX*XX + B(6)*YY*YY*YY
	   3485 
	   3486          IF (NM .GE. NM_MAX) THEN
	   3487               NM =  NM_MAX		!overflow mass class  (59)
	   3488 	 ELSE IF (NM .LT. 1) THEN
	   3489               NM =  NM_MAX + 1		!underflow mass class (60)
	   3490 	 ENDIF
	   3491       ELSE IF(EMEAS .LE. EMIN) THEN
	   3492 	 M   = 0
	   3493          NM  = 0                       !mass zero event
	   3494       ELSE IF (EMEAS .GE. EMAX) THEN
	   3495 	 M   = 0
	   3496          NM  = NM_MAX + 2	       !energy overflow (61)
	   3497       ELSE IF (TOF .LE. TMIN) THEN
	   3498          M   = 0 
	   3499 	 NM  = NM_MAX + 3              !time underflow (62)
	   3500       ELSE IF (TOF .GE. TMAX) THEN
	   3501 	 M   = 0
	   3502          NM  = NM_MAX + 4              !time overflow (63)
	   3503       END IF             
	   3504 
	   3505 
	   3506       RETURN
	   3507       END

USER_NMNQ_PHA_BINNED                                            17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  60
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75



PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 496 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                             48311156 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT *32
  3 $IODATA$                              4988 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                               36688   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                2098 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 LIB$INITIALIZE                           4 NOPIC CON REL GBL NOSHR NOEXE   RD NOWRT LONG
  7 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated             48356074


ENTRY POINTS

    Address   Type  Name                
                                        
  4-000084A0        USER_NMNQ_PHA_BINNED


VARIABLES

    Address   Type  Name         Address   Type  Name         Address   Type  Name         Address   Type  Name    
                                                                                                                   
      **      I*4   BREAK_C2       **      I*4   ECHN           **      R*4   KQ             **      I*4   NQ_MAX  
      **      R*4   BREAK_MQ   2-00000000  R*4   ED             **      R*4   M              **      I*4   TCHN    
      **      R*4   C1             **      R*4   EMAX           **      R*4   MMAX           **      R*4   TEMP    
      **      R*4   C2A      REG-00000022  R*4   EMEAS          **      R*4   MMIN           **      R*4   TMAX    
      **      R*4   C2B            **      R*4   EMIN     REG-00000021  R*4   MPQ            **      R*4   TMIN    
      **      R*4   D1       REG-00000024  R*4   EPQ            **      R*4   MQMAX    REG-00000023  R*4   TOF     
      **      R*4   D2         2-00000004  I*4   I              **      R*4   MQMIN    REG-00000025  R*4   XX      
      **      I*4   DPPSM      2-00000008  I*4   J              **      I*4   NM       REG-00000020  R*4   YY      
      **      I*4   DPPSP      2-0000000C  I*4   K              **      I*4   NM_MAX                               
      **      I*4   DVSTEP         **      R*4   KM             **      I*4   NQ                                   


ARRAYS

     Address  Type  Name        Bytes  Dimensions

      **      R*4   A              24  (6)
      **      R*4   B              24  (6)
      **      R*4   E              12  (3)


USER_NMNQ_PHA_BINNED                                            17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  61
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3508 
	   3509 
	   3510 C**************************************************************************
	   3511 C
	   3512        SUBROUTINE TELESCOPE_ID (TIME_OF_FLIGHT,ENERGY,
	   3513      .                PSTART,STOP_ID,SSD_ID, TELE_ID, CHECK_TELE)
	   3514 C
	   3515 C      this subroutine determines which telescope (1, 2, 3) the pha word comes 
	   3516 C		from based on PSTART, or if the information from all the detectors 
	   3517 C		is inconsistent, the check_tele flag is set
	   3518 C      HISTORY:  derived from TELESCOPE_CHECK, 18Aug95 - ABG
	   3519 
	   3520        INTEGER*4 ENERGY,		!energy pulse height
	   3521      .           TIME_OF_FLIGHT,	!time pulse height
	   3522      .           PSTART,		!FSR id
	   3523      .           STOP_ID,		!RSR id
	   3524      .           SSD_ID,		!Solid state detector id
	   3525      .           TELE_ID,		!based on PSTART if TOF>0, or SSD if only E>0
	   3526      .           CHECK_TELE		!flag = 0 if all detectors match, 1 if not
	   3527 
	   3528 
	   3529                  CHECK_TELE = 0		!initialize
	   3530 		 TELE_ID    = 0         
	   3531 
	   3532 C                ssd checks
	   3533 	  	 IF (SSD_ID.EQ.0 .AND. ENERGY.NE.0) CHECK_TELE = 1
	   3534 	         IF (SSD_ID.EQ.1 
	   3535      .               .AND.
	   3536      .                    (PSTART.NE.1 .AND. PSTART.NE.2 .AND.
	   3537      .                     PSTART.NE.7 .AND. PSTART.NE.0) ) CHECK_TELE = 1
	   3538 	         IF (SSD_ID.EQ.2 
	   3539      .               .AND.
	   3540      .                (PSTART.NE.3 .AND. PSTART.NE.4 .AND.
	   3541      .                 PSTART.NE.8 .AND. PSTART.NE.0) ) CHECK_TELE = 1
	   3542 	         IF (SSD_ID.EQ.3 
	   3543      .                 .AND.
	   3544      .                (PSTART.NE.5 .AND. PSTART.NE.6 .AND.
	   3545      .                 PSTART.NE.9 .AND. PSTART.NE.0) ) CHECK_TELE = 1
	   3546 	         IF (SSD_ID.EQ.1 
	   3547      .               .AND.
	   3548      .                (STOP_ID.NE.1 .AND. STOP_ID.NE.0) ) CHECK_TELE = 1
	   3549 	         IF (SSD_ID.EQ.2 
	   3550      .               .AND.
	   3551      .                (STOP_ID.NE.2 .AND. STOP_ID.NE.0) ) CHECK_TELE = 1
	   3552 	         IF (SSD_ID.EQ.3 
	   3553      .               .AND.
	   3554      .                (STOP_ID.NE.3 .AND. STOP_ID.NE.0) ) CHECK_TELE = 1
	   3555 
	   3556 C                stop checks
	   3557 	  	 IF (STOP_ID.EQ.0 .AND. TIME_OF_FLIGHT.NE.0) CHECK_TELE = 1
	   3558 	         IF (STOP_ID.EQ.1 
	   3559      .               .AND.
	   3560      .                    (PSTART.NE.1 .AND. PSTART.NE.2 .AND.
	   3561      .                     PSTART.NE.7 .AND. PSTART.NE.0) ) CHECK_TELE = 1
	   3562 	         IF (STOP_ID.EQ.2 
	   3563      .               .AND.
	   3564      .                (PSTART.NE.3 .AND. PSTART.NE.4 .AND.

TELESCOPE_ID                                                    17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  62
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3565      .                 PSTART.NE.8 .AND. PSTART.NE.0) ) CHECK_TELE = 1
	   3566 	         IF (STOP_ID.EQ.3 
	   3567      .                 .AND.
	   3568      .                (PSTART.NE.5 .AND. PSTART.NE.6 .AND.
	   3569      .                 PSTART.NE.9 .AND. PSTART.NE.0) ) CHECK_TELE = 1
	   3570 	         IF (STOP_ID.EQ.1 
	   3571      .               .AND.
	   3572      .                (SSD_ID.NE.1 .AND. SSD_ID.NE.0) ) CHECK_TELE = 1
	   3573 	         IF (STOP_ID.EQ.2 
	   3574      .               .AND.
	   3575      .                (SSD_ID.NE.2 .AND. SSD_ID.NE.0) ) CHECK_TELE = 1
	   3576 	         IF (STOP_ID.EQ.3 
	   3577      .               .AND.
	   3578      .                (SSD_ID.NE.3 .AND. SSD_ID.NE.0) ) CHECK_TELE = 1
	   3579 
	   3580 
	   3581 C                start checks
	   3582 C			start id only if TOF>0
	   3583 	  	 IF (PSTART.EQ.0 .AND. TIME_OF_FLIGHT.NE.0) CHECK_TELE = 1
	   3584 
	   3585 C			start id consistent with stop id
	   3586   	         IF ( (PSTART.EQ.1 .OR. PSTART.EQ.2  .OR. PSTART.EQ.7)
	   3587      .               .AND.
	   3588      .                (STOP_ID.NE.1 .AND. STOP_ID.NE.0) ) CHECK_TELE = 1
	   3589 	         IF ( (PSTART.EQ.3 .OR. PSTART.EQ.4  .OR. PSTART.EQ.8)
	   3590      .               .AND.
	   3591      .                (STOP_ID.NE.2 .AND. STOP_ID.NE.0) ) CHECK_TELE = 1
	   3592 	         IF ( (PSTART.EQ.5 .OR. PSTART.EQ.6  .OR. PSTART.EQ.9)
	   3593      .               .AND.
	   3594      .                (STOP_ID.NE.3 .AND. STOP_ID.NE.0) ) CHECK_TELE = 1
	   3595 
	   3596 C			start id consistent with solid state detector id
	   3597 	         IF ( (PSTART.EQ.1 .OR. PSTART.EQ.2  .OR. PSTART.EQ.7)
	   3598      .               .AND.
	   3599      .                (SSD_ID.NE.1 .AND. SSD_ID.NE.0) ) CHECK_TELE = 1
	   3600 	         IF ( (PSTART.EQ.3 .OR. PSTART.EQ.4  .OR. PSTART.EQ.8)
	   3601      .               .AND.
	   3602      .                (SSD_ID.NE.2 .AND. SSD_ID.NE.0) ) CHECK_TELE = 1
	   3603 	         IF ( (PSTART.EQ.5 .OR. PSTART.EQ.6  .OR. PSTART.EQ.9)
	   3604      .               .AND.
	   3605      .                (SSD_ID.NE.3 .AND. SSD_ID.NE.0) ) CHECK_TELE = 1
	   3606 
	   3607 	
	   3608 C  	find telescope ID if check_tele ok:
	   3609         IF (CHECK_TELE.EQ.0) THEN
	   3610 	  IF (PSTART.NE.0) THEN
	   3611   	    IF (PSTART.EQ.1 .OR. PSTART.EQ.2  .OR. PSTART.EQ.7) TELE_ID = 1
	   3612 	    IF (PSTART.EQ.3 .OR. PSTART.EQ.4  .OR. PSTART.EQ.8) TELE_ID = 2
	   3613 	    IF (PSTART.EQ.5 .OR. PSTART.EQ.6  .OR. PSTART.EQ.9) TELE_ID = 3
	   3614 	  ELSE IF (SSD_ID.NE.0) THEN
	   3615 	    IF (SSD_ID.EQ.1) TELE_ID = 1
	   3616 	    IF (SSD_ID.EQ.2) TELE_ID = 2
	   3617 	    IF (SSD_ID.EQ.3) TELE_ID = 3
	   3618 	  ENDIF
	   3619         ENDIF
	   3620 
	   3621        RETURN

TELESCOPE_ID                                                    17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  63
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3622        END


PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 496 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                             48311156 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT *32
  3 $IODATA$                              4988 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                               36688   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                2098 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 LIB$INITIALIZE                           4 NOPIC CON REL GBL NOSHR NOEXE   RD NOWRT LONG
  7 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated             48356074


ENTRY POINTS

    Address   Type  Name        
                                
  4-00008940        TELESCOPE_ID


VARIABLES

    Address   Type  Name               Address   Type  Name               Address   Type  Name          
                                                                                                        
      **      I*4   CHECK_TELE           **      I*4   SSD_ID               **      I*4   TIME_OF_FLIGHT
      **      I*4   ENERGY               **      I*4   STOP_ID                                          
      **      I*4   PSTART               **      I*4   TELE_ID                                          

TELESCOPE_ID                                                    17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  64
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75

	   3623 
	   3624 C ***************************************************************************
	   3625  
	   3626        SUBROUTINE WEIGHT_FACTORS_VS(PHA_S,PHA_SUMMED,
	   3627      .                           BR_S,BR_SUMMED,
	   3628      .                           W_S,W_SUMMED)
	   3629 
	   3630 
	   3631 C   **********************************************************
	   3632 C   *   DETERMINE WEIGHTING FACTORS BASED ON IRECORDS 	     *
	   3633 C   **********************************************************
	   3634 
	   3635       IMPLICIT NONE
	   3636 
	   3637       INTEGER*4 II,JJ,KK
	   3638 
	   3639       INTEGER*4 PHA_S (1:8,0:31,0:2),
	   3640      .          PHA_SUMMED(0:31,0:2),
	   3641      .          BR_S (1:8,0:31,0:2),
	   3642      .          BR_SUMMED(0:31,0:2)
	   3643 
	   3644       REAL*4    W_S (1:8,0:31,0:2),
	   3645      .          W_SUMMED(0:31,0:2)
	   3646 
	   3647 
	   3648       DO II = 0,31 	!dv step
	   3649          DO JJ = 0,2	!range
	   3650 
	   3651 	   IF (PHA_SUMMED(II,JJ) .GT.0) THEN
	   3652              W_SUMMED(II,JJ) = FLOAT(BR_SUMMED(II,JJ)) / FLOAT(PHA_SUMMED(II,JJ))
	   3653            ELSE
	   3654              W_SUMMED(II,JJ) = 1.
	   3655            END IF
	   3656 
	   3657 
	   3658            DO KK=1,8  	!sector
	   3659 	      IF (PHA_S(KK,II,JJ) .GT.0) THEN
	   3660                  W_S(KK,II,JJ) = FLOAT(BR_S(KK,II,JJ)) / FLOAT(PHA_S(KK,II,JJ))
	   3661               ELSE
	   3662                  W_S(KK,II,JJ) = 1.
	   3663               END IF
	   3664 	   END DO	!sector
	   3665 
	   3666 
	   3667          END DO         !range
	   3668       END DO            !dv step
	   3669 
	   3670         RETURN
	   3671         END

WEIGHT_FACTORS_VS                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  65
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75



PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                 496 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                             48311156 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT *32
  3 $IODATA$                              4988 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                               36688   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                2098 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 LIB$INITIALIZE                           4 NOPIC CON REL GBL NOSHR NOEXE   RD NOWRT LONG
  7 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated             48356074


ENTRY POINTS

    Address   Type  Name             
                                     
  4-00008D88        WEIGHT_FACTORS_VS


VARIABLES

    Address   Type  Name     Address   Type  Name     Address   Type  Name
                                                                          
REG-00000001  I*4   II   REG-0000001A  I*4   JJ   REG-00000004  I*4   KK  


ARRAYS

     Address  Type  Name              Bytes  Dimensions

      **      I*4   BR_S               3072  (8, 0:31, 0:2)
      **      I*4   BR_SUMMED           384  (0:31, 0:2)
      **      I*4   PHA_S              3072  (8, 0:31, 0:2)
      **      I*4   PHA_SUMMED          384  (0:31, 0:2)
      **      R*4   W_S                3072  (8, 0:31, 0:2)
      **      R*4   W_SUMMED            384  (0:31, 0:2)


WEIGHT_FACTORS_VS                                               17-MAY-1996 15:32:34    DEC Fortran V6.2-508                Page  66
                                Symbol Table                    17-MAY-1996 01:34:27    STICS_FLUX_MATRIX.FOR;75



  +---------------------------------------------------+
  |               KEY TO ADDRESS CODE FORMATS         |
  |   ppp-oooooooo  - In Psect ppp, Offset oooooooo   |
  |   ***-********  - External                        |
  |               # - Suffix: Also In Registers       |
  |   REG-rrrrrrrr  - In Register rrrrrrrr            |
  |   REG-########  - In Various Registers            |
  |        **       - Not Used; Not Allocated         |
  +---------------------------------------------------+


COMMAND QUALIFIERS

  /ALIGNMENT=(COMMONS=(PACKED,NOMULTILANGUAGE),RECORDS=PACKED)
  /ASSUME=(ACCURACY_SENSITIVE,BACKSLASH,NODUMMY_ALIASES,NOUNDERSCORE)
  /CHECK=(ASSERTIONS,BOUNDS,FORMAT,FP_EXCEPTIONS,OVERFLOW,&
  /DEBUG=(NOSYMBOLS,TRACEBACK)
  /DESIGN=(NOCOMMENTS)
  /SHOW=(DICTIONARY,INCLUDE,MAP,PREPROCESSOR)
  /STANDARD=(NOSEMANTIC,NOSOURCE_FORM,NOSYNTAX)
  /WARNINGS=(NOALIGNMENT,NOARGUMENT_CHECKING,NODECLARATIONS,GENERAL,NOTRUNCATED_SOURCE,UNCALLED,
             UNINITIALIZED,UNREACHABLE,UNUSED)
  /NOAUTOMATIC  /BLAS=NOMAPPED  /CONVERT=NATIVE  /NOCROSS_REFERENCE  /NOD_LINES  /ERROR_LIMIT=30  /EXTEND_SOURCE
  /NOPAD_SOURCE  /NOF77  /FLOAT=G_FLOAT  /IEEE_MODE=FAST  /ROUNDING_MODE=NEAREST
  /GRANULARITY=QUADWORD  /INSTRUCTION_SET=FLOATING  /INTEGER_SIZE=32  /NOMACHINE_CODE
  /MATH_LIBRARY=ACCURATE  /NAMES=UPPERCASE  /OPTIMIZE=(LEVEL=4,UNROLL=0)  /REAL_SIZE=32  /NORECURSIVE
  /NOSEPARATE_COMPILATION  /NOSYNCHRONOUS_EXCEPTIONS  /NOSYNTAX_ONLY  /TERMINAL=NOSTATISTICS  /NOTIE  /VMS
  /NOANALYSIS_DATA
  /NODIAGNOSTICS
  /INCLUDE=(.FOR,.f,FORT$INCLUDE:.FOR,FORT$INCLUDE:.f)
  /LIST=SMS1:[WIND.SOFTWARE.STICS]STICS_FLUX_MATRIX.LIS;61
  /OBJECT=SMS1:[WIND.SOFTWARE.STICS]STICS_FLUX_MATRIX.OBJ;33
  /NOLIBRARY
   sys$lib=SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1

COMPILER: DEC Fortran V6.2-508-274F

COMPILATION STATISTICS

  CPU time:         16.54 seconds
  Elapsed time:     20.19 seconds
  Pagefaults:        1301
  I/O Count:          125
