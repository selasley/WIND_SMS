MRQMIN                                                           1-APR-1997 12:55:31    DEC Fortran V6.2-508                Page   1
                                                                11-NOV-1996 15:46:36    SMS1:[WIND.SOFTWARE.STICS]MRQMIN_SW.FOR;9

	      1       SUBROUTINE MRQMIN(X,Y,SIG,NDATA,A,MA,LISTA,MFIT,
	      2      *    COVAR,ALPHA,NCA,CHISQ,FUNCS,ALAMDA,sm_flag,max_cnt,max_loc,
	      3      *    fwhm,he_max_cnt)
	      4 c     m.r.c. modified on 15 Dec 1994 to receive sm_flag from gaussj
	      5 c     use in conjunction with routine gaussj_sw
	      6       INTEGER MMAX
	      7       PARAMETER (MMAX=20)
	      8       INTEGER NDATA
	      9       DIMENSION X(NDATA),Y(NDATA),SIG(NDATA),A(MA),LISTA(MA),
	     10      *  COVAR(NCA,NCA),ALPHA(NCA,NCA),ATRY(MMAX),BETA(MMAX),DA(MMAX)
	     11       logical sm_flag   ! .true. indicates a singualr matrix error
	     12       IF(ALAMDA.LT.0.)THEN
	     13         KK=MFIT+1
	     14         DO 12 J=1,MA
	     15           IHIT=0
	     16           DO 11 K=1,MFIT
	     17             IF(LISTA(K).EQ.J)IHIT=IHIT+1
	     18 11        CONTINUE
	     19           IF (IHIT.EQ.0) THEN
	     20             LISTA(KK)=J
	     21             KK=KK+1
	     22           ELSE IF (IHIT.GT.1) THEN
	     23             PAUSE 'Improper permutation in LISTA'
	     24           ENDIF
	     25 12      CONTINUE
	     26         IF (KK.NE.(MA+1)) PAUSE 'Improper permutation in LISTA'
	     27         ALAMDA=0.001
	     28         CALL MRQCOF(X,Y,SIG,NDATA,A,MA,LISTA,MFIT,ALPHA,BETA,NCA,CHISQ,F
	     29      *UNCS,max_cnt,max_loc,fwhm,he_max_cnt)
	     30         OCHISQ=CHISQ
	     31         DO 13 J=1,MA
	     32           ATRY(J)=A(J)
	     33 13      CONTINUE
	     34       ENDIF
	     35       DO 15 J=1,MFIT
	     36         DO 14 K=1,MFIT
	     37           COVAR(J,K)=ALPHA(J,K)
	     38 14      CONTINUE
	     39         COVAR(J,J)=ALPHA(J,J)*(1.+ALAMDA)
	     40         DA(J)=BETA(J)
	     41 15    CONTINUE
	     42       CALL GAUSSJ(COVAR,MFIT,NCA,DA,1,1,sm_flag)
	     43       if (sm_flag .eq. .true.) return
	     44       IF(ALAMDA.EQ.0.)THEN
	     45         CALL COVSRT(COVAR,NCA,MA,LISTA,MFIT)
	     46         RETURN
	     47       ENDIF
	     48       DO 16 J=1,MFIT
	     49         ATRY(LISTA(J))=A(LISTA(J))+DA(J)
	     50 16    CONTINUE
	     51       CALL MRQCOF(X,Y,SIG,NDATA,ATRY,MA,LISTA,MFIT,COVAR,DA,NCA,CHISQ,FU
	     52      *NCS,max_cnt,max_loc,fwhm,he_max_cnt)
	     53       IF(CHISQ.LT.OCHISQ)THEN
	     54         ALAMDA=0.1*ALAMDA
	     55         OCHISQ=CHISQ
	     56         DO 18 J=1,MFIT
	     57           DO 17 K=1,MFIT

MRQMIN                                                           1-APR-1997 12:55:31    DEC Fortran V6.2-508                Page   2
                                                                11-NOV-1996 15:46:36    SMS1:[WIND.SOFTWARE.STICS]MRQMIN_SW.FOR;9

	     58             ALPHA(J,K)=COVAR(J,K)
	     59 17        CONTINUE
	     60           BETA(J)=DA(J)
	     61           A(LISTA(J))=ATRY(LISTA(J))
	     62 18      CONTINUE
	     63       ELSE
	     64         ALAMDA=10.*ALAMDA
	     65         CHISQ=OCHISQ
	     66       ENDIF
	     67       RETURN
	     68       END


PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $BSS$                                  244 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $CODE$                                2872   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  3 $LINK$                                 176 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA

    Total Space Allocated                 3292


ENTRY POINTS

    Address   Type  Name  
                          
  2-00000000        MRQMIN


VARIABLES

    Address   Type  Name           Address   Type  Name           Address   Type  Name           Address   Type  Name      
                                                                                                                           
      **      R*4   ALAMDA     REG-00000011  I*4   IHIT             **      I*4   MAX_CNT      1-00000000  R*4   OCHISQ    
      **      R*4   CHISQ      REG-########  I*4   J                **      I*4   MAX_LOC          **      L*4   SM_FLAG   
      **      R*4   FUNCS      REG-########  I*4   K                **      I*4   MFIT                                     
      **      R*4   FWHM       REG-00000006  I*4   KK               **      I*4   NCA                                      
      **      R*4   HE_MAX_CNT       **      I*4   MA               **      I*4   NDATA                                    


ARRAYS

     Address  Type  Name         Bytes  Dimensions

      **      R*4   A               **  (*)
      **      R*4   ALPHA           **  (*, *)
  1-00000004  R*4   ATRY            80  (20)
  1-00000054  R*4   BETA            80  (20)
      **      R*4   COVAR           **  (*, *)
  1-000000A4  R*4   DA              80  (20)
      **      I*4   LISTA           **  (*)
      **      R*4   SIG             **  (*)
      **      R*4   X               **  (*)
      **      R*4   Y               **  (*)


MRQMIN                                                           1-APR-1997 12:55:31    DEC Fortran V6.2-508                Page   3
                                Symbol Table                    11-NOV-1996 15:46:36    SMS1:[WIND.SOFTWARE.STICS]MRQMIN_SW.FOR;9



LABELS

    Address   Label     Address   Label     Address   Label     Address   Label
                                                                               
  2-00000110   11     2-00000000   13     2-00000000   15     2-00000000   17  
  2-00000170   12     2-00000000   14     2-00000000   16     2-00000000   18  


FUNCTIONS AND SUBROUTINES REFERENCED

  Type  Name           Type  Name           Type  Name        
                                                              
        COVSRT               GAUSSJ               MRQCOF      

MRQMIN                                                           1-APR-1997 12:55:31    DEC Fortran V6.2-508                Page   4
                                Symbol Table                    11-NOV-1996 15:46:36    SMS1:[WIND.SOFTWARE.STICS]MRQMIN_SW.FOR;9



  +---------------------------------------------------+
  |               KEY TO ADDRESS CODE FORMATS         |
  |   ppp-oooooooo  - In Psect ppp, Offset oooooooo   |
  |   ***-********  - External                        |
  |               # - Suffix: Also In Registers       |
  |   REG-rrrrrrrr  - In Register rrrrrrrr            |
  |   REG-########  - In Various Registers            |
  |        **       - Not Used; Not Allocated         |
  +---------------------------------------------------+


COMMAND QUALIFIERS

  /ALIGNMENT=(COMMONS=(PACKED,NOMULTILANGUAGE),RECORDS=NATURAL)
  /ASSUME=(ACCURACY_SENSITIVE,BACKSLASH,NODUMMY_ALIASES,NOUNDERSCORE)
  /CHECK=(NOASSERTIONS,BOUNDS,FORMAT,NOFP_EXCEPTIONS,NOOVERFLOW,NOUNDERFLOW)
  /DEBUG=(NOSYMBOLS,TRACEBACK)
  /DESIGN=(NOCOMMENTS)
  /SHOW=(NODICTIONARY,NOINCLUDE,MAP,NOPREPROCESSOR)
  /STANDARD=(NOSEMANTIC,NOSOURCE_FORM,NOSYNTAX)
  /WARNINGS=(ALIGNMENT,NOARGUMENT_CHECKING,NODECLARATIONS,GENERAL,NOTRUNCATED_SOURCE,UNCALLED,
             UNINITIALIZED,UNREACHABLE,UNUSED)
  /NOAUTOMATIC  /BLAS=NOMAPPED  /CONVERT=NATIVE  /NOCROSS_REFERENCE  /NOD_LINES  /ERROR_LIMIT=30  /EXTEND_SOURCE
  /NOPAD_SOURCE  /NOF77  /FLOAT=G_FLOAT  /IEEE_MODE=FAST  /ROUNDING_MODE=NEAREST
  /GRANULARITY=QUADWORD  /INSTRUCTION_SET=FLOATING  /INTEGER_SIZE=32  /NOMACHINE_CODE
  /MATH_LIBRARY=ACCURATE  /NAMES=UPPERCASE  /OPTIMIZE=(LEVEL=4,UNROLL=0)  /REAL_SIZE=32  /NORECURSIVE
  /NOSEPARATE_COMPILATION  /NOSYNCHRONOUS_EXCEPTIONS  /NOSYNTAX_ONLY  /TERMINAL=NOSTATISTICS  /NOTIE  /VMS
  /NOANALYSIS_DATA
  /NODIAGNOSTICS
  /INCLUDE=(.FOR,.f,FORT$INCLUDE:.FOR,FORT$INCLUDE:.f)
  /LIST=SMS1:[WIND.SOFTWARE.STICS]MRQMIN_SW.LIS;4
  /OBJECT=SMS1:[WIND.SOFTWARE.STICS]MRQMIN_SW.OBJ;4
  /NOLIBRARY
   sys$lib=SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1

COMPILER: DEC Fortran V6.2-508-274F

COMPILATION STATISTICS

  CPU time:          1.05 seconds
  Elapsed time:      2.70 seconds
  Pagefaults:         231
  I/O Count:            8
