WIND_CD_INIT                                                    30-NOV-1995 14:16:53    DEC Fortran V6.2-508                Page   1
                                                                21-SEP-1995 14:07:39    SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.FOR;40

	      1       SUBROUTINE WIND_CD_INIT
	      2 C
	      3 C     Serves to initialize values for the use of WIND_CD_READ
	      4 C
	      5 C     This version:   1.15   26-APR-1995
	      6 C
	      7 C     Creation:
	      8 C     H.BROER   8-APR-1994
	      9 C
	     10 C     Revisions:
	     11 C      9-JUN-1994  H. Broer     update include files
	     12 C     29-JUN-1994  H. Broer     revise HKset staring value
	     13 C      9-SEP-1994  L. Bleau     change HKset to be array reference
	     14 C     21-SEP-1994  L. BLeau     change HDBset initialization to 1
	     15 C      4-OCT-1994  L. Bleau     initialize output science L1 record to 1
	     16 C     27-OCT-1994  L. Bleau     changed name L1_sci_rec_cntr to sci_rec_cntr
	     17 C     27-OCT-1994  L. Bleau     initialized L1_recs_written
	     18 C     17-NOV-1994  L. Bleau     add code to translate logical name WIND_DIAG and
	     19 C	                        set diagnostic level (DIAG variable)
	     20 C 1.5  6-DEC-1994  L. Bleau     add call to JOB_MODE to obtain interactive flag
	     21 C 1.6 15-DEC-1994  L. Bleau     initialize EDB counters to 0
	     22 C 1.7 10-JAN-1995  L. Bleau  
	     23 C 1.8  8-FEB-1995  L. Bleau     add code to translate logical name WIND_NRT_MODE
	     24 C			        and set logical variable NRT_MODE if so; change
	     25 C			        comment delimiters
	     26 C 1.9 15-FEB-1995  J.PAQUETTE   removed refrence to HDBset since HDB is now
	     27 C                  L. Bleau     indexed by EDBset
	     28 C 1.10 23-FEB-1995 L. Bleau	check program name, set/clear PRINTLZ_MODE flag;
	     29 C				remove common DIAG def, add INCLUDE DIAG.INC
	     30 C 1.11  8-MAR-1995 L. Bleau	added cal to GET_IMAGE_INFO to get program
	     31 C				version, link date/time
	     32 C 1.12 15-MAR-1995 L. Bleau	translate logical WIND_COMMENT to fill in file
	     33 C				header comment field
	     34 C 1.13  6-APR-1995 L. Bleau	initialize eph_avail to .false.
	     35 C 1.14 12-APR-1995 L. Bleau	add include L1INFO.INC
	     36 C 1.15 26-APR-1995 L. Bleau	add code to translate logical name
	     37 C				WIND_HALT_NO_EPH and set logical variable
	     38 C				HALT_IF_NO_EPH appropriately
	     39 C      21-SEP-1995 L. Bleau	corrected comments regarding WIND_HALT_NO_EPH
	     40 C
	     41 CDEC$ IDENT '1.15'
	     42 
	     43       IMPLICIT NONE
	     44 
	     45       INCLUDE 'INC_DIR:EDBDEF.INC/NOLIST'

WIND_CD_INIT                                                    30-NOV-1995 14:16:53    DEC Fortran V6.2-508                Page   2
1.15                                                            21-SEP-1995 14:07:39    SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.FOR;40

	    583       INCLUDE 'INC_DIR:EDBVARS.INC/NOLIST'

WIND_CD_INIT                                                    30-NOV-1995 14:16:53    DEC Fortran V6.2-508                Page   3
1.15                                                            21-SEP-1995 14:07:39    SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.FOR;40

	    765       INCLUDE 'INC_DIR:WIND_L0_RECORD.INC/NOLIST'
	    816       INCLUDE 'INC_DIR:WIND_Lun.INC/NOLIST'
	    846       INCLUDE 'INC_DIR:L1FMT.INC/NOLIST'
	    978       INCLUDE 'INC_DIR:L1INFO.INC/NOLIST'
	   1006       INCLUDE 'INC_DIR:DIAG.INC/NOLIST'
	   1015 C
	   1016       INTEGER*4 GET_LOGICAL,ITEMP,NCH,MODE,SPIN,I
	   1017       LOGICAL*4 JOB_MODE
	   1018       CHARACTER*80 VALUE
	   1019 C
	   1020 C Initialize various values
	   1021 C
	   1022       EDBset = 1
	   1023       HKset(1) = 0
	   1024       Sci_rec_cntr = 1
	   1025       L1_recs_written = 0
	   1026       EDB_Sum = 0
	   1027       EDB_Lost = 0
	   1028       EDB_Skip = 0
	   1029       eph_avail = .FALSE.
	   1030 C
	   1031 C Translate logical name WIND_DIAG
	   1032 C If it's defined decode as if an integer and store into common variable DIAG
	   1033 C
	   1034       NCH = GET_LOGICAL( 'WIND_DIAG', VALUE )
	   1035       IF (NCH .NE. 0) THEN
	   1036         READ( VALUE, 101, ERR=110 ) ITEMP
	   1037 101     FORMAT(I<NCH>)
	   1038         DIAG = ITEMP
	   1039 110     CONTINUE
	   1040       ENDIF
	   1041 C
	   1042 C Translate logical name WIND_NRT_MODE
	   1043 C If it's defined set common variable NRT_MODE to .TRUE., else leave it .FALSE.
	   1044 C
	   1045       NRT_MODE = .FALSE.
	   1046       NCH = GET_LOGICAL( 'WIND_NRT_MODE', VALUE )
	   1047       IF (NCH .NE. 0) NRT_MODE = .TRUE.
	   1048 C
	   1049 C Get job mode
	   1050 C Returns .TRUE. if interactive job, so store that info in INTER in common
	   1051 C block DIAG
	   1052 C
	   1053       INTER = JOB_MODE(MODE)
	   1054 C
	   1055 C Check program name.  If it is PRINTLZ set the logical variable PRINTLZ_MODE
	   1056 C to .TRUE.
	   1057 C
	   1058       PRINTLZ_MODE = .FALSE.
	   1059       CALL GET_PROGRAM_NAME( VALUE, NCH )
	   1060       IF (NCH .NE. 0) THEN
	   1061         IF (VALUE(1:7) .EQ. 'PRINTLZ') PRINTLZ_MODE = .TRUE.
	   1062       ENDIF
	   1063 C
	   1064 C Get date and time program was linked and its version
	   1065 C
	   1066       CALL GET_IMAGE_INFO( 'LINK', LINK_DATE_TIME, NCH )

WIND_CD_INIT                                                    30-NOV-1995 14:16:53    DEC Fortran V6.2-508                Page   4
1.15                                                            21-SEP-1995 14:07:39    SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.FOR;40

	   1067       CALL GET_IMAGE_INFO( 'VERS', PROG_VERSION, NCH )
	   1068 C
	   1069 C Get user-specified comment.  This will be in the logical name WIND_COMMENT.
	   1070 C
	   1071 C The comment field can have two sources: a program-generated value and a
	   1072 C user-specified value.  The user can specify a value by defining the logical
	   1073 C name WIND_COMMENT before running the program.  WIND_CD_READ can also store
	   1074 C a comment directly in the file header structure.  The user comment is thus
	   1075 C overwritten and superceded if WIND_CD_READ stores anything there.  The length
	   1076 C of the comment field is computed by WIND_BUILD_FILE_HEADER. 
	   1077 C
	   1078       l1_file_header.comment = ' '
	   1079       NCH = GET_LOGICAL( 'WIND_COMMENT', VALUE )
	   1080       IF (NCH .NE. 0) THEN
	   1081         NCH = MIN(LEN(l1_file_header.comment),NCH)
	   1082         l1_file_header.comment = VALUE(1:NCH)
	   1083       ENDIF
	   1084 C
	   1085 C Initialize 4-character header in each of the data structures
	   1086 C
	   1087       DO I=1,3
	   1088         DO SPIN=0,59                            
	   1089           SWICS_RATE(I).EDB(SPIN).SWRA = 'SWRA'   
	   1090           SWICS_PHA(I).EDB(SPIN).SWPH  = 'SWPH'     
	   1091           MASS_RATE(I).EDB(SPIN).MARA  = 'MARA'    
	   1092           MASS_PHA(I).EDB(SPIN).MAPH   = 'MAPH'      
	   1093           STICS_RATE(I).EDB(SPIN).STRA = 'STRA'   
	   1094           STICS_PHA(I).EDB(SPIN).STPH  = 'STPH'     
	   1095         END DO                                  
	   1096         SCI(I).CORE       = 'CORE'
	   1097         HDB(I).BDH.CCHDB  = 'HDB '
	   1098         HKeep(I).CCHK     = 'HK  '
	   1099       END DO
	   1100 C
	   1101 C Translate logical name WIND_HALT_NO_EPH
	   1102 C If it's defined set common variable HALT_IF_NO_EPH to .TRUE., else leave
	   1103 C it .FALSE.
	   1104 C
	   1105       HALT_IF_NO_EPH = .FALSE.
	   1106       NCH = GET_LOGICAL( 'WIND_HALT_NO_EPH', VALUE )
	   1107       IF (NCH .NE. 0) HALT_IF_NO_EPH = .TRUE.
	   1108 
	   1109       RETURN
	   1110       END

WIND_CD_INIT                                                    30-NOV-1995 14:16:53    DEC Fortran V6.2-508                Page   5
1.15                            Symbol Table                    21-SEP-1995 14:07:39    SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.FOR;40



PROGRAM SECTIONS

    Name				 Bytes   Attributes

  1 $DATA$                                  24 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  2 $BSS$                                  104 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  3 $IODATA$                                36 NOPIC CON REL LCL NOSHR NOEXE   RD   WRT OCTA
  4 $CODE$                                1732   PIC CON REL LCL   SHR   EXE NORD NOWRT OCTA
  5 $LINK$                                 397 NOPIC CON REL LCL NOSHR NOEXE   RD NOWRT OCTA
  6 EDB                                 454336 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA
  7 EDB_HEADER                              20 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA
  8 HDB                                    996 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA
  9 HK                                    3912 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA
 10 L0_RECORD                               38 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA
 11 L1_HEADERS                             644 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA
 12 L1INFO                                  40 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA
 13 DIAG                                    48 NOPIC OVR REL GBL NOSHR NOEXE   RD   WRT OCTA

    Total Space Allocated               462327


ENTRY POINTS

    Address   Type  Name        
                                
  4-00000010        WIND_CD_INIT


VARIABLES

    Address   Type  Name                    Address   Type  Name                    Address   Type  Name               
                                                                                                                       
  7-00000006  L*1   BITRATE               2-0000000C  I*4   ITEMP                 7-00000000  I*4   SFPERBLOCK         
 10-00000006  I*2   COREID               12-00000004  I*4   L1_RECS_WRITTEN      10-00000010  I*2   SPHAID             
 10-00000018  I*2   CORENUM              13-00000010  CHAR  LINK_DATE_TIME       10-00000022  I*2   SPHANUM            
 12-00000014  I*4   CURR_SCI_REC_NUMBER   7-00000008  L*1   MASSPOWER           REG-00000005  I*4   SPIN               
 12-00000018  I*4   CURR_SPIN             1-00000004  I*4   MASS_RATE_SIZE        7-00000010  I*4   SPINCOUNT          
 13-00000000  I*4   DIAG                 10-0000000C  I*2   MCOREID               7-00000009  L*1   STICSPOWER         
  6-0006EEBC  I*4   EDBSET               10-0000001E  I*2   MCORENUM              1-00000008  I*4   STICS_H_RATE_SIZE  
  1-00000000  I*4   EDB_CORE_SIZE         7-0000000C  I*4   MEASSPIN              1-0000000C  I*4   STICS_N_RATE_SIZE  
 12-00000008  I*4   EDB_LOST              2-00000010  I*4   MODE                  2-00000004  I*4   STICS_RATE_SIZE    
 12-0000000C  I*4   EDB_SKIP             10-00000012  I*2   MPHAID                7-00000004  L*1   SUBS_ID            
 12-00000010  I*4   EDB_SUM              10-00000024  I*2   MPHANUM               7-00000007  L*1   SWICSPOWER         
 12-00000020  L*4   EPH_AVAIL             2-00000000  I*4   NCH                   1-00000010  I*4   SWICS_H_RATE_SIZE  
 12-00000024  L*4   FROM_CD              12-0000001C  L*4   NEW_SCI_REC           1-00000014  I*4   SWICS_N_RATE_SIZE  
 13-0000002C  L*4   HALT_IF_NO_EPH       13-00000008  L*4   NRT_MODE              2-00000008  I*4   SWICS_RATE_SIZE    
  7-00000005  L*1   HDBFLAG              13-0000000C  L*4   PRINTLZ_MODE          2-00000018  CHAR  VALUE              
 10-00000002  I*2   HDBRECID             13-00000027  CHAR  PROG_VERSION         10-00000008  I*2   WCOREID            
 10-00000014  I*2   HDBRECNUM             7-0000000A  L*1   RAMCHECK             10-0000001A  I*2   WCORENUM           
 10-00000004  I*2   HKRECID              10-00000000  I*2   RECORDID             10-0000000E  I*2   WPHAID             
 10-00000016  I*2   HKRECNUM             12-00000000  I*4   SCI_REC_CNTR         10-00000020  I*2   WPHANUM            
  0-00000048  I*4   I                    10-0000000A  I*2   SCOREID                                                    
 13-00000004  L*4   INTER                10-0000001C  I*2   SCORENUM                                                   



WIND_CD_INIT                                                    30-NOV-1995 14:16:53    DEC Fortran V6.2-508                Page   6
1.15                            Symbol Table                    21-SEP-1995 14:07:39    SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.FOR;40

RECORDS

    Address   Name            Structure                Bytes
                                                            
 11-00000000  L1_FILE_HEADER  ST_L1_FILE_HEADER          400
 11-00000190  L1_SR_HEADER    ST_L1_SR_HEADER            244


ARRAYS

     Address  Type  Name             Bytes  Dimensions

  6-00005688  I*1   CORE_DATA         1980  (0:10, 0:59, 3)
  8-000003CC  I*4   HDBTIME2            24  (2, 3)
  9-00000CF0  I*4   HKLOCI             300  (75)
  9-00000E1C  I*4   HKLOCJ             300  (75)
  9-00000CE4  I*4   HKSET               12  (3)
  7-0000000B  L*1   SPARFLAGS            1  (1)



RECORD ARRAYS

    Address   Name        Structure         Bytes  Dimensions

  8-00000000  HDB         HDBSTR             972  (3)
  9-00000000  HKEEP       HKEEP             3300  (3)
  6-0004D424  MASS_PHA    MA_PHA          137880  (3)
  6-0004BDA4  MASS_RATE   MA_RATE           5760  (3)
  6-00000000  SCI         CORE             22152  (3)
  6-00030F54  STICS_PHA   ST_PHA          110160  (3)
  6-00028DF4  STICS_RATE  ST_RATE          33120  (3)
  6-0000B2A4  SWICS_PHA   SW_PHA          121680  (3)
  6-00005E44  SWICS_RATE  SW_RATE          21600  (3)



LABELS

    Address   Label     Address   Label
                                       
      **       101        **       110 


FUNCTIONS AND SUBROUTINES REFERENCED

  Type  Name                     Type  Name                  
                                                             
        GET_IMAGE_INFO                 GET_PROGRAM_NAME      
  I*4   GET_LOGICAL              L*4   JOB_MODE              

WIND_CD_INIT                                                    30-NOV-1995 14:16:53    DEC Fortran V6.2-508                Page   7
1.15                            Symbol Table                    21-SEP-1995 14:07:39    SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.FOR;40



  +---------------------------------------------------+
  |               KEY TO ADDRESS CODE FORMATS         |
  |   ppp-oooooooo  - In Psect ppp, Offset oooooooo   |
  |   ***-********  - External                        |
  |               # - Suffix: Also In Registers       |
  |   REG-rrrrrrrr  - In Register rrrrrrrr            |
  |   REG-########  - In Various Registers            |
  |        **       - Not Used; Not Allocated         |
  +---------------------------------------------------+


COMMAND QUALIFIERS

  /ALIGNMENT=(COMMONS=(PACKED,NOMULTILANGUAGE),RECORDS=PACKED)
  /ASSUME=(ACCURACY_SENSITIVE,BACKSLASH,NODUMMY_ALIASES,NOUNDERSCORE)
  /CHECK=(ASSERTIONS,BOUNDS,FORMAT,FP_EXCEPTIONS,OVERFLOW,ÿÿÿ°&¶
  /DEBUG=(NOSYMBOLS,TRACEBACK)
  /DESIGN=(NOCOMMENTS)
  /SHOW=(DICTIONARY,INCLUDE,MAP,PREPROCESSOR)
  /STANDARD=(NOSEMANTIC,NOSOURCE_FORM,NOSYNTAX)
  /WARNINGS=(NOALIGNMENT,NOARGUMENT_CHECKING,DECLARATIONS,GENERAL,NOTRUNCATED_SOURCE,UNCALLED,
             UNINITIALIZED,UNREACHABLE,UNUSED)
  /NOAUTOMATIC  /BLAS=NOMAPPED  /CONVERT=NATIVE  /NOCROSS_REFERENCE  /NOD_LINES  /ERROR_LIMIT=30  /EXTEND_SOURCE
  /NOPAD_SOURCE  /NOF77  /FLOAT=G_FLOAT  /IEEE_MODE=FAST  /ROUNDING_MODE=NEAREST
  /GRANULARITY=QUADWORD  /INSTRUCTION_SET=FLOATING  /INTEGER_SIZE=32  /NOMACHINE_CODE
  /MATH_LIBRARY=ACCURATE  /NAMES=UPPERCASE  /OPTIMIZE=(LEVEL=4,UNROLL=0)  /REAL_SIZE=32  /NORECURSIVE
  /NOSEPARATE_COMPILATION  /NOSYNCHRONOUS_EXCEPTIONS  /NOSYNTAX_ONLY  /TERMINAL=NOSTATISTICS  /NOTIE  /VMS
  /NOANALYSIS_DATA
  /NODIAGNOSTICS
  /INCLUDE=(.FOR,.f,FORT$INCLUDE:.FOR,FORT$INCLUDE:.f)
  /LIST=SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.LIS;83
  /OBJECT=SMS1:[WIND.SOFTWARE.LZ]WIND_CD_INIT.OBJ;4
  /NOLIBRARY
   sys$lib=SYS$COMMON:[SYSLIB]FORSYSDEF.TLB;1

COMPILER: DEC Fortran V6.2-508-274F

COMPILATION STATISTICS

  CPU time:          1.08 seconds
  Elapsed time:      2.97 seconds
  Pagefaults:         238
  I/O Count:           43
