CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        PROGRAM TEST_CDF
C Program to test capability to read CDF orbit data for WIND
        IMPLICIT NONE
        INCLUDE 'CDF$INC:CDF.INC'
        INTEGER*4 STATUS,ID,NUM_DIMS,DIM_SIZES(CDF_MAX_DIMS),ENCODING,MAJORITY,MAX_REC,NUM_VARS,NUM_ATTRS
        INTEGER*4 INDICES(1)/1/,VAR_NUM,REC_NUM,I
        REAL*8 VALUE(3),DIST
        CHARACTER MESSAGE*(CDF_STATUSTEXT_LEN),NAME*8,CDF_PATH*17
C
C Prompt user for input file
C
        TYPE 10
 10     FORMAT(' Enter the file name without extent (8 CHARS): '$)
        ACCEPT 20,NAME
 20     FORMAT(A8)
        CDF_PATH='DATA_DIR:'//NAME
C
C Open CDF file
C
        CALL CDF_OPEN(CDF_PATH, ID,STATUS)
        IF(STATUS.NE.CDF_OK)THEN
          TYPE*, STATUS
          STOP 9000
        ENDIF
C
C Find file characteristics
C
        CALL CDF_INQUIRE(ID,NUM_DIMS,DIM_SIZES,ENCODING,MAJORITY,MAX_REC,NUM_VARS,NUM_ATTRS,STATUS)
        IF(STATUS.NE.CDF_OK)THEN
          TYPE*, STATUS
          STOP 9100
        ENDIF
C
C Get 1 piece of data
C
        VAR_NUM = CDF_VAR_NUM(ID,'Epoch')
        TYPE*,' VAR_NUM= ',VAR_NUM
        TYPE *,'MAX_REC=',MAX_REC
        DO 200 REC_NUM=1,MAX_REC
          DO 100 I=1,3
            INDICES(1) = I
            CALL CDF_VAR_GET(ID,VAR_NUM,REC_NUM,INDICES,VALUE(I),STATUS)
            IF(STATUS.NE.CDF_OK)THEN
              TYPE*,STATUS
              CALL CDF_ERROR(STATUS,MESSAGE)
              TYPE*,MESSAGE
              STOP 9200
            ENDIF
100       CONTINUE
C          DIST=SQRT(VALUE(1)**2+VALUE(2)**2+VALUE(3)**2)
          TYPE 110,REC_NUM,VALUE,DIST
110       FORMAT(1X,I3,3X,3G22.14,3X,G12.2)
200     CONTINUE
C
C Close
C
        CALL CDF_CLOSE(ID,STATUS)
        IF(STATUS.NE.CDF_OK)THEN
          TYPE*, STATUS
          STOP 9200
        ENDIF
C
        END
